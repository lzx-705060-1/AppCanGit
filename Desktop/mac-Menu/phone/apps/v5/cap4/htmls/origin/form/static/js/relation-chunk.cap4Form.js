/*! >>> built at 2018-12-5 14:53:48 */
webpackJsonp([1],{201:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_relation_vue__=__webpack_require__(240),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_0ecc2442_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_relation_vue__=__webpack_require__(282),normalizeComponent=__webpack_require__(42),Component=normalizeComponent(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_relation_vue__.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_0ecc2442_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_relation_vue__.a,!1,null,null,null);__webpack_exports__.default=Component.exports},202:function(module,__webpack_exports__,__webpack_require__){"use strict";function _playFile(id,filePath,fileName,lastModified){cmp.dialog.loading("\u6587\u4ef6\u4e0b\u8f7d\u4e2d"),cmp.att.download({url:filePath,title:fileName,extData:{lastModified:lastModified,fileId:id,origin:cmp.origin},progress:function(result){},success:function(result){var localPath=result.target;localPath="file://"+localPath,cmp.dialog.loading(!1),cmp.audio.play({filepath:localPath,filename:fileName})},error:function(e){cmp.notification.alert(e,function(){cmp.dialog.loading(!1)},"\u63d0\u793a","\u786e\u5b9a")}})}__webpack_require__.d(__webpack_exports__,"z",function(){return URLS}),__webpack_require__.d(__webpack_exports__,"q",function(){return path}),__webpack_require__.d(__webpack_exports__,"b",function(){return ready}),__webpack_require__.d(__webpack_exports__,"n",function(){return zoom}),__webpack_require__.d(__webpack_exports__,"i",function(){return openFormSummary}),__webpack_require__.d(__webpack_exports__,"o",function(){return openExternalUrl}),__webpack_require__.d(__webpack_exports__,"j",function(){return openWebView}),__webpack_require__.d(__webpack_exports__,"f",function(){return closeWebView}),__webpack_require__.d(__webpack_exports__,"d",function(){return openLoading}),__webpack_require__.d(__webpack_exports__,"g",function(){return closeLoading}),__webpack_require__.d(__webpack_exports__,"e",function(){return dialog}),__webpack_require__.d(__webpack_exports__,"h",function(){return toast}),__webpack_require__.d(__webpack_exports__,"l",function(){return fireEvent}),__webpack_require__.d(__webpack_exports__,"k",function(){return ajax}),__webpack_require__.d(__webpack_exports__,"a",function(){return serverIp}),__webpack_require__.d(__webpack_exports__,"c",function(){return getParams}),__webpack_require__.d(__webpack_exports__,"m",function(){return getUrlParams}),__webpack_require__.d(__webpack_exports__,"v",function(){return dtPicker}),__webpack_require__.d(__webpack_exports__,"w",function(){return organize}),__webpack_require__.d(__webpack_exports__,"t",function(){return uploadImages}),__webpack_require__.d(__webpack_exports__,"u",function(){return uploadAttachment}),__webpack_require__.d(__webpack_exports__,"y",function(){return location}),__webpack_require__.d(__webpack_exports__,"x",function(){return showLocation}),__webpack_require__.d(__webpack_exports__,"r",function(){return imagesBrowser}),__webpack_require__.d(__webpack_exports__,"s",function(){return filesBrowser}),__webpack_require__.d(__webpack_exports__,"A",function(){return relationDoc}),__webpack_require__.d(__webpack_exports__,"B",function(){return mark}),__webpack_require__.d(__webpack_exports__,"C",function(){return photoLocation}),__webpack_require__.d(__webpack_exports__,"p",function(){return scanQRCode});var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__(44),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1__utils_tools_js__=__webpack_require__(211),SYMB="ios"===__WEBPACK_IMPORTED_MODULE_1__utils_tools_js__.a.systemType()||"iphoneX"===__WEBPACK_IMPORTED_MODULE_1__utils_tools_js__.a.systemType()?"":"?",RT_URL=cmp.platform.CMPShell?"http://cap4.v5.cmp/v1.0.0/htmls/origin/form/index.html"+SYMB+"#/":"/seeyon/m3/apps/v5/cap4/htmls/origin/form/index.html"+SYMB+"#/",CAP3_UNFLOW_FORM_URL=cmp.platform.CMPShell?"http://unflowform.v5.cmp/v1.0.0/html/info.html":"/seeyon/m3/apps/v5/unflowform/html/info.html",BASE_URL=RT_URL,FILE_URL="/seeyon/rest/attachment?token=&firstSave=true&applicationCategory=13&option.n_a_s=1",URLS={collaboration:cmp.platform.CMPShell?"http://collaboration.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/collaboration",meeting:cmp.platform.CMPShell?"http://meeting.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/meeting",edoc:cmp.platform.CMPShell?"http://edoc.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/edoc",news:cmp.platform.CMPShell?"http://news.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/news",bulletin:cmp.platform.CMPShell?"http://bulletin.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/bulletin",inquiry:cmp.platform.CMPShell?"http://inquiry.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/inquiry",bbs:cmp.platform.CMPShell?"http://bbs.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/bbs",doc:cmp.platform.CMPShell?"http://doc.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/doc"},path=(cmp.platform,{base:cmp.platform.CMPShell?"http://cap4.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/cap4"}),ready=function(handle){cmp.ready(handle)},zoom=function(el,options){return new IScroll(el,options)},openFormSummary=function(payload){var ignore=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(payload.summaryId){var url=URLS.collaboration+"/html/details/summary.html";return openWebView(url,payload,"all",ignore)}return"cap3"===payload.version?openWebView(CAP3_UNFLOW_FORM_URL,payload,"all",ignore):openWebView("formmain",payload,null,ignore)},openExternalUrl=function(url){var ignore=arguments.length>1&&void 0!==arguments[1]&&arguments[1],done=function(){cmp.platform.CMPShell?cmp.openWebView({url:url,useNativebanner:!0}):cmp.href.next(url)};if(ignore)return done();cmp.platform.CMPShell?cmp.event.trigger("beforeviewleave",document,{location:"store",done:done}):cmp.event.trigger("beforepageredirect",document,{location:"store",done:done})},openWebView=function(route,data,type){var ignore=arguments.length>3&&void 0!==arguments[3]&&arguments[3],url="all"===type?route:""+BASE_URL+route,done=function(){cmp.platform.CMPShell?cmp.href.next(url,data,{openWebViewCatch:1}):cmp.href.next(url,data)};if(ignore)return done();cmp.platform.CMPShell?cmp.event.trigger("beforeviewleave",document,{location:"store",done:done}):cmp.event.trigger("beforepageredirect",document,{location:"store",done:done})},closeWebView=function(){var data=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];data?setTimeout(function(){return cmp.href.back(!0===data?"":data)},30):cmp.href.back()},openLoading=function(params){cmp.dialog.loading(params)},closeLoading=function(){cmp.dialog.loading(!1)},dialog=function(params){switch(params.type){case"warning":cmp.notification.confirm(params.text,function(index){params.callback&&params.callback(index)},null,params.buttons,null,null,params.buttons.length-1);break;case"success":cmp.dialog.success(params.text,function(index){params.callback&&params.callback(index)},null,params.buttons,!0);break;case"prompt":cmp.notification.prompt(params.title,function(index,val){params.callback&&params.callback(index,val)},params.buttons,params.placeholder,params.defaultValue,params.subType,"notClose");break;case"alert":cmp.notification.alert(params.text,function(index){params.callback&&params.callback(index)},params.title,params.buttons,!0);break;case"close":cmp.notification.close({})}},toast=function(text,position,time,type){cmp.notification.toast(text,position,time,type)},fireEvent=function(params){cmp.webViewListener.fire(params)},ajax=function(params){cmp.ajax({type:params.type||"POST",data:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(params.data),url:params.url.match(/seeyon/)?params.url:serverIp()+"/seeyon/"+params.url,timeout:params.timeout||"30000",dataType:"json",cmpReady2Fire:!0,fastAjax:!window.CMPREADYMARK,headers:{"Content-Type":"application/json; charset=utf-8","Accept-Language":"zh-CN",token:cmp.token||""},success:params.success,error:params.error})},serverIp=function(){return cmp.serverIp},getParams=function(){return cmp.href.getParam()},getUrlParams=function(){var result={},hrefArr=window.location.href.split("?");if(hrefArr.length>1){hrefArr[1].split("&").forEach(function(v){result[v.split("=")[0]]=v.split("=")[1]})}return result},dtPicker=function(params,callback){new cmp.DtPicker({value:params.value,beginYear:(new Date).getFullYear()-100,endYear:(new Date).getFullYear()+100,type:params.type}).show(function(rs){callback(rs.value)})},organize=function(params,extra){var id=params.recordId?params.id+"_"+params.recordId:params.id;cmp.selectOrg(id,{type:2,minSize:-1,maxSize:-1===params.type.indexOf("multi")?1:-1,selectType:-1===params.type.indexOf("multi")?params.type:params.type.substr(5,params.type.length),multitype:!1,lightOptsChange:!1,fillback:null,label:["dept","org","post","team","extP"],fillBackData:extra.fillBackData,excludeData:extra.excludeData,vj:!1,callback:function(result){extra.callback(JSON.parse(result).orgResult),cmp.selectOrgDestory(id)},closeCallback:function(){extra.closeCallback(),cmp.selectOrgDestory(id)}})},uploadImages=function(params,num,extra){cmp.dialog.actionSheet([{key:1,name:"\u62cd\u7167"},{key:2,name:"\u672c\u5730\u56fe\u7247"}],"\u53d6\u6d88",function(result){cmp.camera.getPictures({compress:!0,quality:100,targetWidth:-1,targetHeight:-1,saveToPhotoAlbum:!1,destinationType:1,sourceType:"1"===result.key?1:2,encodingType:0,pictureNum:num,success:function(cameraResult){var files=cameraResult.files,num=params.value.length;files.forEach(function(){params.uploadState.push(!1),params.value.push("")}),cmp.att.upload({url:""+serverIp()+FILE_URL,fileList:files,title:"",extData:"",success:function(ret){var data=JSON.parse(ret.response);extra.success(data.atts[0],num),num++},error:function(){extra.error()}})}})})},uploadAttachment=function(params,extra){var items=[{key:1,name:"\u62cd\u7167"},{key:2,name:"\u8bed\u97f3"},{key:3,name:"\u672c\u5730\u6587\u4ef6"},{key:4,name:"\u672c\u5730\u56fe\u7247"}];cmp.platform.CMPShell||items.splice(1,1),cmp.dialog.actionSheet(items,"\u53d6\u6d88",function(result){var type="";switch(result.key){case"1":type="photo";break;case"2":type="voice";break;case"3":type="localFile";break;case"4":type="picture"}cmp.att.suite({type:type,pictureNum:9,initDocData:null,maxFileSize:5242880,extData:{firstSave:!0},success:function(ret){var files={name:ret.att[0].filename,size:ret.att[0].size};extra.success(files,ret.att[0])},error:function(){extra.error()},cancel:function(){extra.cancel()}})},function(){})},location=function(params,extra){cmp.lbs.getLocationInfo({success:function(result){ajax({type:"POST",data:result,url:serverIp()+"/seeyon/rest/cmplbs/save",success:function(ret){extra.success(result,ret.value)},error:function(){}})},error:function(){extra.error()}})},showLocation=function(params){cmp.lbs.showLocationInfo({lbsUrl:serverIp()+"/seeyon/rest/cmplbs/"+params.valueId,success:function(result){}})},imagesBrowser=function(urls,index){var imgsObj=[];urls.forEach(function(v){imgsObj.push({small:v,big:v.split("&showType=small")[0]})}),cmp.sliders.addNew(imgsObj),cmp.sliders.detect(index)},_readFile=function(id,filePath,fileName,lastModified){cmp.dialog.loading(),cmp.att.read({path:filePath,filename:fileName,extData:{fileId:id,lastModified:lastModified,origin:cmp.origin},success:function(result){cmp.dialog.loading(!1)},error:function(e){cmp.dialog.loading(!1),cmp.notification.alert("\u6587\u4ef6\u4e0d\u5b58\u5728",function(){cmp.dialog.loading(!1)},"\u63d0\u793a","\u786e\u5b9a")}})},filesBrowser=function(params){console.log(params);var fileName=params.filename,fileId=params.fileId,lastModified=params.lastModified||params.createDate||params.createdate,suffix=fileName.substr(fileName.lastIndexOf(".")+1,fileName.length),suffixMap={wps:"doc",et:"xls"},downFileName="";if(fileName){downFileName=fileName;var dotIndex=downFileName.lastIndexOf(".");if(-1!=dotIndex){var pureName=downFileName.substring(0,dotIndex),fileSuffix=downFileName.substring(dotIndex+1);for(var subType in suffixMap)if(fileSuffix.toLowerCase()==subType){downFileName=pureName+"."+suffixMap[subType];break}}downFileName="?fileName="+downFileName}var filePath=cmp.origin+"/rest/attachment/file/"+fileId+downFileName;if(cmp.system.filePermission()){var items=[{key:"save",name:"\u4fdd\u5b58"}];cmp.att.canSee(suffix)&&items.unshift({key:"see",name:"\u67e5\u770b"}),cmp.dialog.actionSheet(items,"\u53d6\u6d88",function(item){"see"==item.key?(filePath=cmp.origin+"/rest/attachment/file/"+fileId+downFileName,cmp.att.canPlay(suffix)?_playFile(fileId,filePath,fileName,lastModified):_readFile(fileId,filePath,fileName,lastModified)):"save"==item.key&&(cmp.dialog.loading(),filePath=encodeURI(encodeURI(filePath)),cmp.att.download({url:filePath,title:fileName,extData:{lastModified:lastModified,fileId:fileId,origin:cmp.origin},progress:function(result){cmp.dialog.loading(!1)},success:function(result){var msg="";msg=/jpg|jpeg|bmp|png/gi.test(suffix)?"\u6587\u4ef6\u5df2\u4e0b\u8f7d\u5230\u624b\u673a\u76f8\u518c\uff0c\u8bf7\u5230\u76f8\u518c\u67e5\u770b":"\u6587\u4ef6\u5df2\u4e0b\u8f7d\u5230\u624b\u673a\uff0c\u8bf7\u5230\u79bb\u7ebf\u6587\u6863\u67e5\u770b",cmp.notification.alert(msg,function(){cmp.dialog.loading(!1)},"\u63d0\u793a","\u786e\u5b9a")},error:function(e){cmp.notification.alert("\u6587\u4ef6\u4e0d\u5b58\u5728",function(){cmp.dialog.loading(!1)},"\u63d0\u793a","\u786e\u5b9a")}}))},function(){})}else if(cmp.att.canDownload4Wechat(suffix)){var id=params.fileId,filePath="";filePath=cmp.origin+"/rest/attachment/file/"+id+downFileName,cmp.att.download({url:filePath,title:fileName})}else toast("\u5fae\u534f\u540c\u4e0d\u652f\u6301\u9644\u4ef6\u4e0b\u8f7d!","center",1500,0)},relationDoc=function(params,extra){var fillbackData=[],id=params.id+params.recordId||"";params.attachmentInfo.attachmentInfos.forEach(function(v){var tempFill={category:"1",createdate:v.createdate,description:v.description,extraMap:{},fileUrl:v.fileUrl,genesisId:v.genesisId,icon:"",id:v.id,mimeType:v.mimeType,new:!0,officeTransformEnable:"disable",remoteSource:"",size:"0",sort:v.sort,reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,type:v.mimeType,v:v.v};fillbackData.push(tempFill)}),cmp.accDoc(id,{fillbackData:fillbackData,callback:function(result){extra.success(JSON.parse(result))},closeCallback:function(){}})},mark=function(params,extra){cmp.lbs.markLocation({success:function(result){ajax({type:"POST",data:result,url:serverIp()+"/seeyon/rest/cmplbs/save",success:function(ret){extra.success(result,ret.value)},error:function(){}})},error:function(){extra.error()}})},photoLocation=function(params,extra){cmp.lbs.takePicture({userName:cmp.member.name,uploadPicUrl:""+serverIp()+FILE_URL,serverDateUrl:serverIp()+"/seeyon/rest/cmplbs/servertime",location:"",success:function(ret){ajax({type:"POST",data:ret,url:serverIp()+"/seeyon/rest/cmplbs/save",success:function(r){params.uploadState=[],params.value=[],params.uploadState.push(!1),params.value.push(null),extra.success(ret.listAttachment[0],ret.lbsAddr,r.value,0)},error:function(){}})},error:function(){extra.error()},cancel:function(){}})},scanQRCode=function(callback){if(!cmp.platform.CMPShell)return toast("\u5fae\u534f\u540c\u4e0d\u652f\u6301\u4e8c\u7ef4\u7801\u626b\u7801!","center",1500,0);cmp.barcode.scan({success:function(result){callback(null,result)},error:function(){console.log(err),"18005"!==String(err.code)&&callback({message:"barcode scan error!"})}})}},203:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"f",function(){return registerHandler}),__webpack_require__.d(__webpack_exports__,"l",function(){return loadForm}),__webpack_require__.d(__webpack_exports__,"e",function(){return saveForm}),__webpack_require__.d(__webpack_exports__,"d",function(){return calculateForm}),__webpack_require__.d(__webpack_exports__,"c",function(){return mutateFormson}),__webpack_require__.d(__webpack_exports__,"a",function(){return fetchRelationList}),__webpack_require__.d(__webpack_exports__,"b",function(){return fetchRelationFillData}),__webpack_require__.d(__webpack_exports__,"j",function(){return mutateAttachment}),__webpack_require__.d(__webpack_exports__,"g",function(){return removeServerCache}),__webpack_require__.d(__webpack_exports__,"h",function(){return autoAggregate}),__webpack_require__.d(__webpack_exports__,"i",function(){return decodeBarCode}),__webpack_require__.d(__webpack_exports__,"k",function(){return getProtectedData});var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__=__webpack_require__(204),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__=__webpack_require__(202),__WEBPACK_IMPORTED_MODULE_2__utils_index__=__webpack_require__(21),codeMap={2006:"\u60a8\u65e0\u6743\u9650\u64cd\u4f5c\uff0c\u8bf7\u8054\u7cfb\u5e94\u7528\u7ba1\u7406\u5458\uff01",2008:"\u6570\u636e\u72b6\u6001\u4e3a\u9501\u5b9a",2010:"\u5f53\u524d\u9875\u9762\u56e0\u4e3a\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u7f13\u5b58\u5df2\u7ecf\u5931\u6548\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\uff01",2011:"\u8868\u5355\u6570\u636e\u5df2\u7ecf\u88ab\u5220\u9664"},handlers={},registerHandler=function(name,cb){handlers[name]=cb},sendHandler=function(name,payload){handlers[name]&&handlers[name](payload)},serviceCreator=function(options){var deferred=new __WEBPACK_IMPORTED_MODULE_2__utils_index__.c;return __WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__.k(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({},options,{success:function(response){var data=response.data;if(data&&data.code&&codeMap[data.code])return sendHandler("error",codeMap[data.code]);deferred.resolve(response)},error:function(err){return deferred.reject(err)}})),deferred},loadForm=function(data){return serviceCreator({url:"rest/cap4/form/createOrEdit",data:data})},saveForm=function(data){return serviceCreator({url:"rest/cap4/form/saveOrUpdate",data:data})},calculateForm=function(data){var deferred=new __WEBPACK_IMPORTED_MODULE_2__utils_index__.c;return serviceCreator({url:"rest/cap4/form/calculate",data:data}).then(function(response){var data=response.data;data&&"2000"!==data.code?(__WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__.e({type:"warning",title:"\u63d0\u793a\u4fe1\u606f",text:data.message||"unknow error",buttons:["\u786e\u5b9a"],callback:function(){}}),deferred.reject(response)):deferred.resolve(response)},function(err){return deferred.reject(err)}),deferred},mutateFormson=function(data){var deferred=new __WEBPACK_IMPORTED_MODULE_2__utils_index__.c;return serviceCreator({url:"rest/cap4/form/addOrDelDataSubBean",data:data}).then(function(response){var data=response.data;data&&"2000"!==data.code?(__WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__.e({type:"warning",title:"\u63d0\u793a\u4fe1\u606f",text:data.message||"unknow error",buttons:["\u786e\u5b9a"],callback:function(){}}),deferred.reject(response)):deferred.resolve(response)},function(err){return deferred.reject(err)}),deferred},fetchRelationList=function(data){return serviceCreator({url:"rest/cap4/form/getFormRelationDatas",data:data})},fetchRelationFillData=function(data){var deferred=new __WEBPACK_IMPORTED_MODULE_2__utils_index__.c;return serviceCreator({url:"rest/cap4/form/dealSelectedRelationData",data:data}).then(function(response){var data=response.data;data&&"2000"!==data.code?(__WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__.e({type:"warning",title:"\u63d0\u793a\u4fe1\u606f",text:data.message||"unknow error",buttons:["\u786e\u5b9a"],callback:function(){}}),deferred.reject(response)):deferred.resolve(response)},function(err){return deferred.reject(err)}),deferred},mutateAttachment=function(data){return serviceCreator({url:"rest/cap4/form/addOrDelAttachment",data:data})},removeServerCache=function(data){return serviceCreator({type:"GET",url:"rest/cap4/form/removeSessionFormCache/"+data})},autoAggregate=function(data){return serviceCreator({url:"rest/cap4/form/refreshSubData",data:data})},decodeBarCode=function(data){return serviceCreator({url:"rest/capBarcode/decodeBarCode",data:data})},getProtectedData=function(data){return serviceCreator({url:"rest/cap4/form/getiSignatureProtectedData",data:data})}},204:function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _assign=__webpack_require__(238),_assign2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_assign);exports.default=_assign2.default||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}},205:function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _from=__webpack_require__(225),_from2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_from);exports.default=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return(0,_from2.default)(arr)}},206:function(module,__webpack_exports__,__webpack_require__){"use strict";var fieldTypes={input:["text","number","textarea"],normal:["text","textarea","date","datetime","maplocate"],checkbox:["checkbox"],enums:["select","radio","imageradio","imageselect"],enumsRadio:["radio","imageradio"],file:["image","attachment","document","mapphoto"],organize:["member","multimember","post","multipost","department","multidepartment","account","multiaccount","level","multilevel"],auxiliary:["suiLogo","suiLabel","suiLineGap","suiStatic"],map:["maplocate","mapmarked","mapphoto"],flow:["flowdealoption"]};__webpack_exports__.a=fieldTypes},207:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__=__webpack_require__(202);__webpack_exports__.a=function(data){switch(data.inputType){case"image":data.attachmentInfo.attachmentInfos.length?("[object String]"===Object.prototype.toString.call(data.value)&&(data.value=[],data.uploadState=[]),data.attachmentInfo.attachmentInfos.forEach(function(v){var attachInfo={id:v.id,fileUrl:v.fileUrl,size:v.size,createdate:v.createdate,filename:v.filename},url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/fileUpload.do?method=showRTE&fileId="+attachInfo.fileUrl+"&createDate="+attachInfo.createdate+"&type=image&showType=small";data.value.push(url),data.uploadState.push(!0)})):(data.value=[],data.uploadState=[]);break;case"document":case"attachment":data.attachmentInfo.attachmentInfos.length?("[object String]"===Object.prototype.toString.call(data.value)&&(data.value=[]),data.attachmentInfo.attachmentInfos.forEach(function(v){var files={name:v.filename,size:v.size,type:v.mimeType};data.value.push(files)})):data.value=[];break;case"member":case"multimember":case"department":case"multidepartment":case"account":case"multiaccount":case"level":case"multilevel":case"post":case"multipost":if(data.valueId){var names=data.showValue,ids=data.valueId,result="";ids&&ids.split(",").forEach(function(v,index){var r=v;-1!==v.indexOf("|")&&(r=v.split("|")[0]),""!==result&&(result+=","),result+=r+"|"+names.split(",")[index]}),data.value=result}break;case"radio":case"select":case"imageradio":case"imageselect":data.value=data.valueId?data.valueId:data.value,data.enums.forEach(function(v){v.url&&-1===v.url.indexOf("http")&&(v.url=""+__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+v.url)});break;case"text":"DECIMAL"===data.fieldType&&data.valueId&&(data.value=data.valueId);break;case"mapmarked":data.value={text:data.showValue||"",url:""};break;case"mapphoto":data.attachmentInfo.attachmentInfos.length?("[object String]"===Object.prototype.toString.call(data.value)&&(data.value=[],data.uploadState=[]),data.attachmentInfo.attachmentInfos.forEach(function(v){var attachInfo={id:v.id,fileUrl:v.fileUrl,size:v.size,createdate:v.createdate,filename:v.filename,subReference:v.subReference},val={url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/fileUpload.do?method=showRTE&fileId="+attachInfo.fileUrl+"&createDate="+attachInfo.createdate+"&type=image&showType=small",location:data.showValue};data.value.push(val),data.uploadState.push(!0)})):(data.value=[],data.uploadState=[]);break;case"logo":data.attrs.src&&-1===data.attrs.src.indexOf("http")&&(data.attrs.src=""+__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+data.attrs.src);break;case"date":data.value&&data.value.includes(" ")&&(data.value=data.value.split(" ")[0],data.showValue=data.value);break;case"datetime":data.value&&(data.value.includes(" ")||-1!==data.value.indexOf("*")||(data.value+=" 00:00",data.showValue=data.value));break;case"flowdealoption":data.value&&data.value.includes("@signet_host@")&&(data.value=data.value.replace(/@signet_host@/g,__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon"),data.showValue=data.value)}}},209:function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)(140)},210:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={name:"footers",props:["type","bg","checked"],methods:{handleCheckAll:function(){this.$emit("toggleCheck",!this.checked)},saveFormData:function(type){this.$emit("saveFormData",type,!1)}}}},211:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={systemType:function(){var u=navigator.userAgent,result=void 0;return u.indexOf("Android")>-1||u.indexOf("Adr")>-1?result="android":u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)&&(result=u.includes("iPhoneX")?"iphoneX":"ios"),result},systemTime:function(){var date=new Date,dateArr=[date.getFullYear(),date.getMonth()+1,date.getDate(),date.getHours(),date.getMinutes()];return dateArr.forEach(function(v){v>0&&v<10&&(v="0"+v)}),dateArr[0]+"-"+dateArr[1]+"-"+dateArr[2]+" "+dateArr[3]+":"+dateArr[4]}}},212:function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _defineProperty=__webpack_require__(213),_defineProperty2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_defineProperty);exports.default=function(obj,key,value){return key in obj?(0,_defineProperty2.default)(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}},213:function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)(136)},214:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_slicedToArray__=__webpack_require__(209),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_slicedToArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_slicedToArray__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_2__business_utils_calculate_js__=__webpack_require__(221),__WEBPACK_IMPORTED_MODULE_3__assets_js_api__=__webpack_require__(43);__webpack_exports__.a={methods:{allFormCalculate:function(callback){var params={id:"",isInCalculate:"1"};this.calculate(params,0,callback)},calculate:function(params,extra,callback){var _this=this;if(callback||this.$nextTick(function(){return _this.refreshScroll()}),!this._skipCalculate){var payload={tableName:extra?extra.tableName:this.dbData.data.tableInfo.formmain.tableName,recordId:extra&&extra.recordId||"",isMaster:!extra,fieldInfo:params};if(console.log(payload),__WEBPACK_IMPORTED_MODULE_3__assets_js_api__.b.$emit("fieldChanged",payload),"1"===params.isInCalculate){extra=extra||{};var content=this.dbData.data.content,request={formMasterDataId:content.contentDataId,formId:content.contentTemplateId,rightId:content.rightId,fieldName:params.id,fromRecordId:extra.recordId||"",formSonTableName:extra.tableName||"",mergeData:this._buildSaveRequestParams("save",!0)};console.log("=== calculating ==="),__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2__business_utils_calculate_js__.a)(params,request,function(data){_this._manipulateForm(data.tableData),callback&&callback()})}}},analysisCalcResult:function(data){var _this2=this,_dbData=this.dbData,formmains=_dbData.formmains,formsons=_dbData.formsons;__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(data).forEach(function(v){var updated=data[v];if(-1===v.indexOf("_"))__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(formmains).forEach(function(val){var formmain=formmains[val];__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(formmains[val]).forEach(function(value){if(value===v){var field=formmain[value];field&&_this2._mergeToField(field,updated)}})});else{if(-1!==v.indexOf("formson"))return void __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(formsons).forEach(function(val){var formson=formsons[val];v===formson.tableName&&(formson.auth.add=updated.add,formson.auth.delete=updated.delete)});var _v$split=v.split("_"),_v$split2=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_slicedToArray___default()(_v$split,2),fname=_v$split2[0],recordId=_v$split2[1];__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(formsons).forEach(function(val){formsons[val].records.forEach(function(record){if(record&&record.recordId===recordId){var field=record.lists[fname];field&&_this2._mergeToField(field,updated)}})})}})},setCalculateLock:function(){var _this3=this;console.log(">>> locked calculate"),this._skipCalculate=!0,this.$nextTick(function(){_this3._skipCalculate=!1,console.log("unlocked calculate <<<")})}}}},215:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1__utils_index__=__webpack_require__(21),__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__=__webpack_require__(202),__WEBPACK_IMPORTED_MODULE_3__business_utils_special_js__=__webpack_require__(207),__WEBPACK_IMPORTED_MODULE_4__business_utils_service__=__webpack_require__(203);__webpack_exports__.a={methods:{copyFliterValue:function(fieldInfo,attachmentInfo){var isCustomField=fieldInfo.isCustomField,inputType=fieldInfo.inputType;(isCustomField||inputType.match(/^(flowdealoption|linenumber|document|attachment|image|maplocate|mapphoto|mapmarked)$/))&&(fieldInfo.value="",fieldInfo.valueId="",fieldInfo.showValue="",fieldInfo.attachmentInfo&&attachmentInfo&&(fieldInfo.attachmentInfo.attachmentInfos=[],fieldInfo.attachmentInfo.baseAttachmentInfo=attachmentInfo.baseAttachmentInfo,fieldInfo.value=[],fieldInfo.uploadState=[])),isCustomField&&(fieldInfo.customValue="")},getNewFormsonData:function(tbName,data,allDone,isAutoFill){var xform=this.dbData,rIds=[],relationParams={},toMasterDataIds={};data.forEach(function(v1){rIds.push(v1.newRecordId||""),v1.newRecordId&&(toMasterDataIds[v1.newRecordId]=v1.dataId,relationParams[v1.newRecordId]={},v1.relationData&&__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(v1.relationData).forEach(function(v2){relationParams[v1.newRecordId][v2]={value:v1.relationData[v2].value}}));var keyId=v1.newRecordId?v1.fromRelationAttr+"_"+v1.newRecordId:v1.fromRelationAttr,obj={keyId:keyId,fieldName:v1.fromRelationAttr,toMasterDataId:v1.dataId,toSubDataId:v1.subDataId,toFormId:v1.toFormId,formType:v1.toFormType,fromSubDataId:v1.newRecordId};xform.relationSelector[keyId]=obj});var _getFirstRecordId=this.getFirstRecordId(tbName,isAutoFill),firstRecordId=_getFirstRecordId.firstRecordId,firstIndex=_getFirstRecordId.firstIndex,_frontTableName=_getFirstRecordId._frontTableName;if(!_frontTableName)return allDone();var preRecordId=this.getPreRecordId(this.dbData.formsons[_frontTableName].records,this._relationParam.curIndexMap[_frontTableName]),params={preRecordId:preRecordId,firstRecordId:firstRecordId,formMasterId:xform.data.content.contentDataId,formId:xform.data.content.contentTemplateId,tableName:tbName,recordIds:rIds,type:"add",rightId:xform.data.content.rightId,relationParams:relationParams};this.createFormson(tbName,params,_frontTableName,firstIndex,allDone,isAutoFill,data)},getLastIndex:function(records){for(var index=0,i=0;i<records.length;i++)records[i]&&(index=i);return index+1},createFormson:function(tbName,params,_frontTableName,firstIndex,allDone,isAutoFill,relationData){var _this=this;__WEBPACK_IMPORTED_MODULE_4__business_utils_service__.c(params).then(function(result){var records=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.b)(!0,_this.dbData.formsons[_frontTableName].records),lastIndex=_this.getLastIndex(records),isDelNull=!1;result.data.data.forEach(function(value,count){var initData=_this.initFormSonFieldDatas(_frontTableName);initData.listsIndex.forEach(function(v){var recordItem=initData.lists[v];value.dataSubInfos[v]&&recordItem&&(recordItem.recordId=value.recordId,_this._mergeToField(recordItem,value.dataSubInfos[v]),_this.mixFormsonData(recordItem,relationData,v,value.recordId))}),initData.recordId=value.recordId;var data=_this.dbData.formsons[_frontTableName].records,isFirstNull=result.data.firstIsNull,recordData=initData,relationParams=_this._relationParam,curIndex=relationParams.curIndexMap[_frontTableName];if(void 0!==curIndex)data.splice(curIndex+1+count,0,recordData);else if(console.log("isFirstNull",isFirstNull,isDelNull,lastIndex),"1"!==isFirstNull)console.log("del first record:",firstIndex,recordData),data.splice(lastIndex+count,0,recordData);else{if(!isDelNull){var record=data.splice(firstIndex,1)[0];if(isDelNull=!0,record)for(var i in _this.dbData.relationSelector){var relation=_this.dbData.relationSelector[i];relation.fromSubDataId===record.recordId&&delete _this.dbData.relationSelector[i]}}data.splice(lastIndex+count-1,0,recordData)}}),isAutoFill?allDone&&allDone():_this.allFormCalculate(function(){allDone&&allDone()})},function(err){__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.g(),__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.h("\u64cd\u4f5c\u5931\u8d25","center",1500,0)})},mixFormsonData:function(recordItem,relationData,fieldId,recordId){for(var i=0;i<relationData.length;i++){var relationRecord=relationData[i].relationData;for(var j in relationRecord)fieldId==j&&relationData[i].newRecordId==recordId&&recordItem.recordId==relationData[i].newRecordId&&(console.log("merge",relationRecord[j].showValue),this._mergeToField(recordItem,relationRecord[j]),recordItem.relationData&&(recordItem.relationData.toMasterDataId=relationData[i].dataId))}},fillBackRelationValue:function(oldData,newData,index){return newData[index].relationDataList.forEach(function(v){oldData.lists[v]&&(oldData.lists[v].valueId=newData[index].relationData[v].value,oldData.lists[v].showValue=newData[index].relationData[v].showValue,oldData.lists[v].value=newData[index].relationData[v].showValue2,newData[index].relationData[v].attachmentInfo&&(oldData.lists[v].attachmentInfo=newData[index].relationData[v].attachmentInfo),newData[index].relationData[v].enums&&(oldData.lists[v].enums=newData[index].relationData[v].enums),__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__business_utils_special_js__.a)(oldData.lists[v]))}),oldData},initFormSonFieldDatas:function(_frontTableName){return _frontTableName?__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.b)(!0,this.dbData.formsons[_frontTableName].templateRecord):this._isRelation?__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.b)(!0,this.dbData.formsons[this._relationParam.frontTableName].templateRecord):__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.b)(!0,this.dbData.formsons[this.frontTableName].templateRecord)},getFirstRecordId:function(tbName,isAutoFill){var _frontTableName=this._isRelation?this._relationParam.frontTableName:this.frontTableName;isAutoFill&&(_frontTableName=this.getFrontTbNameAndSetParams(tbName));for(var formson=this.dbData.formsons[_frontTableName],data=formson?formson.records:[],i=0;i<data.length;i++)if(data[i])return{firstRecordId:data[i].recordId,firstIndex:i,_frontTableName:_frontTableName};return{firstIndex:-1,firstRecordId:"",_frontTableName:_frontTableName}},getFrontTbNameAndSetParams:function(tbName){var formsonsData=this.dbData.formsons;for(var name in formsonsData)if(formsonsData[name].tableName==tbName)return this._relationParam.frontTableName=name,name;return""}}}},216:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__=__webpack_require__(205),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_2__utils_index__=__webpack_require__(21),__WEBPACK_IMPORTED_MODULE_3__business_utils_service__=__webpack_require__(203);__webpack_exports__.a={methods:{getFillRelationData:function(params){return __WEBPACK_IMPORTED_MODULE_3__business_utils_service__.b(params)},getRelationParams:function(params){var _dbData=this.dbData,formsons=_dbData.formsons,data=_dbData.data,_relationParam=this._relationParam,curIndexMap=(_relationParam.formType,_relationParam.frontTableName,_relationParam.curIndexMap),selectRecordIds={},payload={relationShipId:params.relationShipId,fromRightId:data.content.rightId,fromDataId:params.fromDataId,selectDatas:params.result,fromRecordId:params.fromRecordId,selectRecordIds:selectRecordIds};return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(curIndexMap).forEach(function(name){var index=curIndexMap[name],formson=formsons[name];"number"!=typeof index&&(index="");var record=formson.records[index];record&&(selectRecordIds[formson.tableName]=record.recordId)}),payload},getLength:function(obj){var ccount=0;for(var i in obj)ccount++;return ccount},relationFillbackFormmain:function(params){var _this=this;console.log("relationFillbackFormmain",params);var deferred=new __WEBPACK_IMPORTED_MODULE_2__utils_index__.c;if(!params.result.length)return deferred.resolve(),deferred;var curIndexMap=this._relationParam.curIndexMap,pkg=this.getRelationParams(params);return this.getFillRelationData(pkg).then(function(res){var _res$data=res.data,data=(_res$data.code,_res$data.data);console.log(pkg),console.log(res),_this._manipulateForm(data.tableData,{record:function(action,payload){console.log([action,payload]);var table=payload.table,records=payload.records,frontTableName=table.frontTableName,activeIndex=curIndexMap[frontTableName],lastIndex=_this.getLastIndex(table.records);if("add"===action)if(console.log([activeIndex,lastIndex]),void 0===activeIndex){var _table$records;(_table$records=table.records).splice.apply(_table$records,[lastIndex,0].concat(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default()(records)))}else{var _table$records2;(_table$records2=table.records).splice.apply(_table$records2,[activeIndex+1,0].concat(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default()(records)))}}},function(){console.log("done")}),deferred.resolve()},function(err){console.log("error:",err)}),deferred},formsonToRelation:function(params,extra){var data=this.dbData,payload={title:"\u5173\u8054\u5217\u8868",type:"browse",formType:"formson",params:params,content:{formMasterId:data.data.content.contentDataId,formId:data.data.content.contentTemplateId,rightId:data.data.content.rightId},recordId:params.recordId,selectedMasterDataId:this.selectedMasterDataId,DBKey:this._buildStoreKey(),tbName:extra.tableName,frontTableName:extra.frontTableName,curIndex:extra.curIndex,curIndexMap:this.curIndexMap};this.dbData.formsonData=void 0,this.openWebView("relation",payload)},relationFillbackFormson:function(params){var _this2=this,deferred=new __WEBPACK_IMPORTED_MODULE_2__utils_index__.c,pkg=this.getRelationParams(params);return this.getFillRelationData(pkg).then(function(res){var _res$data2=res.data,data=(_res$data2.code,_res$data2.data);_this2._manipulateForm(data.tableData,{record:function(action,payload){console.log([action,payload])}}),deferred.resolve()}),deferred},getDBFormsonData:function(){for(var frontTableName=this._relationParam.frontTableName,recordId=this._relationParam.recordId,data=this.dbData.formsons[frontTableName].records,i=0;i<data.length;i++)if(data[i]&&data[i].recordId==recordId)return data[i]}}}},217:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_slicedToArray__=__webpack_require__(209),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_slicedToArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_slicedToArray__),__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__=__webpack_require__(202),__WEBPACK_IMPORTED_MODULE_3__business_utils_getSaveParams_js__=__webpack_require__(222),__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__=__webpack_require__(206),__WEBPACK_IMPORTED_MODULE_5__business_utils_service__=__webpack_require__(203),VALIDATE_CODE_MAP={2001:"",2004:"",2005:"",2006:"\u60a8\u65e0\u6743\u9650\u64cd\u4f5c\uff0c\u8bf7\u8054\u7cfb\u5e94\u7528\u7ba1\u7406\u5458\uff01",2007:"",2008:"\u6570\u636e\u72b6\u6001\u4e3a\u9501\u5b9a",2010:"\u5f53\u524d\u9875\u9762\u56e0\u4e3a\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u7f13\u5b58\u5df2\u7ecf\u5931\u6548\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\uff01",2011:"\u8868\u5355\u6570\u636e\u5df2\u7ecf\u88ab\u5220\u9664"};__webpack_exports__.a={methods:{saveToServer:function(type,presubmit,callback,performer,moduleType,isReserved,contentOpts){var _this=this;if(this._isUnflow&&!presubmit){if(!this._validateFields())return}else if(performer&&"1"===performer.checkNull&&!this._validateFields(performer.failed))return;!presubmit&&this._isUnflow&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.d("\u4fdd\u5b58\u4e2d...");var pageParams=this.dbData.pageParams;pageParams.templateId&&"-1"===this.dbData.data.content.moduleTemplateId&&(this.dbData.data.content.moduleTemplateId=pageParams.templateId);var payload=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__business_utils_getSaveParams_js__.a)(pageParams.params.operateType,type,presubmit,performer,moduleType,this,contentOpts);__WEBPACK_IMPORTED_MODULE_5__business_utils_service__.e(payload).then(function(result){var _result$data=result.data,code=_result$data.code,data=_result$data.data;if("2000"===code){var snInfo=data.snInfo,foundSn=snInfo&&snInfo.length>0,messages=[];snInfo&&snInfo.forEach(function(item){messages.push("\u5df2\u5728"+item.display+"\u751f\u6210\u6d41\u6c34\u53f7:"+item.snmu)}),!presubmit&&_this._isUnflow&&_this.triggerListRefresh(),setTimeout(function(){presubmit?callback(payload):_this._isUnflow&&foundSn&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.e({type:"success",title:"\u63d0\u793a\u4fe1\u606f",text:messages.join(","),buttons:["\u786e\u5b9a"],callback:function(){"save"===type&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.f()}}),_this._isUnflow&&("save"!==type||!presubmit&&foundSn?"saveNew"===type?_this.loadFormData("saveNew",pageParams.params,0,!0):"saveCopy"===type&&(_this.dbData.data.content.contentDataId=data.formMasterId,_this.loadFormData("saveCopy",pageParams.params,0,!0)):isReserved?(__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.g(),presubmit||__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.h("\u4fdd\u5b58\u6210\u529f","center",1500,1)):_this.closeWebView())},1e3),performer&&performer.success&&(data.snInfo=messages.length?messages.join("<br />"):"",data.isCAP4=!0,performer.success(data))}else{if(__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.g(),("1"===payload.content.needCheckRule||"1"===payload.content.needDataUnique)&&(_this._validateData(result.data,type,!1,callback,performer),result.data&&result.data.data&&result.data.data.tableData)){var _data=result.data.data;_this._dropTableRecords(_data.clearTables),_this._manipulateForm(_data.tableData)}"2002"!==code&&performer&&performer.failed&&performer.failed()}},function(err){presubmit||(__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.g(),__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.h("\u4fdd\u5b58\u5931\u8d25","center",1500,0))})},_validateData:function(){for(var _this2=this,_len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _args=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_slicedToArray___default()(args,5),result=_args[0],type=_args[1],isPrev=_args[2],callback=_args[3],performer=_args[4],buttonMap={cancel:"\u53d6\u6d88",sure:"\u786e\u5b9a",go:"\u7ee7\u7eed"},text="",buttons=[buttonMap.sure],fields=void 0,cb=function(){};if(!isPrev){if("2002"===result.code){var ret=JSON.parse(result.data.validateResult);text=ret.ruleError,fields=ret.fields,1===ret.forceCheck?cb=function(){return performer&&performer.failed()}:(buttons=[buttonMap.go,buttonMap.cancel],cb=function(index){0===index?_this2.saveToServer(type,isPrev,callback,performer,_this2.dbData.pageParams.params.moduleType,!1,{needCheckRule:"0"}):1===index&&performer&&performer.failed()})}else"2003"===result.code?(text=result.data.validateDataUnique.msg,fields=result.data.validateDataUnique.uniqueField):text="2009"===result.code?result.data[__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(result.data)[0]]:VALIDATE_CODE_MAP[result.code]||"";var invalidData=this._invalidateFields(fields),isInComment=location.href.indexOf("/details/comment.html")>-1;text&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.e({type:"warning",title:"",text:text,buttons:buttons,callback:function(index){isInComment?_this2.dbData.invalidation={type:invalidData.type,fieldName:invalidData.fieldName,tableName:invalidData.tableName}:_this2._consumeInvalidation(invalidData),cb(index)}})}},consumeInvalidation:function(invalidation){location.href.indexOf("/details/comment.html")>-1||this._consumeInvalidation(invalidation)},_consumeInvalidation:function(invalidation){var fieldName=invalidation.fieldName,type=invalidation.type,tableName=invalidation.tableName,table="formson"===type&&this.dbData.formsons[tableName],id="formain"===type?"master|"+fieldName:table.tableName+"|"+table.records[0].recordId+"|"+fieldName,el=document.getElementById(id);el&&this.scaleScroll.scrollToElement(el,300)},_validateFields:function(cb){var _dbData=this.dbData,formmains=_dbData.formmains,formsons=_dbData.formsons,win={title:"\u63d0\u793a\u6d88\u606f",sure:"\u786e\u5b9a",text:"\u4e0d\u80fd\u4e3a\u7a7a!"},result=!0,field=void 0;for(var p1 in formmains)if(formmains.hasOwnProperty(p1))for(var p2 in formmains[p1])if(formmains[p1].hasOwnProperty(p2)){var obj=formmains[p1][p2];if("1"===obj.isNotNull){if((obj.isAttachment||__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.file.includes(obj.inputType))&&0===obj.attachmentInfo.attachmentInfos.length){field=obj;break}if((__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.map.includes(obj.inputType)||__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.organize.includes(obj.inputType))&&""===obj.valueId){field=obj;break}if(__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.enumsRadio.includes(obj.inputType)&&"0"===obj.value){field=obj;break}if(!obj.value){field=obj;break}}}if(!field)for(var _p in formsons)if(formsons.hasOwnProperty(_p))for(var i=0,r=formsons[_p].records;i<r.length;++i){var record=formsons[_p].records[i];if(record)for(var _p2 in record.lists)if(record.lists.hasOwnProperty(_p2)){var _obj=record.lists[_p2];if("1"===_obj.isNotNull){if((_obj.isAttachment||__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.file.includes(_obj.inputType))&&0===_obj.attachmentInfo.attachmentInfos.length){field=_obj;break}if((__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.map.includes(_obj.inputType)||__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.organize.includes(_obj.inputType))&&""===_obj.valueId){field=_obj;break}if(__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.enumsRadio.includes(_obj.inputType)&&"0"===_obj.value){field=_obj;break}if(!_obj.value){field=_obj;break}}}}return field&&(__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.g(),__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.e({type:"warning",title:win.title,text:""+field.display+win.text,buttons:[win.sure],callback:function(){return cb&&cb()}}),result=!1),result},_invalidateFields:function(fields){var _this3=this,_dbData2=this.dbData,formmains=_dbData2.formmains,formsons=_dbData2.formsons,mains=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formmains),subs=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formsons),invalid={isDataInvalid:"1"},masterFields=[],detailFields=[],result={};return fields.forEach(function(fieldName){for(var i=0,l=mains.length;i<l;++i){var formmain=formmains[mains[i]];if(formmain.hasOwnProperty(fieldName))return masterFields.push(fieldName),result.type||(result.type="formain",result.fieldName=fieldName,result.table=formmain),_this3._setField(formmain[fieldName],invalid)}for(var _i=0,_l=subs.length;_i<_l;++_i){var formson=formsons[subs[_i]];if(formson.fieldInfo.hasOwnProperty(fieldName))return detailFields.push(fieldName),result.type||(result.type="formson",result.fieldName=fieldName,result.tableName=formson.frontTableName,result.table=formson),formson.records.forEach(function(record){record&&_this3._setField(record.lists[fieldName],invalid)})}}),result},setFormsons:function(data){var formsons=this.dbData.formsons;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formsons).some(function(v){if(formsons[v].tableName===data.tableName){var found={};return formsons[v].records.forEach(function(formson){found[formson.recordId]=!0}),found[data.fData.recordId]?formsons[v].records.some(function(vl){if(vl.recordId===data.fData.recordId)return vl.lists=data.fData.lists,!0}):formsons[v].records.push({recordId:data.fData.recordId,lists:data.fData.lists,listsIndex:data.fData.listsIndex}),!0}}),this.dbData},_buildSaveRequestParams:function(type,presubmit,performer){var _dbData$pageParams$pa=this.dbData.pageParams.params,operateType=_dbData$pageParams$pa.operateType,moduleType=_dbData$pageParams$pa.moduleType;return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__business_utils_getSaveParams_js__.a)(operateType,type,presubmit,performer,moduleType,this)},triggerListRefresh:function(){var params={type:this.type};"new"!==this.type&&(params.params=this.dbData.pageParams.params,params.formmainsData=this.dbData.formmains),__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.l({type:"com.seeyon.m3.FormSaveSuccess",data:params})}}}},218:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__business_utils_store__=__webpack_require__(223),__WEBPACK_IMPORTED_MODULE_1__business_mixins_store_manipulate__=__webpack_require__(220);__webpack_exports__.a={mixins:[__WEBPACK_IMPORTED_MODULE_1__business_mixins_store_manipulate__.a],methods:{saveToStore:function(opts){this._isFormmain&&this.saveIscrollRecord();var storeKey=this._buildStoreKey(opts),storeData=this._buildStoreData();return __WEBPACK_IMPORTED_MODULE_0__business_utils_store__.a.save(storeKey,storeData)},getFromStore:function(opts){var _this=this,consume=arguments.length>1&&void 0!==arguments[1]&&arguments[1],storeKey=this._buildStoreKey(opts);return __WEBPACK_IMPORTED_MODULE_0__business_utils_store__.a.get(storeKey,!0).then(function(data){return consume&&_this.clearFromStore(opts),{type:data.type,pageParams:data.pageParams,viewIndex:data.viewIndex,data:data.data,formmains:data.formmains,formsons:data.formsons,flowParam:data.flowParam,relationSelector:data.relationSelector,bSroll:data.bSroll,cFormSon:data.cFormSon,contentScrollState:data.contentScrollState,sentChangeViewEvent:data.sentChangeViewEvent,backupData:data.backupData,formsonData:data.formsonData,selection:data.selection,scrollY:data.scrollY,scrollX:data.scrollX,scrollScale:data.scrollScale,invalidation:data.invalidation}})},clearFromStore:function(opts){console.log("clearFromStore:");var storeKey=this._buildStoreKey(opts);return __WEBPACK_IMPORTED_MODULE_0__business_utils_store__.a.remove(storeKey)},_buildStoreKey:function(opts){if(this.DBKey)return this.DBKey;opts=opts||this._formainParam&&this._formainParam.params||this._formsonParam&&this._formsonParam.params||this._relationParam&&this._relationParam.params||this.dbData.pageParams.params;var _opts=opts;return _opts.moduleId+"_"+_opts.rightId+"_"+_opts.operateType},_buildStoreData:function(){var data=this.dbData;return{type:data.type,pageParams:data.pageParams,viewIndex:data.viewIndex,data:data.data,formmains:data.formmains,formsons:data.formsons,flowParam:data.flowParam,relationSelector:data.relationSelector,bSroll:data.bSroll,cFormSon:data.cFormSon,backupData:data.backupData,formsonData:data.formsonData,selection:data.selection,scrollY:data.scrollY,scrollX:data.scrollX,scrollScale:data.scrollScale,invalidation:data.invalidation}}}}},219:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1__utils_index__=__webpack_require__(21),__WEBPACK_IMPORTED_MODULE_2__business_utils_special__=__webpack_require__(207),__WEBPACK_IMPORTED_MODULE_3__business_utils_service__=__webpack_require__(203),__WEBPACK_IMPORTED_MODULE_4__utils_bridge__=__webpack_require__(202);__webpack_exports__.a={created:function(){var _this=this;__WEBPACK_IMPORTED_MODULE_3__business_utils_service__.f("error",function(reason){__WEBPACK_IMPORTED_MODULE_4__utils_bridge__.e({type:"warning",title:"\u63d0\u793a\u6d88\u606f",text:reason,buttons:["\u8fd4\u56de"],callback:function(){return _this._isFormmain?_this.closeWebView():_this._isFormson?_this.cancelSave():_this._isRelation?_this.closeWebView("back"):void cmp.href.back()}})})},methods:{getBaseStyles:function(defaultSkin){if(!defaultSkin)return{};if(this._baseInfo)return this._baseInfo;var defaultBg="",fBg="";return defaultSkin.view.bgUrl?(defaultBg=__WEBPACK_IMPORTED_MODULE_4__utils_bridge__.a()+"/seeyon/common/cap4/design/"+defaultSkin.view.bgUrl.substr(2,defaultSkin.view.bgUrl.length-2),fBg=-1===defaultSkin.view.bgUrl.indexOf("/seeyon")?defaultSkin.view.bgColor+" url("+defaultBg+") no-repeat center center":defaultSkin.view.bgColor+" url("+__WEBPACK_IMPORTED_MODULE_4__utils_bridge__.a()+defaultSkin.view.bgUrl+") no-repeat center center"):fBg=defaultSkin.view.bgColor,this._baseInfo={formHeaderBg:""+defaultSkin.head.backgroundColor,formHeaderColor:""+defaultSkin.head.color,formNavBg:defaultSkin.nav?""+defaultSkin.nav.backgroundColor:"",formFooterBg:defaultSkin.nav?""+defaultSkin.nav.backgroundColor:"",formFooterColor:"",formBg:fBg,fieldLine:"1px solid "+defaultSkin.divider.backgroundColor,fieldBg:""+defaultSkin.widget.box.backgroundColor,fieldTitleDefaultColor:""+defaultSkin.widget.label.color,fieldValueDefaultColor:""+defaultSkin.widget.body.color,isNotNullBg:""+defaultSkin.required.backgroundColor,placeholderColor:""+defaultSkin.widget.placeholder.color,formsonTiTleBorder:"1px solid "+defaultSkin.formson.head.borderColor,formsonArrowColor:""+defaultSkin.formson.arrow.color,formsonBg:""+defaultSkin.formson.snap.box.backgroundColor,formsonBorder:"1px solid "+defaultSkin.formson.snap.box.borderColor,formsonTitle:""+defaultSkin.formson.snap.label.color,formsonValue:""+defaultSkin.formson.snap.body.color}},getPreRecordId:function(data,index){for(void 0===index&&(index=data.length-1);index>-1;){if(data[index])return data[index].recordId;index--}return"-1"},_setField:function(field,data){return this._mergeToField(field,data)},_mergeToField:function(field,data){__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(data).forEach(function(fieldName){var value=data[fieldName];"value"===fieldName?field.valueId=value:"showValue2"===fieldName?field.value=value:"relationInfo"===fieldName?field.relation=value:"[object Object]"===toString.call(field[fieldName])?__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.a)(field[fieldName],value):field[fieldName]=value}),__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2__business_utils_special__.a)(field)},_getFormainField:function(fieldName){var formmains=this.dbData.formmains;return formmains[__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formmains)[0]][fieldName]||null},_getFormsonField:function(fieldName,tableName,recordId){var record=this._getRecordByTableAndId(tableName,recordId);return record?record.lists[fieldName]:null},_getFormsonByName:function(tableName){for(var formson,formsons=this.dbData.formsons,names=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formsons),i=0,l=names.length;i<l;++i)if(formson=formsons[names[i]],formson.tableName===tableName)return formson},_getRecordByTableAndId:function(tableName,recordId){for(var record,formson=this._getFormsonByName(tableName),records=formson.records,i=0,l=records.length;i<l;++i)if((record=records[i])&&record.recordId===recordId)return record},setRelationSelector:function(relationRecords){if(relationRecords&&relationRecords.length){var relationSelector=this.dbData.relationSelector;relationRecords.forEach(function(v){v.keyId=v.fieldName,v.fromSubDataId&&(v.keyId=v.fieldName+"_"+v.fromSubDataId),relationSelector[v.keyId]=v})}},_deleteRelation:function(keys){var relationSelector=this.dbData.relationSelector;Array.isArray(keys)||(keys=[keys]),keys.forEach(function(key){delete relationSelector[key]})},_deleteRelationByRecordId:function(recordId){var _this2=this;if(Array.isArray(recordId))return recordId.forEach(function(id){_this2._deleteRelationByRecordId(id)});var relationSelector=this.dbData.relationSelector,search="_"+recordId;__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(relationSelector).forEach(function(key){key.indexOf(search)>-1&&delete relationSelector[key]})},_buildRelationRightId:function(pcView,phoneView){return pcView=pcView||"",phoneView=phoneView||"","0"===pcView&&(pcView=""),"0"===phoneView&&(phoneView=""),pcView?phoneView?pcView+"_"+phoneView:pcView:phoneView}}}},220:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof__=__webpack_require__(45),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty__=__webpack_require__(212),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__=__webpack_require__(205),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_4__utils_index__=__webpack_require__(21),__WEBPACK_IMPORTED_MODULE_5__assets_js_api__=__webpack_require__(43);__webpack_exports__.a={methods:{_dropTableRecords:function(mutations){if(mutations&&!(!mutations.length>0)){var formsons=this.dbData.formsons;mutations.forEach(function(name){var formson=formsons[name];formson&&formson.records instanceof Array&&formson.records.splice(0)})}},_manipulateForm:function(mutations,plugin,callback){var _this=this,_dbData=this.dbData,formmains=_dbData.formmains,formsons=_dbData.formsons,formsonMap={};__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(formsons).forEach(function(name){var formson=formsons[name];formsonMap[formson.tableName]=formson}),plugin=plugin||{},__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(mutations||{}).forEach(function(name){var mutation=mutations[name];0===name.indexOf("formmain_")?_this._manipulateFormain(name,formmains[name],mutation,plugin):_this._manipulateFormson(name,formsonMap[name],mutation,plugin)}),callback&&callback(),__WEBPACK_IMPORTED_MODULE_5__assets_js_api__.b.$emit("updated"),this.setCalculateLock()},_manipulateFormain:function(tableName,table,mutation,plugin){var _this2=this;if(!table)return console.warn('formain "'+tableName+'" not found');var fieldPlugin=plugin.field;__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(mutation).forEach(function(action){if("update"===action){var fieldset=mutation[action];__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(fieldset).forEach(function(fieldName){var source=fieldset[fieldName];if("relationRecords"!==fieldName){var target=table[fieldName];if(!target||!source)return;_this2._setField(target,source),fieldPlugin&&fieldPlugin(target)}else _this2.setRelationSelector(source)})}})},_manipulateFormson:function(tableName,table,mutation,plugin){var _this3=this;if(!table)return console.warn('formson "'+tableName+'" not found');__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(mutation).forEach(function(action){var recordset=mutation[action];"add"===action?_this3._addRecord(table,recordset,plugin):"delete"===action?_this3._deleteRecord(table,recordset,plugin):"update"===action&&_this3._updateRecord(table,recordset,plugin)})},_addRecord:function(table,recordset,plugin){var _this4=this;Array.isArray(recordset)||(recordset=[recordset]);var recordPlugin=plugin.record,fieldPlugin=plugin.field,records=table.records,templateRecord=table.templateRecord,ignores=["recordId","relationRecords"],relations=[];recordset=recordset.map(function(fieldset){var record=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__utils_index__.b)(!0,templateRecord);return record.recordId=fieldset.recordId,__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(fieldset).forEach(function(name){if(!(ignores.indexOf(name)>-1)){var target=record.lists[name],source=fieldset[name];target&&source&&(target.recordId=record.recordId,_this4._setField(target,source),fieldPlugin&&fieldPlugin(target))}}),fieldset.relationRecords&&relations.push.apply(relations,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(fieldset.relationRecords)),record}),recordPlugin?recordPlugin("add",{table:table,records:recordset}):records.push.apply(records,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(recordset)),this.setRelationSelector(relations)},_deleteRecord:function(table,idsOrIndexes,plugin){var _this5=this,recordPlugin=plugin.record,records=table.records,deleted=[];if(Array.isArray(idsOrIndexes)||(idsOrIndexes=[idsOrIndexes]),"number"==typeof idsOrIndexes[0])idsOrIndexes.sort(function(a,b){return a>b?-1:1}),idsOrIndexes.forEach(function(index){var record=records[index];record&&(deleted.unshift(record),records.splice(index,1))});else for(var record,size=idsOrIndexes.length,i=0;size>0&&i<records.length;++i)(record=records[i])&&idsOrIndexes.indexOf(record.recordId)>-1&&(deleted.push(record),records.splice(i--,1),size--);deleted.forEach(function(record){_this5._deleteRelationByRecordId(record.recordId)}),recordPlugin&&recordPlugin("delete",{table:table,records:deleted})},_updateRecord:function(table,recordId,data,plugin){var _this6=this,records=table.records,ignores=["recordId","relationRecords"],recordMap={},updated=[],relations=[],recordset=void 0,recordPlugin=void 0,fieldPlugin=void 0;"string"==typeof recordId&&data?recordset=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty___default()({},recordId,data):"object"===(void 0===recordId?"undefined":__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default()(recordId))&&recordId&&(recordset=recordId,plugin=data),recordPlugin=plugin.record,fieldPlugin=plugin.field,Array.isArray(recordset)&&(recordset=recordset.reduce(function(map,record){map[record.recordId]=record},{})),records.forEach(function(record){record&&(recordMap[record.recordId]=record)}),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(recordset).forEach(function(recordId){var fieldset=recordset[recordId],record=recordMap[recordId];record&&(updated.push(record),fieldset.relationRecords&&relations.push.apply(relations,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(fieldset.relationRecords)),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(fieldset).forEach(function(name){if(!(ignores.indexOf(name)>-1)){var target=record.lists[name],source=fieldset[name];target&&source&&(_this6._setField(target,source),fieldPlugin&&fieldPlugin(target))}}))}),recordPlugin&&recordPlugin("update",{table:table,records:updated}),this.setRelationSelector(relations)}}}},221:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__=__webpack_require__(227),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_asyncToGenerator__=__webpack_require__(226),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_asyncToGenerator___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_asyncToGenerator__),__WEBPACK_IMPORTED_MODULE_2__business_utils_service__=__webpack_require__(203),_this=this,calculate=function(){var _ref=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_asyncToGenerator___default()(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.mark(function _callee(data,request,callback){var ret;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_regenerator___default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,__WEBPACK_IMPORTED_MODULE_2__business_utils_service__.d(request).then(function(result){return result.data.data});case 2:ret=_context.sent,callback(ret);case 4:case"end":return _context.stop()}},_callee,_this)}));return function(_x,_x2,_x3){return _ref.apply(this,arguments)}}();__webpack_exports__.a=calculate},222:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__=__webpack_require__(204),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__=__webpack_require__(206),getSaveParams=function(operateType,type,isPrev,mainbodyArgs,moduleType,_this,contentOpts){var _this$dbData=_this.dbData,data=_this$dbData.data,formmains=_this$dbData.formmains,formsons=_this$dbData.formsons,relationSelector=_this$dbData.relationSelector,params={content:__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({},data.content),relationRecords:data.relationRecords,attachments:[],customFields:{}};switch(params.content.isMerge=isPrev?"1":"0",type){case"save":params.content.saveType="1";break;case"saveNew":params.content.saveType="2";break;case"saveCopy":params.content.saveType="3"}mainbodyArgs&&"saveAsTemplate"===mainbodyArgs.optType&&(params.content.saveType="4"),contentOpts&&(params.content=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({},params.content,contentOpts)),params[data.tableInfo.formmain.tableName]={},__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formmains[data.tableInfo.formmain.tableName]).forEach(function(v){if(-1===__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.auxiliary.indexOf(formmains[data.tableInfo.formmain.tableName][v].ctrlType)){params[data.tableInfo.formmain.tableName][v]=formmains[data.tableInfo.formmain.tableName][v].value||"";var obj=formmains[data.tableInfo.formmain.tableName][v];obj.isCustomField&&obj.hasOwnProperty("customValue")&&(params.customFields[obj.id]=obj.customValue||""),-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.file.indexOf(obj.inputType)||obj.attachmentInfo&&obj.attachmentInfo.attachmentInfos&&obj.attachmentInfo.attachmentInfos.length?(obj.attachmentInfo.attachmentInfos.length?(obj.attachmentInfo.attachmentInfos.forEach(function(val){var attach={reference:obj.attachmentInfo.baseAttachmentInfo.reference,category:obj.attachmentInfo.baseAttachmentInfo.category,mimeType:"document"!==obj.attachmentInfo.baseAttachmentInfo.mimeType?obj.attachmentInfo.baseAttachmentInfo.mimeType:val.mimeType,subReference:"mapphoto"!==obj.type?obj.attachmentInfo.baseAttachmentInfo.subReference:val.subReference,type:obj.attachmentInfo.baseAttachmentInfo.type,genesisId:val.genesisId,description:val.description,sort:val.sort,id:val.id,fileUrl:val.fileUrl,size:val.size,createdate:val.createdate,filename:val.filename};params.attachments.push(attach)}),"mapphoto"!==obj.type&&(obj.valueId=obj.attachmentInfo.baseAttachmentInfo.subReference)):obj.valueId="",params[data.tableInfo.formmain.tableName][v]=obj.valueId):-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.map.indexOf(obj.inputType)?params[data.tableInfo.formmain.tableName][v]=obj.valueId:-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.organize.indexOf(obj.inputType)?params[data.tableInfo.formmain.tableName][v]=obj.valueId:-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.flow.indexOf(obj.inputType)&&(params[data.tableInfo.formmain.tableName][v]=obj.valueId)}}),console.log("formsons"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formsons).forEach(function(v){params[formsons[v].tableName]=[],formsons[v].records.forEach(function(val){if(val){var tempObj={id:val.recordId},fsonLists=val.lists;for(var props in fsonLists)Object.prototype.hasOwnProperty.call(fsonLists,props)&&-1===__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.auxiliary.indexOf(fsonLists[props].ctrlType)&&function(){tempObj[props]=fsonLists[props].value||"";var obj=fsonLists[props];obj.isCustomField&&obj.hasOwnProperty("customValue")&&(params.customFields[props+"_"+val.recordId]=obj.customValue||""),obj.isAttachment?(obj.attachmentInfo.attachmentInfos.length?(obj.attachmentInfo.attachmentInfos.forEach(function(value){var attach={reference:obj.attachmentInfo.baseAttachmentInfo.reference,category:obj.attachmentInfo.baseAttachmentInfo.category,mimeType:"document"!==obj.attachmentInfo.baseAttachmentInfo.mimeType?obj.attachmentInfo.baseAttachmentInfo.mimeType:value.mimeType,subReference:"mapphoto"!==obj.type?obj.attachmentInfo.baseAttachmentInfo.subReference:value.subReference,type:obj.attachmentInfo.baseAttachmentInfo.type,genesisId:value.genesisId,description:value.description,sort:value.sort,id:value.id,fileUrl:value.fileUrl,size:value.size,createdate:value.createdate,filename:value.filename};params.attachments.push(attach)}),"mapphoto"!==obj.type&&(obj.valueId=obj.attachmentInfo.baseAttachmentInfo.subReference)):obj.valueId="",tempObj[props]=obj.valueId):-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.map.indexOf(obj.inputType)?tempObj[props]=obj.valueId:-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.organize.indexOf(obj.inputType)?tempObj[props]=obj.valueId:-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.flow.indexOf(obj.inputType)&&(tempObj[props]=obj.valueId)}();params[formsons[v].tableName].push(tempObj)}})});for(var props in relationSelector)relationSelector.hasOwnProperty(props)&&function(){var rs=params.relationRecords,keyArr=[];if(rs.forEach(function(v){keyArr.push(v.keyId)}),-1===keyArr.indexOf(props))params.relationRecords.push(relationSelector[props]);else for(var i=0,l=rs.length;i<l;i++)if(rs[i].keyId===props){params.relationRecords.splice(i,1,relationSelector[props]);break}}();params.content.operateType=operateType;var formsonNumThreshold=_this.dbData.data.content.formsonNumThreshold;return console.log("formsonNumThreshold",formsonNumThreshold),formsonNumThreshold&&(params[data.tableInfo.formmain.tableName]={},__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formsons).forEach(function(v){params[formsons[v].tableName]=[]})),params};__webpack_exports__.a=getSaveParams},223:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__(44),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1__utils_index__=__webpack_require__(21),store={save:function(cacheKey,cacheData){var deferred=new __WEBPACK_IMPORTED_MODULE_1__utils_index__.c;return cacheData=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.b)(!0,cacheData),cmp.storageDB.save(cacheKey,cacheData,function(result){console.log("cache.save:",cacheKey,cacheData,result),result.success?deferred.resolve(result):deferred.reject()}),deferred},get:function(cacheKey){var deferred=(!(arguments.length>1&&void 0!==arguments[1])||arguments[1],new __WEBPACK_IMPORTED_MODULE_1__utils_index__.c);return cmp.storageDB.get(cacheKey,function(result){if(console.log("cache.get:",cacheKey,result),result.success&&result.data){if(!result.data)return deferred.reject();deferred.resolve(JSON.parse(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(result.data)))}else deferred.reject()}),deferred},remove:function(cacheKey){var deferred=new __WEBPACK_IMPORTED_MODULE_1__utils_index__.c;return cmp.storageDB.delete(cacheKey,function(result){console.log("cache.remove:done",cacheKey),result.success?deferred.resolve(result):deferred.reject()}),deferred}};__webpack_exports__.a=store},224:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return _on}),__webpack_require__.d(__webpack_exports__,"a",function(){return _emit});var __WEBPACK_IMPORTED_MODULE_0_vue__=__webpack_require__(6),hub=new __WEBPACK_IMPORTED_MODULE_0_vue__.default,_on=function(){var _arguments=arguments;return cmp.platform.CMPShell?(_on=function(evtName,handle){cmp.webViewListener.add({type:evtName}),document.addEventListener(evtName,handle)})(arguments[0],arguments[1]):(_on=function(){return hub.$on.apply(hub,_arguments)})(arguments)},_emit=function(){var _arguments2=arguments;return cmp.platform.CMPShell?(_emit=function(evtName,data){cmp.webViewListener.fire({type:evtName,data:data.data})})(arguments[0],arguments[1]):(_emit=function(){return hub.$emit.apply(hub,_arguments2)})(arguments)}},225:function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(228),__esModule:!0}},226:function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _promise=__webpack_require__(46),_promise2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_promise);exports.default=function(fn){return function(){var gen=fn.apply(this,arguments);return new _promise2.default(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}if(!info.done)return _promise2.default.resolve(value).then(function(value){step("next",value)},function(err){step("throw",err)});resolve(value)}return step("next")})}}},227:function(module,exports,__webpack_require__){module.exports=__webpack_require__(232)},228:function(module,exports,__webpack_require__){__webpack_require__(23),__webpack_require__(230),module.exports=__webpack_require__(4).Array.from},229:function(module,exports,__webpack_require__){"use strict";var $defineProperty=__webpack_require__(8),createDesc=__webpack_require__(22);module.exports=function(object,index,value){index in object?$defineProperty.f(object,index,createDesc(0,value)):object[index]=value}},230:function(module,exports,__webpack_require__){"use strict";var ctx=__webpack_require__(10),$export=__webpack_require__(7),toObject=__webpack_require__(237),call=__webpack_require__(48),isArrayIter=__webpack_require__(47),toLength=__webpack_require__(51),createProperty=__webpack_require__(229),getIterFn=__webpack_require__(52);$export($export.S+$export.F*!__webpack_require__(49)(function(iter){Array.from(iter)}),"Array",{from:function(arrayLike){var length,result,step,iterator,O=toObject(arrayLike),C="function"==typeof this?this:Array,aLen=arguments.length,mapfn=aLen>1?arguments[1]:void 0,mapping=void 0!==mapfn,index=0,iterFn=getIterFn(O);if(mapping&&(mapfn=ctx(mapfn,aLen>2?arguments[2]:void 0,2)),void 0==iterFn||C==Array&&isArrayIter(iterFn))for(length=toLength(O.length),result=new C(length);length>index;index++)createProperty(result,index,mapping?mapfn(O[index],index):O[index]);else for(iterator=iterFn.call(O),result=new C;!(step=iterator.next()).done;index++)createProperty(result,index,mapping?call(iterator,mapfn,[step.value,index],!0):step.value);return result.length=index,result}})},231:function(module,exports){},232:function(module,exports,__webpack_require__){var g=function(){return this}()||Function("return this")(),hadRuntime=g.regeneratorRuntime&&Object.getOwnPropertyNames(g).indexOf("regeneratorRuntime")>=0,oldRuntime=hadRuntime&&g.regeneratorRuntime;if(g.regeneratorRuntime=void 0,module.exports=__webpack_require__(50),hadRuntime)g.regeneratorRuntime=oldRuntime;else try{delete g.regeneratorRuntime}catch(e){g.regeneratorRuntime=void 0}},233:function(module,__webpack_exports__,__webpack_require__){"use strict";function injectStyle(ssrContext){__webpack_require__(231)}var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_footers_vue__=__webpack_require__(210),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_56e17a2c_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_footers_vue__=__webpack_require__(236),normalizeComponent=__webpack_require__(42),__vue_styles__=injectStyle,Component=normalizeComponent(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_footers_vue__.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_56e17a2c_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_footers_vue__.a,!1,__vue_styles__,null,null);__webpack_exports__.a=Component.exports},236:function(module,__webpack_exports__,__webpack_require__){"use strict";var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return"new"===_vm.type||"edit"===_vm.type||"sure"===_vm.type||"sure-checkable"===_vm.type?_c("section",{staticClass:"cap4-footers",style:{background:_vm.bg}},["new"===_vm.type?_c("div",{staticClass:"cap4-footers__display is-justify"},[_c("div",{staticClass:"cap4-footers__btn",domProps:{textContent:_vm._s(_vm.$t("foot.saveNew"))},on:{tap:function($event){_vm.saveFormData("saveNew")}}}),_vm._v(" "),_c("div",{staticClass:"cap4-footers__btn",domProps:{textContent:_vm._s(_vm.$t("foot.saveCopy"))},on:{tap:function($event){_vm.saveFormData("saveCopy")}}}),_vm._v(" "),_c("div",{staticClass:"cap4-footers__btn",domProps:{textContent:_vm._s(_vm.$t("foot.save"))},on:{tap:function($event){_vm.saveFormData("save")}}})]):_vm._e(),_vm._v(" "),"edit"===_vm.type?_c("div",{staticClass:"cap4-footers__display is-alone"},[_c("div",{staticClass:"cap4-footers__btn",domProps:{textContent:_vm._s(_vm.$t("foot.save"))},on:{tap:function($event){_vm.saveFormData("save")}}})]):_vm._e(),_vm._v(" "),_vm.type.indexOf("sure")>-1?_c("div",{staticClass:"cap4-footers__display",class:"sure"===_vm.type?"is-alone":"is-alone-checkable"},["sure"!==_vm.type?_c("div",{staticClass:"cap4-footers__checker",on:{tap:_vm.handleCheckAll}},[_vm._v(_vm._s(_vm.checked?"\u53d6\u6d88\u5168\u9009":"\u5168\u9009"))]):_vm._e(),_vm._v(" "),_c("div",{staticClass:"cap4-footers__btn",domProps:{textContent:_vm._s(_vm.$t("foot.sure"))},on:{tap:function($event){_vm.saveFormData("sure")}}})]):_vm._e()]):_vm._e()},staticRenderFns=[],esExports={render:render,staticRenderFns:staticRenderFns};__webpack_exports__.a=esExports},237:function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)(22)},238:function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)(3)},240:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__=__webpack_require__(205),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_1_vue__=__webpack_require__(6),__WEBPACK_IMPORTED_MODULE_2_better_scroll__=__webpack_require__(264),__WEBPACK_IMPORTED_MODULE_3__assets_js_config__=__webpack_require__(54),__WEBPACK_IMPORTED_MODULE_4_form_widget__=__webpack_require__(53),__WEBPACK_IMPORTED_MODULE_5__components_footers_footers_vue__=__webpack_require__(233),__WEBPACK_IMPORTED_MODULE_6__components_relation_list_relation_list_vue__=__webpack_require__(281),__WEBPACK_IMPORTED_MODULE_7__components_add_more_add_more_vue__=__webpack_require__(277),__WEBPACK_IMPORTED_MODULE_8__utils_bridge__=__webpack_require__(202),__WEBPACK_IMPORTED_MODULE_9__utils_hub__=__webpack_require__(224),__WEBPACK_IMPORTED_MODULE_10__business_mixins_form_save__=__webpack_require__(217),__WEBPACK_IMPORTED_MODULE_11__business_mixins_form_relation_js__=__webpack_require__(216),__WEBPACK_IMPORTED_MODULE_12__business_mixins_form_calculate_js__=__webpack_require__(214),__WEBPACK_IMPORTED_MODULE_13__business_mixins_form_formson_js__=__webpack_require__(215),__WEBPACK_IMPORTED_MODULE_14__mixins_form_store__=__webpack_require__(218),__WEBPACK_IMPORTED_MODULE_15__business_mixins_form_util_js__=__webpack_require__(219),__WEBPACK_IMPORTED_MODULE_16__utils_index__=__webpack_require__(21),__WEBPACK_IMPORTED_MODULE_17__business_utils_service__=__webpack_require__(203);__WEBPACK_IMPORTED_MODULE_1_vue__.default.use(__WEBPACK_IMPORTED_MODULE_4_form_widget__.Cap4BaseNone),__WEBPACK_IMPORTED_MODULE_1_vue__.default.use(__WEBPACK_IMPORTED_MODULE_4_form_widget__.Cap4ConditionFilter),__WEBPACK_IMPORTED_MODULE_1_vue__.default.use(__WEBPACK_IMPORTED_MODULE_4_form_widget__.Cap4ConditionContent);var Hub=new __WEBPACK_IMPORTED_MODULE_1_vue__.default;__webpack_exports__.a={name:"Relation",props:["params"],mixins:[__WEBPACK_IMPORTED_MODULE_15__business_mixins_form_util_js__.a,__WEBPACK_IMPORTED_MODULE_14__mixins_form_store__.a,__WEBPACK_IMPORTED_MODULE_10__business_mixins_form_save__.a,__WEBPACK_IMPORTED_MODULE_12__business_mixins_form_calculate_js__.a,__WEBPACK_IMPORTED_MODULE_13__business_mixins_form_formson_js__.a,__WEBPACK_IMPORTED_MODULE_11__business_mixins_form_relation_js__.a],components:{Footers:__WEBPACK_IMPORTED_MODULE_5__components_footers_footers_vue__.a,RelationList:__WEBPACK_IMPORTED_MODULE_6__components_relation_list_relation_list_vue__.a,AddMore:__WEBPACK_IMPORTED_MODULE_7__components_add_more_add_more_vue__.a},data:function(){return{ip:__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.a(),hub:Hub,filterFields:[],none:{text:"\u6682\u65e0\u5185\u5bb9"},bScroll:{},pageSize:__WEBPACK_IMPORTED_MODULE_3__assets_js_config__.a.pageSize,page:1,moreState:!1,fetched:0,data:[],conditions:[],type:"",title:"",formType:"",mergeData:null,relation:{pcRightId:"",phoneRightId:"",toFormId:"",toFormType:""},testData:{id:"field0001",type:"text",ctrlType:"suitext",formType:"formmain",placeHolder:"\u8bf7\u9009\u62e9",ctrlTitleStyle:"inline",radioAlignType:"horizontal",display:"\u5355\u884c\u6587\u672c",value:"",enums:[],isInCalculate:"1",isInCondition:"1",formatType:"",digitNum:"",fieldLength:"255",auth:"add",isNotNull:"1",relation:{}}}},computed:{checkedAll:function(){var checked=this.data.length>0;return this.data.some(function(item){if(!item.state)return checked=!1,!0}),checked}},created:function(){var _this=this;__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.b(function(){cmp.backbutton(),cmp.backbutton.push(function(){return _this.closeWebView("back")})});var forward=__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.c()||{};this._isRelation=!0,this._relationParam=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_16__utils_index__.b)(!0,forward),this.DBKey=forward.DBKey,window.xform=this},mounted:function(){var _this2=this;__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.b(function(){_this2.getFromStore().then(function(ret){_this2.dbData=ret}).then(function(){return _this2.init("init")}),_this2.analysisParams(_this2._relationParam)})},methods:{cmpAlert:function(msg){cmp.dialog.warning(msg,null,"")},organization:function(data,_callback){var params={id:"0",type:data.inputType},extra={fillBackData:[],excludeData:[]};cmp.selectOrgDestory(params.id),cmp.selectOrg(params.id,{type:2,minSize:-1,maxSize:-1===params.type.indexOf("multi")?1:-1,selectType:-1===params.type.indexOf("multi")?params.type:params.type.substr(5,params.type.length),multitype:!1,lightOptsChange:!1,fillback:null,label:["dept","org","post","team","extP"],fillBackData:extra.fillBackData,excludeData:extra.excludeData,vj:!1,callback:function(result){for(var res=JSON.parse(result).orgResult,names="",ids="",i=0;i<res.length;i++)names+=res[i].name,ids+=res[i].id,i!==res.length-1&&(names+=",",ids+=",");_callback&&_callback(names,ids)},closeCallback:function(){}})},datetime:function(data,idx,callback){var options="date"===data.inputType?{type:"date"}:{};data.currentDate&&(options.value=data.currentDate);var picker=new cmp.DtPicker(options);picker.show(function(rs){picker.dispose(),callback&&callback(idx,rs.value)})},chooseCdtion:function(result){this.page=1,this.conditions=result,this.init("filter")},getData:function(type,successCallback,errorCallback){this.real(type,successCallback,errorCallback)},analysisParams:function(params){this.type=params.type,this.title=params.title,this.formType=params.formType,this.mergeData=params.mergeData,document.title=this.title},getRequestParams:function(){var relations=void 0,ownSelector=void 0,tempId=void 0,fdId=void 0,recordId=void 0,fieldId=void 0;switch(this._relationParam.formType){case"formmain":relations=this._relationParam.params.relation,ownSelector=this._relationParam.params.id,tempId=this._relationParam.content.contentTemplateId,fdId=this._relationParam.content.contentDataId,recordId="",fieldId=this._relationParam.params.id;break;case"formson":relations=this._relationParam.params.relation,ownSelector=this._relationParam.params.id,tempId=this._relationParam.content.formId,fdId=this._relationParam.content.formMasterId,recordId=this._relationParam.recordId,fieldId=this._relationParam.params.id;break;case"formInsert":relations=this._relationParam.params.relationInfo,ownSelector=this._relationParam.params.name,tempId=this._relationParam.content.contentTemplateId,fdId=this._relationParam.content.contentDataId,recordId="",fieldId=this._relationParam.params.name}var mainSelecter=relations.mainSelector===ownSelector?"1":"0",masterDataId=void 0;masterDataId="1"===mainSelecter?"":this._relationParam.selectedMasterDataId;var result={relationShipId:relations.relationShipId,isMainSelecter:mainSelecter,selectedMasterDataId:masterDataId,templateId:tempId,fromDataId:fdId,fromRecordId:recordId,fromRelationAttr:fieldId,conditions:this.conditions,page:this.page,pageSize:this.pageSize,mergeData:this._buildSaveRequestParams("save",!0)};return 1===this.page&&delete result.pageSize,result},init:function(type){var _this3=this;this.getData(type,function(result){_this3.setDataState(result),"filter"===type&&(_this3.data=[]),_this3.data=[].concat(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default()(_this3.data),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_toConsumableArray___default()(result)),_this3.fetched+=1,"init"===type?(_this3.moreState=!0,_this3.initScroll(),result.length<_this3.pageSize?_this3.moreState=!1:_this3.finishPullUp()):(_this3.refreshScroll(),result.length<_this3.pageSize?_this3.moreState=!1:_this3.finishPullUp())},function(error){"filter"===type&&(_this3.data=[])})},real:function(type,successCallback,errorCallback){var _this4=this,params=this.getRequestParams();"init"===type?(__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.d("\u6570\u636e\u52a0\u8f7d\u4e2d..."),params.isInit="1"):params.isInit="0",__WEBPACK_IMPORTED_MODULE_17__business_utils_service__.a(params).then(function(res){var data=res.data,code=data.code,message=data.message,error="2013"===code?"\u5173\u8054\u5173\u7cfb\u5df2\u5220\u9664\u6216\u505c\u7528\uff01":"2010"===code?"\u7f13\u5b58\u6570\u636e\u5df2\u5931\u6548\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\u8868\u5355\uff01":message;if("2000"!==code&&error)return __WEBPACK_IMPORTED_MODULE_8__utils_bridge__.e({type:"warning",title:"\u63d0\u793a\u4fe1\u606f",text:error,buttons:["\u786e\u5b9a"],callback:function(){return __WEBPACK_IMPORTED_MODULE_8__utils_bridge__.f()}});"init"===type&&data.filterFields&&(_this4.filterFields=data.filterFields),_this4.relation.pcRightId=data.pcRightId,_this4.relation.phoneRightId=data.phoneRightId,_this4.relation.toFormId=data.toFormId,_this4.relation.toFormType=data.toFormType,_this4.relation.toVersion=data.toVersion,_this4.pageSize=data.pageSize,successCallback(data.data),__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.g()},function(err){errorCallback&&errorCallback(),__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.g(),__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.h("\u83b7\u53d6\u6570\u636e\u5931\u8d25","center",1500,0)})},addMore:function(){this.init("more")},initScroll:function(){var _this5=this;setTimeout(function(){_this5.bScroll=new __WEBPACK_IMPORTED_MODULE_2_better_scroll__.a(".cap4-formRelation__wrapper",{click:!0,pullUpLoad:{threshold:56}}),_this5.bScroll.on("pullingUp",function(){_this5.moreState&&(_this5.page++,_this5.addMore())}),console.log("init")},300)},finishPullUp:function(){var _this6=this;this.$nextTick(function(){_this6.bScroll.finishPullUp()})},refreshScroll:function(){var _this7=this;this.$nextTick(function(){_this7.bScroll.refresh()})},setDataState:function(data){var _this8=this;data.map(function(v){return _this8.$set(v,"state",!1),_this8.$set(v,"showAll",!1),""})},cancelSelect:function(id){var idName=void 0;"formmain"===this.formType?idName="dataId":"formson"===this.formType&&(idName="subDataId"),this.data.forEach(function(v){v[idName]!==id&&(v.state=!1)})},relationEvent:function(params){var pageParams=__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.c();switch(params.type){case"rightClick":var _relation=this.relation,phoneRightId=_relation.phoneRightId,pcRightId=_relation.pcRightId,toVersion=_relation.toVersion,toFormType=_relation.toFormType;if(pcRightId){var payload=void 0;if("1"===toFormType)payload={newWebView:!0,openFrom:"formRelation",affairId:"",summaryId:params.params.summaryId,operationId:"default_form_cap3"===toVersion?pcRightId:this._buildRelationRightId(pcRightId,phoneRightId),baseObjectId:pageParams.content.moduleId,baseApp:"1"};else{var rightId=this._buildRelationRightId(pcRightId,phoneRightId),moduleId=params.params.dataId,moduleType="6"===toFormType?"42":toFormType;payload="default_form_cap3"===toVersion?{rightId:pcRightId,moduleType:moduleType,moduleId:moduleId,contentAllId:moduleId,showType:"browse",viewState:"2",version:"cap3"}:{formType:"formmain",type:"browse",params:{rightId:rightId,moduleId:moduleId,moduleType:moduleType,operateType:"2"}}}__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.i(payload,!0)}break;case"leftClick":"formmain"===this.formType?this.cancelSelect(params.params.subDataId):"formson"===this.formType&&this.cancelSelect(params.params.dataId),params.params.state=!params.params.state;break;case"bottomClick":params.params.showAll=!params.params.showAll,this.refreshScroll()}},handleToggleCheck:function(checked){this.data.forEach(function(item){return item.state=checked})},ok:function(){var fieldId=void 0;switch(this.formType){case"formmain":case"formson":fieldId=this._relationParam.params.id;break;case"formInsert":fieldId=this._relationParam.params.name}var result=this.data.filter(function(v){return v.state});if(0==result.length)return void __WEBPACK_IMPORTED_MODULE_8__utils_bridge__.h("\u8bf7\u9009\u62e9\u6570\u636e","center",1500,0);__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.d("\u4fdd\u5b58\u4e2d...");var rt=this.getRequestParams(),data={relationShipId:rt.relationShipId,fromDataId:rt.fromDataId,fromRecordId:rt.fromRecordId,fromRelationAttr:fieldId,type:this.formType,tbName:this._relationParam.tbName,relation:this.relation,result:result};this.closeWebView(data)},closeWebView:function(relationData){var _this9=this;"back"==relationData?this.saveToStore().then(function(){__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.f()}):"formmain"==this.formType||"formInsert"==this.formType?this.relationFillbackFormmain(relationData).then(function(){return _this9.saveToStore().then(function(){__WEBPACK_IMPORTED_MODULE_9__utils_hub__.a("com.seeyon.m3.SYNC_DB_DATA",{data:{from:"relation",target:"formmain",DBKey:_this9._buildStoreKey(),data:{recordType:"formInsert"==_this9.formType?"new":"",recordId:"",recordTable:relationData.tbName,frontTable:"formInsert"==_this9.formType?_this9._relationParam.frontTableName:""}}})})}).then(function(){__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.f()}):"formson"==this.formType&&this.relationFillbackFormson(relationData).then(function(){_this9.saveToStore().then(function(){__WEBPACK_IMPORTED_MODULE_9__utils_hub__.a("com.seeyon.m3.SYNC_DB_DATA",{data:{from:"relation",target:"formmain",DBKey:_this9._buildStoreKey(),data:{recordId:_this9._relationParam.recordId,recordTable:relationData.tbName,frontTable:_this9._relationParam.frontTableName}}})}).then(function(){__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.f()})})},openWebView:function(route,data){__WEBPACK_IMPORTED_MODULE_8__utils_bridge__.j(route,data,0,!0)}}}},241:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={name:"AddMore",mounted:function(){},components:{},methods:{},computed:{}}},249:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={name:"RelationList",props:["formType","data","page","pageSize"],data:function(){return{initFormType:this.formType}},mounted:function(){},components:{},methods:{relationEvent:function(type,item){var data={params:item};switch(type){case"right":data.type="rightClick";break;case"left":data.type="leftClick";break;case"bottom":data.type="bottomClick"}this.$emit("relationEvent",data)}},computed:{}}},264:function(module,__webpack_exports__,__webpack_require__){"use strict";function getNow(){return window.performance&&window.performance.now?window.performance.now()+window.performance.timing.navigationStart:+new Date}function extend(target){for(var _len=arguments.length,rest=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)rest[_key-1]=arguments[_key];for(var i=0;i<rest.length;i++){var source=rest[i];for(var key in source)target[key]=source[key]}return target}function isUndef(v){return void 0===v||null===v}function getDistance(x,y){return Math.sqrt(x*x+y*y)}function prefixStyle(style){return!1!==vendor&&("standard"===vendor?"transitionEnd"===style?"transitionend":style:vendor+style.charAt(0).toUpperCase()+style.substr(1))}function addEvent(el,type,fn,capture){el.addEventListener(type,fn,{passive:!1,capture:!!capture})}function removeEvent(el,type,fn,capture){el.removeEventListener(type,fn,{passive:!1,capture:!!capture})}function offset(el){for(var left=0,top=0;el;)left-=el.offsetLeft,top-=el.offsetTop,el=el.offsetParent;return{left:left,top:top}}function offsetToBody(el){var rect=el.getBoundingClientRect();return{left:-(rect.left+window.pageXOffset),top:-(rect.top+window.pageYOffset)}}function getRect(el){if(el instanceof window.SVGElement){var rect=el.getBoundingClientRect();return{top:rect.top,left:rect.left,width:rect.width,height:rect.height}}return{top:el.offsetTop,left:el.offsetLeft,width:el.offsetWidth,height:el.offsetHeight}}function preventDefaultException(el,exceptions){for(var i in exceptions)if(exceptions[i].test(el[i]))return!0;return!1}function tap(e,eventName){var ev=document.createEvent("Event");ev.initEvent(eventName,!0,!0),ev.pageX=e.pageX,ev.pageY=e.pageY,e.target.dispatchEvent(ev)}function click(e){function createEvent(){ev=document.createEvent("Event"),ev.initEvent(event,bubbles,cancelable),extend(ev,posSrc)}var event=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"click",eventSource=void 0;"mouseup"===e.type||"mousecancel"===e.type?eventSource=e:"touchend"!==e.type&&"touchcancel"!==e.type||(eventSource=e.changedTouches[0]);var posSrc={};eventSource&&(posSrc.screenX=eventSource.screenX||0,posSrc.screenY=eventSource.screenY||0,posSrc.clientX=eventSource.clientX||0,posSrc.clientY=eventSource.clientY||0);var ev=void 0,bubbles=!0,cancelable=!0;if("undefined"!=typeof MouseEvent)try{ev=new MouseEvent(event,extend({bubbles:bubbles,cancelable:cancelable},posSrc))}catch(e){createEvent()}else createEvent();ev.forwardedTouchEvent=!0,ev._constructed=!0,e.target.dispatchEvent(ev)}function dblclick(e){click(e,"dblclick")}function prepend(el,target){target.firstChild?before(el,target.firstChild):target.appendChild(el)}function before(el,target){target.parentNode.insertBefore(el,target)}function removeChild(el,child){el.removeChild(child)}function momentum(current,start,time,lowerMargin,upperMargin,wrapperSize,options){var distance=current-start,speed=Math.abs(distance)/time,deceleration=options.deceleration,itemHeight=options.itemHeight,swipeBounceTime=options.swipeBounceTime,wheel=options.wheel,swipeTime=options.swipeTime,duration=swipeTime,rate=wheel?4:15,destination=current+speed/deceleration*(distance<0?-1:1);return wheel&&itemHeight&&(destination=Math.round(destination/itemHeight)*itemHeight),destination<lowerMargin?(destination=wrapperSize?Math.max(lowerMargin-wrapperSize/4,lowerMargin-wrapperSize/rate*speed):lowerMargin,duration=swipeBounceTime):destination>upperMargin&&(destination=wrapperSize?Math.min(upperMargin+wrapperSize/4,upperMargin+wrapperSize/rate*speed):upperMargin,duration=swipeBounceTime),{destination:Math.round(destination),duration:duration}}function noop(){}function warn(msg){console.error("[BScroll warn]: "+msg)}function assert(condition,msg){if(!condition)throw new Error("[BScroll] "+msg)}function createScrollbar(direction){var scrollbar=document.createElement("div"),indicator=document.createElement("div");return scrollbar.style.cssText="position:absolute;z-index:9999;pointerEvents:none",indicator.style.cssText="box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px;",indicator.className="bscroll-indicator","horizontal"===direction?(scrollbar.style.cssText+=";height:7px;left:2px;right:2px;bottom:0",indicator.style.height="100%",scrollbar.className="bscroll-horizontal-scrollbar"):(scrollbar.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px",indicator.style.width="100%",scrollbar.className="bscroll-vertical-scrollbar"),scrollbar.style.cssText+=";overflow:hidden",scrollbar.appendChild(indicator),scrollbar}function Indicator(scroller,options){this.wrapper=options.el,this.wrapperStyle=this.wrapper.style,this.indicator=this.wrapper.children[0],this.indicatorStyle=this.indicator.style,this.scroller=scroller,this.direction=options.direction,options.fade?(this.visible=0,this.wrapperStyle.opacity="0"):this.visible=1,this.sizeRatioX=1,this.sizeRatioY=1,this.maxPosX=0,this.maxPosY=0,this.x=0,this.y=0,options.interactive&&this._addDOMEvents()}function isTombstoneNode(node){if(node&&node.classList)return node.classList.contains("tombstone")}function InfiniteScroller(scroller,options){var _this=this;this.options=options,assert("function"==typeof this.options.createTombstone,"Infinite scroll need createTombstone Function to create tombstone"),assert("function"==typeof this.options.fetch,"Infinite scroll need fetch Function to fetch new data."),assert("function"==typeof this.options.render,"Infinite scroll need render Function to render each item."),this.firstAttachedItem=0,this.lastAttachedItem=0,this.anchorScrollTop=0,this.anchorItem={index:0,offset:0},this.tombstoneHeight=0,this.tombstoneWidth=0,this.tombstones=[],this.tombstonesAnimationHandlers=[],this.items=[],this.loadedItems=0,this.requestInProgress=!1,this.hasMore=!0,this.scroller=scroller,this.wrapperEl=this.scroller.wrapper,this.scrollerEl=this.scroller.scroller,this.scroller.on("scroll",function(){_this.onScroll()}),this.scroller.on("resize",function(){_this.onResize()}),this.scroller.on("destroy",function(){_this.destroy()}),this._onResizeHandler=setTimeout(function(){_this.onResize()})}function BScroll(el,options){this.wrapper="string"==typeof el?document.querySelector(el):el,this.wrapper||warn("Can not resolve the wrapper DOM."),this.scroller=this.wrapper.children[0],this.scroller||warn("The wrapper need at least one child element to be scroller."),this.scrollerStyle=this.scroller.style,this._init(el,options)}var slicedToArray=function(){function sliceIterator(arr,i){var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}return function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return sliceIterator(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),toConsumableArray=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)},inBrowser="undefined"!=typeof window,ua=inBrowser&&navigator.userAgent.toLowerCase(),isWeChatDevTools=ua&&/wechatdevtools/.test(ua),isAndroid=ua&&ua.indexOf("android")>0,elementStyle=inBrowser&&document.createElement("div").style,vendor=function(){if(!inBrowser)return!1;var transformNames={webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform",standard:"transform"};for(var key in transformNames)if(void 0!==elementStyle[transformNames[key]])return key;return!1}(),cssVendor=vendor&&"standard"!==vendor?"-"+vendor.toLowerCase()+"-":"",transform=prefixStyle("transform"),transition=prefixStyle("transition"),hasPerspective=inBrowser&&prefixStyle("perspective")in elementStyle,hasTouch=inBrowser&&("ontouchstart"in window||isWeChatDevTools),hasTransform=!1!==transform,hasTransition=inBrowser&&transition in elementStyle,style={transform:transform,transition:transition,transitionTimingFunction:prefixStyle("transitionTimingFunction"),transitionDuration:prefixStyle("transitionDuration"),transitionDelay:prefixStyle("transitionDelay"),transformOrigin:prefixStyle("transformOrigin"),transitionEnd:prefixStyle("transitionEnd")},TOUCH_EVENT=1,eventType={touchstart:TOUCH_EVENT,touchmove:TOUCH_EVENT,touchend:TOUCH_EVENT,mousedown:2,mousemove:2,mouseup:2},DEFAULT_OPTIONS={startX:0,startY:0,scrollX:!1,scrollY:!0,freeScroll:!1,directionLockThreshold:5,eventPassthrough:"",click:!1,tap:!1,bounce:!0,bounceTime:800,momentum:!0,momentumLimitTime:300,momentumLimitDistance:15,swipeTime:2500,swipeBounceTime:500,deceleration:.0015,flickLimitTime:200,flickLimitDistance:100,resizePolling:60,probeType:0,preventDefault:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:!0,useTransition:!0,useTransform:!0,bindToWrapper:!1,disableMouse:hasTouch,disableTouch:!hasTouch,observeDOM:!0,autoBlur:!0,wheel:!1,snap:!1,scrollbar:!1,pullDownRefresh:!1,pullUpLoad:!1,mouseWheel:!1,stopPropagation:!1,zoom:!1,infinity:!1,dblclick:!1},ease={swipe:{style:"cubic-bezier(0.23, 1, 0.32, 1)",fn:function(t){return 1+--t*t*t*t*t}},swipeBounce:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(t){return t*(2-t)}},bounce:{style:"cubic-bezier(0.165, 0.84, 0.44, 1)",fn:function(t){return 1- --t*t*t*t}}},requestAnimationFrame=function(){return inBrowser?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||function(callback){return window.setTimeout(callback,(callback.interval||100/60)/2)}:noop}(),cancelAnimationFrame=function(){return inBrowser?window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||function(id){window.clearTimeout(id)}:noop}(),DIRECTION_UP=1,DIRECTION_DOWN=-1,DIRECTION_LEFT=1,DIRECTION_RIGHT=-1,PROBE_DEBOUNCE=1,PROBE_REALTIME=3;Indicator.prototype.handleEvent=function(e){switch(e.type){case"touchstart":case"mousedown":this._start(e);break;case"touchmove":case"mousemove":this._move(e);break;case"touchend":case"mouseup":case"touchcancel":case"mousecancel":this._end(e)}},Indicator.prototype.refresh=function(){this._shouldShow()&&(this.transitionTime(),this._calculate(),this.updatePosition())},Indicator.prototype.fade=function(visible,hold){var _this2=this;if(!hold||this.visible){var time=visible?250:500;visible=visible?"1":"0",this.wrapperStyle[style.transitionDuration]=time+"ms",clearTimeout(this.fadeTimeout),this.fadeTimeout=setTimeout(function(){_this2.wrapperStyle.opacity=visible,_this2.visible=+visible},0)}},Indicator.prototype.updatePosition=function(){if("vertical"===this.direction){var y=Math.round(this.sizeRatioY*this.scroller.y);if(y<0){this.transitionTime(500);var height=Math.max(this.indicatorHeight+3*y,8);this.indicatorStyle.height=height+"px",y=0}else if(y>this.maxPosY){this.transitionTime(500);var _height=Math.max(this.indicatorHeight-3*(y-this.maxPosY),8);this.indicatorStyle.height=_height+"px",y=this.maxPosY+this.indicatorHeight-_height}else this.indicatorStyle.height=this.indicatorHeight+"px";this.y=y,this.scroller.options.useTransform?this.indicatorStyle[style.transform]="translateY("+y+"px)"+this.scroller.translateZ:this.indicatorStyle.top=y+"px"}else{var x=Math.round(this.sizeRatioX*this.scroller.x);if(x<0){this.transitionTime(500);var width=Math.max(this.indicatorWidth+3*x,8);this.indicatorStyle.width=width+"px",x=0}else if(x>this.maxPosX){this.transitionTime(500);var _width=Math.max(this.indicatorWidth-3*(x-this.maxPosX),8);this.indicatorStyle.width=_width+"px",x=this.maxPosX+this.indicatorWidth-_width}else this.indicatorStyle.width=this.indicatorWidth+"px";this.x=x,this.scroller.options.useTransform?this.indicatorStyle[style.transform]="translateX("+x+"px)"+this.scroller.translateZ:this.indicatorStyle.left=x+"px"}},Indicator.prototype.transitionTime=function(){var time=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.indicatorStyle[style.transitionDuration]=time+"ms"},Indicator.prototype.transitionTimingFunction=function(easing){this.indicatorStyle[style.transitionTimingFunction]=easing},Indicator.prototype.destroy=function(){this._removeDOMEvents(),this.wrapper.parentNode.removeChild(this.wrapper)},Indicator.prototype._start=function(e){var point=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.transitionTime(),this.initiated=!0,this.moved=!1,this.lastPointX=point.pageX,this.lastPointY=point.pageY,this.startTime=getNow(),this._handleMoveEvents(addEvent),this.scroller.trigger("beforeScrollStart")},Indicator.prototype._move=function(e){var point=e.touches?e.touches[0]:e;e.preventDefault(),e.stopPropagation(),this.moved||this.scroller.trigger("scrollStart"),this.moved=!0;var deltaX=point.pageX-this.lastPointX;this.lastPointX=point.pageX;var deltaY=point.pageY-this.lastPointY;this.lastPointY=point.pageY;var newX=this.x+deltaX,newY=this.y+deltaY;this._pos(newX,newY)},Indicator.prototype._end=function(e){if(this.initiated){this.initiated=!1,e.preventDefault(),e.stopPropagation(),this._handleMoveEvents(removeEvent);var snapOption=this.scroller.options.snap;if(snapOption){var speed=snapOption.speed,_snapOption$easing=snapOption.easing,easing=void 0===_snapOption$easing?ease.bounce:_snapOption$easing,snap=this.scroller._nearestSnap(this.scroller.x,this.scroller.y),time=speed||Math.max(Math.max(Math.min(Math.abs(this.scroller.x-snap.x),1e3),Math.min(Math.abs(this.scroller.y-snap.y),1e3)),300);this.scroller.x===snap.x&&this.scroller.y===snap.y||(this.scroller.directionX=0,this.scroller.directionY=0,this.scroller.currentPage=snap,this.scroller.scrollTo(snap.x,snap.y,time,easing))}this.moved&&this.scroller.trigger("scrollEnd",{x:this.scroller.x,y:this.scroller.y})}},Indicator.prototype._pos=function(x,y){x<0?x=0:x>this.maxPosX&&(x=this.maxPosX),y<0?y=0:y>this.maxPosY&&(y=this.maxPosY),x=Math.round(x/this.sizeRatioX),y=Math.round(y/this.sizeRatioY),this.scroller.scrollTo(x,y),this.scroller.trigger("scroll",{x:this.scroller.x,y:this.scroller.y})},Indicator.prototype._shouldShow=function(){return"vertical"===this.direction&&this.scroller.hasVerticalScroll||"horizontal"===this.direction&&this.scroller.hasHorizontalScroll?(this.wrapper.style.display="",!0):(this.wrapper.style.display="none",!1)},Indicator.prototype._calculate=function(){if("vertical"===this.direction){var wrapperHeight=this.wrapper.clientHeight;this.indicatorHeight=Math.max(Math.round(wrapperHeight*wrapperHeight/(this.scroller.scrollerHeight||wrapperHeight||1)),8),this.indicatorStyle.height=this.indicatorHeight+"px",this.maxPosY=wrapperHeight-this.indicatorHeight,this.sizeRatioY=this.maxPosY/this.scroller.maxScrollY}else{var wrapperWidth=this.wrapper.clientWidth;this.indicatorWidth=Math.max(Math.round(wrapperWidth*wrapperWidth/(this.scroller.scrollerWidth||wrapperWidth||1)),8),this.indicatorStyle.width=this.indicatorWidth+"px",this.maxPosX=wrapperWidth-this.indicatorWidth,this.sizeRatioX=this.maxPosX/this.scroller.maxScrollX}},Indicator.prototype._addDOMEvents=function(){var eventOperation=addEvent;this._handleDOMEvents(eventOperation)},Indicator.prototype._removeDOMEvents=function(){var eventOperation=removeEvent;this._handleDOMEvents(eventOperation),this._handleMoveEvents(eventOperation)},Indicator.prototype._handleMoveEvents=function(eventOperation){this.scroller.options.disableTouch||eventOperation(window,"touchmove",this),this.scroller.options.disableMouse||eventOperation(window,"mousemove",this)},Indicator.prototype._handleDOMEvents=function(eventOperation){this.scroller.options.disableTouch||(eventOperation(this.indicator,"touchstart",this),eventOperation(window,"touchend",this)),this.scroller.options.disableMouse||(eventOperation(this.indicator,"mousedown",this),eventOperation(window,"mouseup",this))};var DEFAULT_SCROLL_RUNWAY=2e3;InfiniteScroller.prototype.destroy=function(){var _this2=this;clearTimeout(this._onResizeHandler),this.tombstonesAnimationHandlers.forEach(function(handler){clearTimeout(handler)}),this.tombstonesAnimationHandlers=null,this.items.forEach(function(item){item.node&&(_this2.scrollerEl.removeChild(item.node),item.node=null)}),this.scroller.infiniteScroller=null,this.scroller=null,this.wrapperEl=null,this.scrollerEl=null,this.items=null,this.tombstones=null},InfiniteScroller.prototype.onScroll=function(){var scrollTop=-this.scroller.y,delta=scrollTop-this.anchorScrollTop;this.anchorItem=0===scrollTop?{index:0,offset:0}:this._calculateAnchoredItem(this.anchorItem,delta),this.anchorScrollTop=scrollTop;var lastScreenItem=this._calculateAnchoredItem(this.anchorItem,this.scroller.wrapperHeight),start=this.anchorItem.index,end=lastScreenItem.index;delta<0?(start-=30,end+=10):(start-=10,end+=30),this.fill(start,end),this.maybeRequestContent()},InfiniteScroller.prototype.onResize=function(){var tombstone=this.options.createTombstone();tombstone.style.position="absolute",this.scrollerEl.appendChild(tombstone),tombstone.style.display="",this.tombstoneHeight=tombstone.offsetHeight,this.tombstoneWidth=tombstone.offsetWidth,this.scrollerEl.removeChild(tombstone);for(var i=0;i<this.items.length;i++)this.items[i].height=this.items[i].width=0;this.onScroll()},InfiniteScroller.prototype.fill=function(start,end){this.firstAttachedItem=Math.max(0,start),this.hasMore||(end=Math.min(end,this.items.length)),this.lastAttachedItem=end,this.attachContent()},InfiniteScroller.prototype.maybeRequestContent=function(){var _this3=this;if(!this.requestInProgress&&this.hasMore){var itemsNeeded=this.lastAttachedItem-this.loadedItems;itemsNeeded<=0||(this.requestInProgress=!0,this.options.fetch(itemsNeeded).then(function(items){if(_this3.requestInProgress=!1,items)_this3.addContent(items);else{_this3.hasMore=!1;var tombstoneLen=_this3._removeTombstones(),curPos=0;_this3.anchorItem.index<=_this3.items.length?(curPos=_this3._fixScrollPosition(),_this3._setupAnimations({},curPos),_this3.scroller.resetPosition(_this3.scroller.options.bounceTime)):(_this3.anchorItem.index-=tombstoneLen,curPos=_this3._fixScrollPosition(),_this3._setupAnimations({},curPos),_this3.scroller.stop(),_this3.scroller.resetPosition(),_this3.onScroll())}}))}},InfiniteScroller.prototype.addContent=function(items){for(var i=0;i<items.length;i++)this.items.length<=this.loadedItems&&this._addItem(),this.items[this.loadedItems++].data=items[i];this.attachContent(),this.maybeRequestContent()},InfiniteScroller.prototype.attachContent=function(){var unusedNodes=this._collectUnusedNodes(),tombstoneAnimations=this._createDOMNodes(unusedNodes);this._cleanupUnusedNodes(unusedNodes),this._cacheNodeSize();var curPos=this._fixScrollPosition();this._setupAnimations(tombstoneAnimations,curPos)},InfiniteScroller.prototype.resetMore=function(){this.hasMore=!0},InfiniteScroller.prototype._removeTombstones=function(){for(var markIndex=void 0,tombstoneLen=0,itemLen=this.items.length,i=0;i<itemLen;i++){var currentNode=this.items[i].node,currentData=this.items[i].data;currentNode&&!isTombstoneNode(currentNode)||currentData||(void 0===markIndex&&(markIndex=i),currentNode&&this.scrollerEl.removeChild(currentNode))}return tombstoneLen=itemLen-markIndex,this.items.splice(markIndex),this.lastAttachedItem=Math.min(this.lastAttachedItem,this.items.length),tombstoneLen},InfiniteScroller.prototype._collectUnusedNodes=function(){for(var unusedNodes=[],i=0;i<this.items.length;i++)if(i!==this.firstAttachedItem){var currentNode=this.items[i].node;currentNode&&(isTombstoneNode(currentNode)?(this.tombstones.push(currentNode),this.tombstones[this.tombstones.length-1].style.display="none"):unusedNodes.push(currentNode)),this.items[i].node=null}else i=this.lastAttachedItem-1;return unusedNodes},InfiniteScroller.prototype._createDOMNodes=function(unusedNodes){for(var tombstoneAnimations={},i=this.firstAttachedItem;i<this.lastAttachedItem;i++){for(;this.items.length<=i;)this._addItem();var currentNode=this.items[i].node,currentData=this.items[i].data;if(currentNode){if(!isTombstoneNode(currentNode)||!currentData)continue;currentNode.style.zIndex=1,tombstoneAnimations[i]=[currentNode,this.items[i].top-this.anchorScrollTop],this.items[i].node=null}var node=currentData?this.options.render(currentData,unusedNodes.pop()):this._getTombStone();node.style.position="absolute",this.items[i].top=-1,this.scrollerEl.appendChild(node),this.items[i].node=node}return tombstoneAnimations},InfiniteScroller.prototype._cleanupUnusedNodes=function(unusedNodes){for(;unusedNodes.length;)this.scrollerEl.removeChild(unusedNodes.pop())},InfiniteScroller.prototype._cacheNodeSize=function(){for(var i=this.firstAttachedItem;i<this.lastAttachedItem;i++){var item=this.items[i];if(item.data&&!item.height){var isTombstone=isTombstoneNode(item.node);item.height=isTombstone?this.tombstoneHeight:item.node.offsetHeight,item.width=isTombstone?this.tombstoneWidth:item.node.offsetWidth}}},InfiniteScroller.prototype._fixScrollPosition=function(){this.anchorScrollTop=0;for(var _i=0;_i<this.anchorItem.index;_i++)this.anchorScrollTop+=this.items[_i].height||this.tombstoneHeight;this.anchorScrollTop+=this.anchorItem.offset;for(var curPos=this.anchorScrollTop-this.anchorItem.offset,i=this.anchorItem.index;i>this.firstAttachedItem;)curPos-=this.items[i-1].height||this.tombstoneHeight,i--;return curPos},InfiniteScroller.prototype._setupAnimations=function(tombstoneAnimations,curPos){var _this4=this;for(var i in tombstoneAnimations){var animation=tombstoneAnimations[i];this.items[i].node.style[style.transform]="translateY("+(this.anchorScrollTop+animation[1])+"px) scale("+this.tombstoneWidth/this.items[i].width+", "+this.tombstoneHeight/this.items[i].height+")",this.items[i].node.offsetTop,animation[0].offsetTop,this.items[i].node.style[style.transition]=cssVendor+"transform 200ms"}for(var _i2=this.firstAttachedItem;_i2<this.lastAttachedItem;_i2++){var _animation=tombstoneAnimations[_i2];if(_animation){var tombstoneNode=_animation[0];tombstoneNode.style[style.transition]=cssVendor+"transform 200ms, opacity 200ms",tombstoneNode.style[style.transform]="translateY("+curPos+"px) scale("+this.items[_i2].width/this.tombstoneWidth+", "+this.items[_i2].height/this.tombstoneHeight+")",tombstoneNode.style.opacity=0}curPos!==this.items[_i2].top&&(_animation||(this.items[_i2].node.style[style.transition]=""),this.items[_i2].node.style[style.transform]="translateY("+curPos+"px)"),this.items[_i2].top=curPos,curPos+=this.items[_i2].height||this.tombstoneHeight}this.scroller.maxScrollY=-(curPos-this.scroller.wrapperHeight+(this.hasMore?DEFAULT_SCROLL_RUNWAY:0));var tombstoneAnimationsHandler=setTimeout(function(){for(var _i3 in tombstoneAnimations){var _animation2=tombstoneAnimations[_i3];_animation2[0].style.display="none",_this4.tombstones.push(_animation2[0])}},200);this.tombstonesAnimationHandlers.push(tombstoneAnimationsHandler)},InfiniteScroller.prototype._getTombStone=function(){var tombstone=this.tombstones.pop();return tombstone?(tombstone.style.display="",tombstone.style.opacity=1,tombstone.style[style.transform]="",tombstone.style[style.transition]="",tombstone):this.options.createTombstone()},InfiniteScroller.prototype._addItem=function(){this.items.push({data:null,node:null,height:0,width:0,top:0})},InfiniteScroller.prototype._calculateAnchoredItem=function(initialAnchor,delta){if(0===delta)return initialAnchor;var i=initialAnchor.index,tombstones=0;if((delta+=initialAnchor.offset)<0){for(;delta<0&&i>0&&this.items[i-1].height;)delta+=this.items[i-1].height,i--;tombstones=Math.max(-i,Math.ceil(Math.min(delta,0)/this.tombstoneHeight))}else{for(;delta>0&&i<this.items.length&&this.items[i].height&&this.items[i].height<delta;)delta-=this.items[i].height,i++;(i>=this.items.length||!this.items[i].height)&&(tombstones=Math.floor(Math.max(delta,0)/this.tombstoneHeight))}return i+=tombstones,delta-=tombstones*this.tombstoneHeight,{index:i,offset:delta}},function(BScroll){BScroll.prototype._init=function(el,options){this._handleOptions(options),this._events={},this.x=0,this.y=0,this.directionX=0,this.directionY=0,this.setScale(1),this._addDOMEvents(),this._initExtFeatures(),this._watchTransition(),this.options.observeDOM&&this._initDOMObserver(),this.options.autoBlur&&this._handleAutoBlur(),this.refresh(),this.options.snap||this.scrollTo(this.options.startX,this.options.startY),this.enable()},BScroll.prototype.setScale=function(scale){this.lastScale=isUndef(this.scale)?scale:this.scale,this.scale=scale},BScroll.prototype._handleOptions=function(options){this.options=extend({},DEFAULT_OPTIONS,options),this.translateZ=this.options.HWCompositing&&hasPerspective?" translateZ(0)":"",this.options.useTransition=this.options.useTransition&&hasTransition,this.options.useTransform=this.options.useTransform&&hasTransform,this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault,this.options.scrollX="horizontal"!==this.options.eventPassthrough&&this.options.scrollX,this.options.scrollY="vertical"!==this.options.eventPassthrough&&this.options.scrollY,this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough,this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold,!0===this.options.tap&&(this.options.tap="tap")},BScroll.prototype._addDOMEvents=function(){var eventOperation=addEvent;this._handleDOMEvents(eventOperation)},BScroll.prototype._removeDOMEvents=function(){var eventOperation=removeEvent;this._handleDOMEvents(eventOperation)},BScroll.prototype._handleDOMEvents=function(eventOperation){var target=this.options.bindToWrapper?this.wrapper:window;eventOperation(window,"orientationchange",this),eventOperation(window,"resize",this),this.options.click&&eventOperation(this.wrapper,"click",this,!0),this.options.disableMouse||(eventOperation(this.wrapper,"mousedown",this),eventOperation(target,"mousemove",this),eventOperation(target,"mousecancel",this),eventOperation(target,"mouseup",this)),hasTouch&&!this.options.disableTouch&&(eventOperation(this.wrapper,"touchstart",this),eventOperation(target,"touchmove",this),eventOperation(target,"touchcancel",this),eventOperation(target,"touchend",this)),eventOperation(this.scroller,style.transitionEnd,this)},BScroll.prototype._initExtFeatures=function(){this.options.snap&&this._initSnap(),this.options.scrollbar&&this._initScrollbar(),this.options.pullUpLoad&&this._initPullUp(),this.options.pullDownRefresh&&this._initPullDown(),this.options.wheel&&this._initWheel(),this.options.mouseWheel&&this._initMouseWheel(),this.options.zoom&&this._initZoom(),this.options.infinity&&this._initInfinite()},BScroll.prototype._watchTransition=function(){if("function"==typeof Object.defineProperty){var me=this,isInTransition=!1,key=this.useTransition?"isInTransition":"isAnimating";Object.defineProperty(this,key,{get:function(){return isInTransition},set:function(newVal){isInTransition=newVal;for(var el=me.scroller.children.length?me.scroller.children:[me.scroller],pointerEvents=isInTransition&&!me.pulling?"none":"auto",i=0;i<el.length;i++)el[i].style.pointerEvents=pointerEvents}})}},BScroll.prototype._handleAutoBlur=function(){this.on("scrollStart",function(){var activeElement=document.activeElement;!activeElement||"INPUT"!==activeElement.tagName&&"TEXTAREA"!==activeElement.tagName||activeElement.blur()})},BScroll.prototype._initDOMObserver=function(){var _this=this;if("undefined"!=typeof MutationObserver){var timer=void 0,observer=new MutationObserver(function(mutations){if(!_this._shouldNotRefresh()){for(var immediateRefresh=!1,deferredRefresh=!1,i=0;i<mutations.length;i++){var mutation=mutations[i];if("attributes"!==mutation.type){immediateRefresh=!0;break}if(mutation.target!==_this.scroller){deferredRefresh=!0;break}}immediateRefresh?_this.refresh():deferredRefresh&&(clearTimeout(timer),timer=setTimeout(function(){_this._shouldNotRefresh()||_this.refresh()},60))}}),config={attributes:!0,childList:!0,subtree:!0};observer.observe(this.scroller,config),this.on("destroy",function(){observer.disconnect()})}else this._checkDOMUpdate()},BScroll.prototype._shouldNotRefresh=function(){var outsideBoundaries=this.x>this.minScrollX||this.x<this.maxScrollX||this.y>this.minScrollY||this.y<this.maxScrollY;return this.isInTransition||this.stopFromTransition||outsideBoundaries},BScroll.prototype._checkDOMUpdate=function(){function check(){if(!this.destroyed){scrollerRect=getRect(this.scroller);var newWidth=scrollerRect.width,newHeight=scrollerRect.height;oldWidth===newWidth&&oldHeight===newHeight||this.refresh(),oldWidth=newWidth,oldHeight=newHeight,next.call(this)}}function next(){var _this2=this;setTimeout(function(){check.call(_this2)},1e3)}var scrollerRect=getRect(this.scroller),oldWidth=scrollerRect.width,oldHeight=scrollerRect.height;next.call(this)},BScroll.prototype.handleEvent=function(e){switch(e.type){case"touchstart":case"mousedown":this._start(e),this.options.zoom&&e.touches&&e.touches.length>1&&this._zoomStart(e);break;case"touchmove":case"mousemove":this.options.zoom&&e.touches&&e.touches.length>1?this._zoom(e):this._move(e);break;case"touchend":case"mouseup":case"touchcancel":case"mousecancel":this.scaled?this._zoomEnd(e):this._end(e);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(e);break;case"click":this.enabled&&!e._constructed&&(preventDefaultException(e.target,this.options.preventDefaultException)||(e.preventDefault(),e.stopPropagation()));break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._onMouseWheel(e)}},BScroll.prototype.refresh=function(){var isWrapperStatic="static"===window.getComputedStyle(this.wrapper,null).position,wrapperRect=getRect(this.wrapper);this.wrapperWidth=wrapperRect.width,this.wrapperHeight=wrapperRect.height;var scrollerRect=getRect(this.scroller);this.scrollerWidth=Math.round(scrollerRect.width*this.scale),this.scrollerHeight=Math.round(scrollerRect.height*this.scale),this.relativeX=scrollerRect.left,this.relativeY=scrollerRect.top,isWrapperStatic&&(this.relativeX-=wrapperRect.left,this.relativeY-=wrapperRect.top),this.minScrollX=0,this.minScrollY=0;var wheel=this.options.wheel;wheel?(this.items=this.scroller.children,this.options.itemHeight=this.itemHeight=this.items.length?this.scrollerHeight/this.items.length:0,void 0===this.selectedIndex&&(this.selectedIndex=wheel.selectedIndex||0),this.options.startY=-this.selectedIndex*this.itemHeight,this.maxScrollX=0,this.maxScrollY=-this.itemHeight*(this.items.length-1)):(this.maxScrollX=this.wrapperWidth-this.scrollerWidth,this.options.infinity||(this.maxScrollY=this.wrapperHeight-this.scrollerHeight),this.maxScrollX<0?(this.maxScrollX-=this.relativeX,this.minScrollX=-this.relativeX):this.scale>1&&(this.maxScrollX=this.maxScrollX/2-this.relativeX,this.minScrollX=this.maxScrollX),this.maxScrollY<0?(this.maxScrollY-=this.relativeY,this.minScrollY=-this.relativeY):this.scale>1&&(this.maxScrollY=this.maxScrollY/2-this.relativeY,this.minScrollY=this.maxScrollY)),this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<this.minScrollX,this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<this.minScrollY,this.hasHorizontalScroll||(this.maxScrollX=this.minScrollX,this.scrollerWidth=this.wrapperWidth),this.hasVerticalScroll||(this.maxScrollY=this.minScrollY,this.scrollerHeight=this.wrapperHeight),this.endTime=0,this.directionX=0,this.directionY=0,this.wrapperOffset=offset(this.wrapper),this.trigger("refresh"),!this.scaled&&this.resetPosition()},BScroll.prototype.enable=function(){this.enabled=!0},BScroll.prototype.disable=function(){this.enabled=!1}}(BScroll),function(BScroll){BScroll.prototype._start=function(e){var _eventType=eventType[e.type];if((_eventType===TOUCH_EVENT||0===e.button)&&!(!this.enabled||this.destroyed||this.initiated&&this.initiated!==_eventType)){this.initiated=_eventType,this.options.preventDefault&&!preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault(),this.options.stopPropagation&&e.stopPropagation(),this.moved=!1,this.distX=0,this.distY=0,this.directionX=0,this.directionY=0,this.movingDirectionX=0,this.movingDirectionY=0,this.directionLocked=0,this._transitionTime(),this.startTime=getNow(),this.options.wheel&&(this.target=e.target),this.stop();var point=e.touches?e.touches[0]:e;this.startX=this.x,this.startY=this.y,this.absStartX=this.x,this.absStartY=this.y,this.pointX=point.pageX,this.pointY=point.pageY,this.trigger("beforeScrollStart")}},BScroll.prototype._move=function(e){if(this.enabled&&!this.destroyed&&eventType[e.type]===this.initiated){this.options.preventDefault&&e.preventDefault(),this.options.stopPropagation&&e.stopPropagation();var point=e.touches?e.touches[0]:e,deltaX=point.pageX-this.pointX,deltaY=point.pageY-this.pointY;this.pointX=point.pageX,this.pointY=point.pageY,this.distX+=deltaX,this.distY+=deltaY;var absDistX=Math.abs(this.distX),absDistY=Math.abs(this.distY),timestamp=getNow();if(!(timestamp-this.endTime>this.options.momentumLimitTime&&absDistY<this.options.momentumLimitDistance&&absDistX<this.options.momentumLimitDistance)){if(this.directionLocked||this.options.freeScroll||(absDistX>absDistY+this.options.directionLockThreshold?this.directionLocked="h":absDistY>=absDistX+this.options.directionLockThreshold?this.directionLocked="v":this.directionLocked="n"),"h"===this.directionLocked){if("vertical"===this.options.eventPassthrough)e.preventDefault();else if("horizontal"===this.options.eventPassthrough)return void(this.initiated=!1);deltaY=0}else if("v"===this.directionLocked){if("horizontal"===this.options.eventPassthrough)e.preventDefault();else if("vertical"===this.options.eventPassthrough)return void(this.initiated=!1);deltaX=0}deltaX=this.hasHorizontalScroll?deltaX:0,deltaY=this.hasVerticalScroll?deltaY:0,this.movingDirectionX=deltaX>0?DIRECTION_RIGHT:deltaX<0?DIRECTION_LEFT:0,this.movingDirectionY=deltaY>0?DIRECTION_DOWN:deltaY<0?DIRECTION_UP:0;var newX=this.x+deltaX,newY=this.y+deltaY,top=!1,bottom=!1,left=!1,right=!1,bounce=this.options.bounce;!1!==bounce&&(top=void 0===bounce.top||bounce.top,bottom=void 0===bounce.bottom||bounce.bottom,left=void 0===bounce.left||bounce.left,right=void 0===bounce.right||bounce.right),(newX>this.minScrollX||newX<this.maxScrollX)&&(newX=newX>this.minScrollX&&left||newX<this.maxScrollX&&right?this.x+deltaX/3:newX>this.minScrollX?this.minScrollX:this.maxScrollX),(newY>this.minScrollY||newY<this.maxScrollY)&&(newY=newY>this.minScrollY&&top||newY<this.maxScrollY&&bottom?this.y+deltaY/3:newY>this.minScrollY?this.minScrollY:this.maxScrollY),this.moved||(this.moved=!0,this.trigger("scrollStart")),this._translate(newX,newY),timestamp-this.startTime>this.options.momentumLimitTime&&(this.startTime=timestamp,this.startX=this.x,this.startY=this.y,this.options.probeType===PROBE_DEBOUNCE&&this.trigger("scroll",{x:this.x,y:this.y})),this.options.probeType>PROBE_DEBOUNCE&&this.trigger("scroll",{x:this.x,y:this.y});var scrollLeft=document.documentElement.scrollLeft||window.pageXOffset||document.body.scrollLeft,scrollTop=document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop,pX=this.pointX-scrollLeft,pY=this.pointY-scrollTop;(pX>document.documentElement.clientWidth-this.options.momentumLimitDistance||pX<this.options.momentumLimitDistance||pY<this.options.momentumLimitDistance||pY>document.documentElement.clientHeight-this.options.momentumLimitDistance)&&this._end(e)}}},BScroll.prototype._end=function(e){if(this.enabled&&!this.destroyed&&eventType[e.type]===this.initiated){this.initiated=!1,this.options.preventDefault&&!preventDefaultException(e.target,this.options.preventDefaultException)&&e.preventDefault(),this.options.stopPropagation&&e.stopPropagation(),this.trigger("touchEnd",{x:this.x,y:this.y}),this.isInTransition=!1;var newX=Math.round(this.x),newY=Math.round(this.y),deltaX=newX-this.absStartX,deltaY=newY-this.absStartY;if(this.directionX=deltaX>0?DIRECTION_RIGHT:deltaX<0?DIRECTION_LEFT:0,this.directionY=deltaY>0?DIRECTION_DOWN:deltaY<0?DIRECTION_UP:0,!this.options.pullDownRefresh||!this._checkPullDown()){if(this._checkClick(e))return void this.trigger("scrollCancel");if(!this.resetPosition(this.options.bounceTime,ease.bounce)){this._translate(newX,newY),this.endTime=getNow();var duration=this.endTime-this.startTime,absDistX=Math.abs(newX-this.startX),absDistY=Math.abs(newY-this.startY);if(this._events.flick&&duration<this.options.flickLimitTime&&absDistX<this.options.flickLimitDistance&&absDistY<this.options.flickLimitDistance)return void this.trigger("flick");var time=0;if(this.options.momentum&&duration<this.options.momentumLimitTime&&(absDistY>this.options.momentumLimitDistance||absDistX>this.options.momentumLimitDistance)){var top=!1,bottom=!1,left=!1,right=!1,bounce=this.options.bounce;!1!==bounce&&(top=void 0===bounce.top||bounce.top,bottom=void 0===bounce.bottom||bounce.bottom,left=void 0===bounce.left||bounce.left,right=void 0===bounce.right||bounce.right);var wrapperWidth=this.directionX===DIRECTION_RIGHT&&left||this.directionX===DIRECTION_LEFT&&right?this.wrapperWidth:0,wrapperHeight=this.directionY===DIRECTION_DOWN&&top||this.directionY===DIRECTION_UP&&bottom?this.wrapperHeight:0,momentumX=this.hasHorizontalScroll?momentum(this.x,this.startX,duration,this.maxScrollX,this.minScrollX,wrapperWidth,this.options):{destination:newX,duration:0},momentumY=this.hasVerticalScroll?momentum(this.y,this.startY,duration,this.maxScrollY,this.minScrollY,wrapperHeight,this.options):{destination:newY,duration:0};newX=momentumX.destination,newY=momentumY.destination,time=Math.max(momentumX.duration,momentumY.duration),this.isInTransition=!0}else this.options.wheel&&(newY=Math.round(newY/this.itemHeight)*this.itemHeight,time=this.options.wheel.adjustTime||400);var easing=ease.swipe;if(this.options.snap){var snap=this._nearestSnap(newX,newY);this.currentPage=snap,time=this.options.snapSpeed||Math.max(Math.max(Math.min(Math.abs(newX-snap.x),1e3),Math.min(Math.abs(newY-snap.y),1e3)),300),newX=snap.x,newY=snap.y,this.directionX=0,this.directionY=0,easing=this.options.snap.easing||ease.bounce}if(newX!==this.x||newY!==this.y)return(newX>this.minScrollX||newX<this.maxScrollX||newY>this.minScrollY||newY<this.maxScrollY)&&(easing=ease.swipeBounce),void this.scrollTo(newX,newY,time,easing);this.options.wheel&&(this.selectedIndex=Math.round(Math.abs(this.y/this.itemHeight))),this.trigger("scrollEnd",{x:this.x,y:this.y})}}}},BScroll.prototype._checkClick=function(e){var preventClick=this.stopFromTransition&&!this.pulling;if(this.stopFromTransition=!1,!this.moved){if(this.options.wheel){if(this.target&&this.target.classList.contains(this.options.wheel.wheelWrapperClass)){var index=Math.abs(Math.round(this.y/this.itemHeight)),_offset=Math.round((this.pointY+offsetToBody(this.wrapper).top-this.wrapperHeight/2)/this.itemHeight);this.target=this.items[index+_offset]}return this.scrollToElement(this.target,this.options.wheel.adjustTime||400,!0,!0,ease.swipe),!0}if(!preventClick){var _dblclick=this.options.dblclick,dblclickTrigged=!1;if(_dblclick&&this.lastClickTime){var _dblclick$delay=_dblclick.delay,delay=void 0===_dblclick$delay?300:_dblclick$delay;getNow()-this.lastClickTime<delay&&(dblclickTrigged=!0,dblclick(e))}return this.options.tap&&tap(e,this.options.tap),this.options.click&&!preventDefaultException(e.target,this.options.preventDefaultException)&&click(e),this.lastClickTime=dblclickTrigged?null:getNow(),!0}return!1}return!1},BScroll.prototype._resize=function(){var _this=this;this.enabled&&(isAndroid&&(this.wrapper.scrollTop=0),clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){_this.refresh()},this.options.resizePolling))},BScroll.prototype._startProbe=function(){function probe(){var pos=me.getComputedPosition();if(me.trigger("scroll",pos),!me.isInTransition)return void me.trigger("scrollEnd",pos);me.probeTimer=requestAnimationFrame(probe)}cancelAnimationFrame(this.probeTimer),this.probeTimer=requestAnimationFrame(probe);var me=this},BScroll.prototype._transitionTime=function(){var time=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.scrollerStyle[style.transitionDuration]=time+"ms",this.options.wheel)for(var i=0;i<this.items.length;i++)this.items[i].style[style.transitionDuration]=time+"ms";if(this.indicators)for(var _i=0;_i<this.indicators.length;_i++)this.indicators[_i].transitionTime(time)},BScroll.prototype._transitionTimingFunction=function(easing){if(this.scrollerStyle[style.transitionTimingFunction]=easing,this.options.wheel)for(var i=0;i<this.items.length;i++)this.items[i].style[style.transitionTimingFunction]=easing;if(this.indicators)for(var _i2=0;_i2<this.indicators.length;_i2++)this.indicators[_i2].transitionTimingFunction(easing)},BScroll.prototype._transitionEnd=function(e){e.target===this.scroller&&this.isInTransition&&(this._transitionTime(),(!this.pulling||this.movingDirectionY===DIRECTION_UP)&&!this.resetPosition(this.options.bounceTime,ease.bounce)&&(this.isInTransition=!1,this.options.probeType!==PROBE_REALTIME&&this.trigger("scrollEnd",{x:this.x,y:this.y})))},BScroll.prototype._translate=function(x,y,scale){if(assert(!isUndef(x)&&!isUndef(y),"Translate x or y is null or undefined."),isUndef(scale)&&(scale=this.scale),this.options.useTransform?this.scrollerStyle[style.transform]="translate("+x+"px,"+y+"px) scale("+scale+")"+this.translateZ:(x=Math.round(x),y=Math.round(y),this.scrollerStyle.left=x+"px",this.scrollerStyle.top=y+"px"),this.options.wheel)for(var _options$wheel$rotate=this.options.wheel.rotate,rotate=void 0===_options$wheel$rotate?25:_options$wheel$rotate,i=0;i<this.items.length;i++){var deg=rotate*(y/this.itemHeight+i);this.items[i].style[style.transform]="rotateX("+deg+"deg)"}if(this.x=x,this.y=y,this.setScale(scale),this.indicators)for(var _i3=0;_i3<this.indicators.length;_i3++)this.indicators[_i3].updatePosition()},BScroll.prototype._animate=function(destX,destY,duration,easingFn){function step(){var now=getNow();if(now>=destTime)return me.isAnimating=!1,me._translate(destX,destY,destScale),me.trigger("scroll",{x:me.x,y:me.y}),void(me.pulling||me.resetPosition(me.options.bounceTime)||me.trigger("scrollEnd",{x:me.x,y:me.y}));now=(now-startTime)/duration;var easing=easingFn(now),newX=(destX-startX)*easing+startX,newY=(destY-startY)*easing+startY,newScale=(destScale-startScale)*easing+startScale;me._translate(newX,newY,newScale),me.isAnimating&&(me.animateTimer=requestAnimationFrame(step)),me.options.probeType===PROBE_REALTIME&&me.trigger("scroll",{x:me.x,y:me.y})}var me=this,startX=this.x,startY=this.y,startScale=this.lastScale,destScale=this.scale,startTime=getNow(),destTime=startTime+duration;this.isAnimating=!0,cancelAnimationFrame(this.animateTimer),step()},BScroll.prototype.scrollBy=function(x,y){var time=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,easing=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ease.bounce;x=this.x+x,y=this.y+y,this.scrollTo(x,y,time,easing)},BScroll.prototype.scrollTo=function(x,y){var time=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,easing=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ease.bounce;this.isInTransition=this.options.useTransition&&time>0&&(x!==this.x||y!==this.y),!time||this.options.useTransition?(this._transitionTimingFunction(easing.style),this._transitionTime(time),this._translate(x,y),time&&this.options.probeType===PROBE_REALTIME&&this._startProbe(),time||x===this.x&&y===this.y||(this.trigger("scroll",{x:x,y:y}),this._reflow=document.body.offsetHeight,this.resetPosition(this.options.bounceTime,ease.bounce)||this.trigger("scrollEnd",{x:x,y:y})),this.options.wheel&&(y>this.minScrollY?this.selectedIndex=0:y<this.maxScrollY?this.selectedIndex=this.items.length-1:this.selectedIndex=Math.round(Math.abs(y/this.itemHeight)))):this._animate(x,y,time,easing.fn)},BScroll.prototype.scrollToElement=function(el,time,offsetX,offsetY,easing){if(el&&(el=el.nodeType?el:this.scroller.querySelector(el),!this.options.wheel||el.classList.contains(this.options.wheel.wheelItemClass))){var pos=offset(el);pos.left-=this.wrapperOffset.left,pos.top-=this.wrapperOffset.top,!0===offsetX&&(offsetX=Math.round(el.offsetWidth/2-this.wrapper.offsetWidth/2)),!0===offsetY&&(offsetY=Math.round(el.offsetHeight/2-this.wrapper.offsetHeight/2)),pos.left-=offsetX||0,pos.top-=offsetY||0,pos.left=pos.left>this.minScrollX?this.minScrollX:pos.left<this.maxScrollX?this.maxScrollX:pos.left,pos.top=pos.top>this.minScrollY?this.minScrollY:pos.top<this.maxScrollY?this.maxScrollY:pos.top,this.options.wheel&&(pos.top=Math.round(pos.top/this.itemHeight)*this.itemHeight),this.scrollTo(pos.left,pos.top,time,easing)}},BScroll.prototype.resetPosition=function(){var time=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,easeing=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ease.bounce,x=this.x,roundX=Math.round(x);!this.hasHorizontalScroll||roundX>this.minScrollX?x=this.minScrollX:roundX<this.maxScrollX&&(x=this.maxScrollX);var y=this.y,roundY=Math.round(y);return!this.hasVerticalScroll||roundY>this.minScrollY?y=this.minScrollY:roundY<this.maxScrollY&&(y=this.maxScrollY),(x!==this.x||y!==this.y)&&(this.scrollTo(x,y,time,easeing),!0)},BScroll.prototype.getComputedPosition=function(){var matrix=window.getComputedStyle(this.scroller,null),x=void 0,y=void 0;return this.options.useTransform?(matrix=matrix[style.transform].split(")")[0].split(", "),x=+(matrix[12]||matrix[4]),y=+(matrix[13]||matrix[5])):(x=+matrix.left.replace(/[^-\d.]/g,""),y=+matrix.top.replace(/[^-\d.]/g,"")),{x:x,y:y}},BScroll.prototype.stop=function(){if(this.options.useTransition&&this.isInTransition){this.isInTransition=!1,cancelAnimationFrame(this.probeTimer);var pos=this.getComputedPosition();this._translate(pos.x,pos.y),this.options.wheel?this.target=this.items[Math.round(-pos.y/this.itemHeight)]:this.trigger("scrollEnd",{x:this.x,y:this.y}),this.stopFromTransition=!0}else!this.options.useTransition&&this.isAnimating&&(this.isAnimating=!1,cancelAnimationFrame(this.animateTimer),this.trigger("scrollEnd",{x:this.x,y:this.y}),this.stopFromTransition=!0)},BScroll.prototype.destroy=function(){this.destroyed=!0,this.trigger("destroy"),cancelAnimationFrame(this.options.useTransition?this.probeTimer:this.animateTimer),this._removeDOMEvents(),this._events={}}}(BScroll),function(BScroll){BScroll.prototype.on=function(type,fn){var context=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._events[type]||(this._events[type]=[]),this._events[type].push([fn,context])},BScroll.prototype.once=function(type,fn){function magic(){this.off(type,magic),fn.apply(context,arguments)}var context=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;magic.fn=fn,this.on(type,magic)},BScroll.prototype.off=function(type,fn){var _events=this._events[type];if(_events)for(var count=_events.length;count--;)(_events[count][0]===fn||_events[count][0]&&_events[count][0].fn===fn)&&(_events[count][0]=void 0)},BScroll.prototype.trigger=function(type){var events=this._events[type];if(events)for(var len=events.length,eventsCopy=[].concat(toConsumableArray(events)),i=0;i<len;i++){var event=eventsCopy[i],_event=slicedToArray(event,2),fn=_event[0],context=_event[1];fn&&fn.apply(context,[].slice.call(arguments,1))}}}(BScroll),function(BScroll){BScroll.prototype._initSnap=function(){var _this=this;this.currentPage={};var snap=this.options.snap;if(snap.loop){var children=this.scroller.children;children.length>1?(prepend(children[children.length-1].cloneNode(!0),this.scroller),this.scroller.appendChild(children[1].cloneNode(!0))):snap.loop=!1}var el=snap.el;"string"==typeof el&&(el=this.scroller.querySelectorAll(el)),this.on("refresh",function(){if(_this.pages=[],_this.wrapperWidth&&_this.wrapperHeight&&_this.scrollerWidth&&_this.scrollerHeight){var stepX=snap.stepX||_this.wrapperWidth,stepY=snap.stepY||_this.wrapperHeight,x=0,y=void 0,cx=void 0,cy=void 0,i=0,l=void 0,m=0,n=void 0,rect=void 0;if(el)for(l=el.length,n=-1;i<l;i++)rect=getRect(el[i]),(0===i||rect.left<=getRect(el[i-1]).left)&&(m=0,n++),_this.pages[m]||(_this.pages[m]=[]),x=Math.max(-rect.left,_this.maxScrollX),y=Math.max(-rect.top,_this.maxScrollY),cx=x-Math.round(rect.width/2),cy=y-Math.round(rect.height/2),_this.pages[m][n]={x:x,y:y,width:rect.width,height:rect.height,cx:cx,cy:cy},x>_this.maxScrollX&&m++;else for(cx=Math.round(stepX/2),cy=Math.round(stepY/2);x>-_this.scrollerWidth;){for(_this.pages[i]=[],l=0,y=0;y>-_this.scrollerHeight;)_this.pages[i][l]={x:Math.max(x,_this.maxScrollX),y:Math.max(y,_this.maxScrollY),width:stepX,height:stepY,cx:x-cx,cy:y-cy},y-=stepY,l++;x-=stepX,i++}_this._checkSnapLoop();var initPageX=snap._loopX?1:0,initPageY=snap._loopY?1:0;_this._goToPage(_this.currentPage.pageX||initPageX,_this.currentPage.pageY||initPageY,0);var snapThreshold=snap.threshold;snapThreshold%1==0?(_this.snapThresholdX=snapThreshold,_this.snapThresholdY=snapThreshold):(_this.snapThresholdX=Math.round(_this.pages[_this.currentPage.pageX][_this.currentPage.pageY].width*snapThreshold),_this.snapThresholdY=Math.round(_this.pages[_this.currentPage.pageX][_this.currentPage.pageY].height*snapThreshold))}}),this.on("scrollEnd",function(){snap.loop&&(snap._loopX?(0===_this.currentPage.pageX&&_this._goToPage(_this.pages.length-2,_this.currentPage.pageY,0),_this.currentPage.pageX===_this.pages.length-1&&_this._goToPage(1,_this.currentPage.pageY,0)):(0===_this.currentPage.pageY&&_this._goToPage(_this.currentPage.pageX,_this.pages[0].length-2,0),_this.currentPage.pageY===_this.pages[0].length-1&&_this._goToPage(_this.currentPage.pageX,1,0)))}),!1!==snap.listenFlick&&this.on("flick",function(){var time=snap.speed||Math.max(Math.max(Math.min(Math.abs(_this.x-_this.startX),1e3),Math.min(Math.abs(_this.y-_this.startY),1e3)),300);_this._goToPage(_this.currentPage.pageX+_this.directionX,_this.currentPage.pageY+_this.directionY,time)}),this.on("destroy",function(){if(snap.loop){var _children=_this.scroller.children;_children.length>2&&(removeChild(_this.scroller,_children[_children.length-1]),removeChild(_this.scroller,_children[0]))}})},BScroll.prototype._checkSnapLoop=function(){var snap=this.options.snap;snap.loop&&this.pages&&this.pages.length&&(this.pages.length>1&&(snap._loopX=!0),this.pages[0]&&this.pages[0].length>1&&(snap._loopY=!0),snap._loopX&&snap._loopY&&warn("Loop does not support two direction at the same time."))},BScroll.prototype._nearestSnap=function(x,y){if(!this.pages.length)return{x:0,y:0,pageX:0,pageY:0};var i=0;if(Math.abs(x-this.absStartX)<=this.snapThresholdX&&Math.abs(y-this.absStartY)<=this.snapThresholdY)return this.currentPage;x>this.minScrollX?x=this.minScrollX:x<this.maxScrollX&&(x=this.maxScrollX),y>this.minScrollY?y=this.minScrollY:y<this.maxScrollY&&(y=this.maxScrollY);for(var l=this.pages.length;i<l;i++)if(x>=this.pages[i][0].cx){x=this.pages[i][0].x;break}l=this.pages[i].length;for(var m=0;m<l;m++)if(y>=this.pages[0][m].cy){y=this.pages[0][m].y;break}return i===this.currentPage.pageX&&(i+=this.directionX,i<0?i=0:i>=this.pages.length&&(i=this.pages.length-1),x=this.pages[i][0].x),m===this.currentPage.pageY&&(m+=this.directionY,m<0?m=0:m>=this.pages[0].length&&(m=this.pages[0].length-1),y=this.pages[0][m].y),{x:x,y:y,pageX:i,pageY:m}},BScroll.prototype._goToPage=function(x){var y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,time=arguments[2],easing=arguments[3],snap=this.options.snap;if(snap&&this.pages&&this.pages.length&&(easing=easing||snap.easing||ease.bounce,x>=this.pages.length?x=this.pages.length-1:x<0&&(x=0),this.pages[x])){y>=this.pages[x].length?y=this.pages[x].length-1:y<0&&(y=0);var posX=this.pages[x][y].x,posY=this.pages[x][y].y;time=void 0===time?snap.speed||Math.max(Math.max(Math.min(Math.abs(posX-this.x),1e3),Math.min(Math.abs(posY-this.y),1e3)),300):time,this.currentPage={x:posX,y:posY,pageX:x,pageY:y},this.scrollTo(posX,posY,time,easing)}},BScroll.prototype.goToPage=function(x,y,time,easing){var snap=this.options.snap;if(snap&&this.pages&&this.pages.length){if(snap.loop){var len=void 0;snap._loopX?(len=this.pages.length-2,x>=len?x=len-1:x<0&&(x=0),x+=1):(len=this.pages[0].length-2,y>=len?y=len-1:y<0&&(y=0),y+=1)}this._goToPage(x,y,time,easing)}},BScroll.prototype.next=function(time,easing){if(this.options.snap){var x=this.currentPage.pageX,y=this.currentPage.pageY;x++,x>=this.pages.length&&this.hasVerticalScroll&&(x=0,y++),this._goToPage(x,y,time,easing)}},BScroll.prototype.prev=function(time,easing){if(this.options.snap){var x=this.currentPage.pageX,y=this.currentPage.pageY;x--,x<0&&this.hasVerticalScroll&&(x=0,y--),this._goToPage(x,y,time,easing)}},BScroll.prototype.getCurrentPage=function(){var snap=this.options.snap;return snap?snap.loop?snap._loopX?extend({},this.currentPage,{pageX:this.currentPage.pageX-1}):extend({},this.currentPage,{pageY:this.currentPage.pageY-1}):this.currentPage:null}}(BScroll),function(BScroll){BScroll.prototype.wheelTo=function(){var index=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.options.wheel&&(this.y=-index*this.itemHeight,this.scrollTo(0,this.y))},BScroll.prototype.getSelectedIndex=function(){return this.options.wheel&&this.selectedIndex},BScroll.prototype._initWheel=function(){var wheel=this.options.wheel;wheel.wheelWrapperClass||(wheel.wheelWrapperClass="wheel-scroll"),wheel.wheelItemClass||(wheel.wheelItemClass="wheel-item"),void 0===wheel.selectedIndex&&(wheel.selectedIndex=0,warn("wheel option selectedIndex is required!"))}}(BScroll),function(BScroll){BScroll.prototype._initScrollbar=function(){var _this=this,_options$scrollbar=this.options.scrollbar,_options$scrollbar$fa=_options$scrollbar.fade,fade=void 0===_options$scrollbar$fa||_options$scrollbar$fa,_options$scrollbar$in=_options$scrollbar.interactive,interactive=void 0!==_options$scrollbar$in&&_options$scrollbar$in;this.indicators=[];var indicator=void 0;this.options.scrollX&&(indicator={el:createScrollbar("horizontal"),direction:"horizontal",fade:fade,interactive:interactive},this._insertScrollBar(indicator.el),this.indicators.push(new Indicator(this,indicator))),this.options.scrollY&&(indicator={el:createScrollbar("vertical"),direction:"vertical",fade:fade,interactive:interactive},this._insertScrollBar(indicator.el),this.indicators.push(new Indicator(this,indicator))),this.on("refresh",function(){for(var i=0;i<_this.indicators.length;i++)_this.indicators[i].refresh()}),fade&&(this.on("scrollEnd",function(){for(var i=0;i<_this.indicators.length;i++)_this.indicators[i].fade()}),this.on("scrollCancel",function(){for(var i=0;i<_this.indicators.length;i++)_this.indicators[i].fade()}),this.on("scrollStart",function(){for(var i=0;i<_this.indicators.length;i++)_this.indicators[i].fade(!0)}),this.on("beforeScrollStart",function(){for(var i=0;i<_this.indicators.length;i++)_this.indicators[i].fade(!0,!0)})),this.on("destroy",function(){_this._removeScrollBars()})},BScroll.prototype._insertScrollBar=function(scrollbar){this.wrapper.appendChild(scrollbar)},BScroll.prototype._removeScrollBars=function(){for(var i=0;i<this.indicators.length;i++)this.indicators[i].destroy()}}(BScroll),function(BScroll){BScroll.prototype._initPullDown=function(){this.options.probeType=PROBE_REALTIME},BScroll.prototype._checkPullDown=function(){var _options$pullDownRefr=this.options.pullDownRefresh,_options$pullDownRefr2=_options$pullDownRefr.threshold,threshold=void 0===_options$pullDownRefr2?90:_options$pullDownRefr2,_options$pullDownRefr3=_options$pullDownRefr.stop,stop=void 0===_options$pullDownRefr3?40:_options$pullDownRefr3;return!(this.directionY!==DIRECTION_DOWN||this.y<threshold)&&(this.pulling||(this.pulling=!0,this.trigger("pullingDown")),this.scrollTo(this.x,stop,this.options.bounceTime,ease.bounce),this.pulling)},BScroll.prototype.finishPullDown=function(){this.pulling=!1,this.resetPosition(this.options.bounceTime,ease.bounce)},BScroll.prototype.openPullDown=function(){var config=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.pullDownRefresh=config,this._initPullDown()},BScroll.prototype.closePullDown=function(){this.options.pullDownRefresh=!1}}(BScroll),function(BScroll){BScroll.prototype._initPullUp=function(){this.options.probeType=PROBE_REALTIME,this.pullupWatching=!1,this._watchPullUp()},BScroll.prototype._watchPullUp=function(){this.pullupWatching||(this.pullupWatching=!0,this.on("scroll",this._checkToEnd))},BScroll.prototype._checkToEnd=function(pos){var _this=this,_options$pullUpLoad$t=this.options.pullUpLoad.threshold,threshold=void 0===_options$pullUpLoad$t?0:_options$pullUpLoad$t;this.movingDirectionY===DIRECTION_UP&&pos.y<=this.maxScrollY+threshold&&(this.once("scrollEnd",function(){_this.pullupWatching=!1}),this.trigger("pullingUp"),this.off("scroll",this._checkToEnd))},BScroll.prototype.finishPullUp=function(){var _this2=this;this.pullupWatching?this.once("scrollEnd",function(){_this2._watchPullUp()}):this._watchPullUp()},BScroll.prototype.openPullUp=function(){var config=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.options.pullUpLoad=config,this._initPullUp()},BScroll.prototype.closePullUp=function(){this.options.pullUpLoad=!1,this.pullupWatching&&(this.pullupWatching=!1,this.off("scroll",this._checkToEnd))}}(BScroll),function(BScroll){BScroll.prototype._initMouseWheel=function(){var _this=this;this._handleMouseWheelEvent(addEvent),this.on("destroy",function(){clearTimeout(_this.mouseWheelTimer),clearTimeout(_this.mouseWheelEndTimer),_this._handleMouseWheelEvent(removeEvent)}),this.firstWheelOpreation=!0},BScroll.prototype._handleMouseWheelEvent=function(eventOperation){eventOperation(this.wrapper,"wheel",this),eventOperation(this.wrapper,"mousewheel",this),eventOperation(this.wrapper,"DOMMouseScroll",this)},BScroll.prototype._onMouseWheel=function(e){var _this2=this;if(this.enabled){e.preventDefault(),this.options.stopPropagation&&e.stopPropagation(),this.firstWheelOpreation&&this.trigger("scrollStart"),this.firstWheelOpreation=!1;var _options$mouseWheel=this.options.mouseWheel,_options$mouseWheel$s=_options$mouseWheel.speed,speed=void 0===_options$mouseWheel$s?20:_options$mouseWheel$s,_options$mouseWheel$i=_options$mouseWheel.invert,invert=void 0!==_options$mouseWheel$i&&_options$mouseWheel$i,_options$mouseWheel$e=_options$mouseWheel.easeTime,easeTime=void 0===_options$mouseWheel$e?300:_options$mouseWheel$e;clearTimeout(this.mouseWheelTimer),this.mouseWheelTimer=setTimeout(function(){_this2.options.snap||easeTime||_this2.trigger("scrollEnd",{x:_this2.x,y:_this2.y}),_this2.firstWheelOpreation=!0},400);var wheelDeltaX=void 0,wheelDeltaY=void 0;switch(!0){case"deltaX"in e:1===e.deltaMode?(wheelDeltaX=-e.deltaX*speed,wheelDeltaY=-e.deltaY*speed):(wheelDeltaX=-e.deltaX,wheelDeltaY=-e.deltaY);break;case"wheelDeltaX"in e:wheelDeltaX=e.wheelDeltaX/120*speed,wheelDeltaY=e.wheelDeltaY/120*speed;break;case"wheelDelta"in e:wheelDeltaX=wheelDeltaY=e.wheelDelta/120*speed;break;case"detail"in e:wheelDeltaX=wheelDeltaY=-e.detail/3*speed;break;default:return}var direction=invert?-1:1;wheelDeltaX*=direction,wheelDeltaY*=direction,this.hasVerticalScroll||(wheelDeltaX=wheelDeltaY,wheelDeltaY=0);var newX=void 0,newY=void 0;if(this.options.snap)return newX=this.currentPage.pageX,newY=this.currentPage.pageY,wheelDeltaX>0?newX--:wheelDeltaX<0&&newX++,wheelDeltaY>0?newY--:wheelDeltaY<0&&newY++,void this._goToPage(newX,newY);newX=this.x+Math.round(this.hasHorizontalScroll?wheelDeltaX:0),newY=this.y+Math.round(this.hasVerticalScroll?wheelDeltaY:0),this.movingDirectionX=this.directionX=wheelDeltaX>0?-1:wheelDeltaX<0?1:0,this.movingDirectionY=this.directionY=wheelDeltaY>0?-1:wheelDeltaY<0?1:0,newX>this.minScrollX?newX=this.minScrollX:newX<this.maxScrollX&&(newX=this.maxScrollX),newY>this.minScrollY?newY=this.minScrollY:newY<this.maxScrollY&&(newY=this.maxScrollY);var needTriggerEnd=this.y===newY;this.scrollTo(newX,newY,easeTime,ease.swipe),this.trigger("scroll",{x:this.x,y:this.y}),clearTimeout(this.mouseWheelEndTimer),needTriggerEnd&&(this.mouseWheelEndTimer=setTimeout(function(){_this2.trigger("scrollEnd",{x:_this2.x,y:_this2.y})},easeTime))}}}(BScroll),function(BScroll){BScroll.prototype._initZoom=function(){var _options$zoom=this.options.zoom,_options$zoom$start=_options$zoom.start,start=void 0===_options$zoom$start?1:_options$zoom$start,_options$zoom$min=_options$zoom.min,min=void 0===_options$zoom$min?1:_options$zoom$min,_options$zoom$max=_options$zoom.max,max=void 0===_options$zoom$max?4:_options$zoom$max;this.scale=Math.min(Math.max(start,min),max),this.setScale(this.scale),this.scrollerStyle[style.transformOrigin]="0 0"},BScroll.prototype._zoomTo=function(scale,originX,originY,startScale){this.scaled=!0;var lastScale=scale/(startScale||this.scale);this.setScale(scale),this.refresh();var newX=Math.round(this.startX-(originX-this.relativeX)*(lastScale-1)),newY=Math.round(this.startY-(originY-this.relativeY)*(lastScale-1));newX>this.minScrollX?newX=this.minScrollX:newX<this.maxScrollX&&(newX=this.maxScrollX),newY>this.minScrollY?newY=this.minScrollY:newY<this.maxScrollY&&(newY=this.maxScrollY),this.x===newX&&this.y===newY||this.scrollTo(newX,newY,this.options.bounceTime),this.scaled=!1},BScroll.prototype.zoomTo=function(scale,x,y){var _offsetToBody=offsetToBody(this.wrapper),left=_offsetToBody.left,top=_offsetToBody.top,originX=x+left-this.x,originY=y+top-this.y;this._zoomTo(scale,originX,originY)},BScroll.prototype._zoomStart=function(e){var firstFinger=e.touches[0],secondFinger=e.touches[1],deltaX=Math.abs(firstFinger.pageX-secondFinger.pageX),deltaY=Math.abs(firstFinger.pageY-secondFinger.pageY);this.startDistance=getDistance(deltaX,deltaY),this.startScale=this.scale;var _offsetToBody2=offsetToBody(this.wrapper),left=_offsetToBody2.left,top=_offsetToBody2.top;this.originX=Math.abs(firstFinger.pageX+secondFinger.pageX)/2+left-this.x,this.originY=Math.abs(firstFinger.pageY+secondFinger.pageY)/2+top-this.y,this.trigger("zoomStart")},BScroll.prototype._zoom=function(e){if(this.enabled&&!this.destroyed&&eventType[e.type]===this.initiated){this.options.preventDefault&&e.preventDefault(),this.options.stopPropagation&&e.stopPropagation();var firstFinger=e.touches[0],secondFinger=e.touches[1],deltaX=Math.abs(firstFinger.pageX-secondFinger.pageX),deltaY=Math.abs(firstFinger.pageY-secondFinger.pageY),distance=getDistance(deltaX,deltaY),scale=distance/this.startDistance*this.startScale;this.scaled=!0;var _options$zoom2=this.options.zoom,_options$zoom2$min=_options$zoom2.min,min=void 0===_options$zoom2$min?1:_options$zoom2$min,_options$zoom2$max=_options$zoom2.max,max=void 0===_options$zoom2$max?4:_options$zoom2$max;scale<min?scale=.5*min*Math.pow(2,scale/min):scale>max&&(scale=2*max*Math.pow(.5,max/scale));var lastScale=scale/this.startScale,x=this.startX-(this.originX-this.relativeX)*(lastScale-1),y=this.startY-(this.originY-this.relativeY)*(lastScale-1);this.setScale(scale),this.scrollTo(x,y,0)}},BScroll.prototype._zoomEnd=function(e){if(this.enabled&&!this.destroyed&&eventType[e.type]===this.initiated){this.options.preventDefault&&e.preventDefault(),this.options.stopPropagation&&e.stopPropagation(),this.isInTransition=!1,this.isAnimating=!1,this.initiated=0;var _options$zoom3=this.options.zoom,_options$zoom3$min=_options$zoom3.min,min=void 0===_options$zoom3$min?1:_options$zoom3$min,_options$zoom3$max=_options$zoom3.max,max=void 0===_options$zoom3$max?4:_options$zoom3$max,scale=this.scale>max?max:this.scale<min?min:this.scale;this._zoomTo(scale,this.originX,this.originY,this.startScale),this.trigger("zoomEnd")}}}(BScroll),function(BScroll){BScroll.prototype._initInfinite=function(){this.options.probeType=3,this.maxScrollY=-DEFAULT_SCROLL_RUNWAY,this.infiniteScroller=new InfiniteScroller(this,this.options.infinity)}}(BScroll),BScroll.Version="1.13.2",__webpack_exports__.a=BScroll},266:function(module,exports){},268:function(module,exports){},277:function(module,__webpack_exports__,__webpack_require__){"use strict";function injectStyle(ssrContext){__webpack_require__(268)}var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_add_more_vue__=__webpack_require__(241),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_32c324cd_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_add_more_vue__=__webpack_require__(285),normalizeComponent=__webpack_require__(42),__vue_styles__=injectStyle,Component=normalizeComponent(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_add_more_vue__.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_32c324cd_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_add_more_vue__.a,!1,__vue_styles__,null,null);__webpack_exports__.a=Component.exports},281:function(module,__webpack_exports__,__webpack_require__){"use strict";function injectStyle(ssrContext){__webpack_require__(266)}var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_relation_list_vue__=__webpack_require__(249),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_2558bbf6_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_relation_list_vue__=__webpack_require__(283),normalizeComponent=__webpack_require__(42),__vue_styles__=injectStyle,Component=normalizeComponent(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_script_index_0_relation_list_vue__.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_13_7_3_vue_loader_lib_template_compiler_index_id_data_v_2558bbf6_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_13_7_3_vue_loader_lib_selector_type_template_index_0_relation_list_vue__.a,!1,__vue_styles__,null,null);__webpack_exports__.a=Component.exports},282:function(module,__webpack_exports__,__webpack_require__){"use strict";var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("section",{staticClass:"cap4-formRelation"},[_c("div",{staticClass:"cap4-formRelation__conditions"},[_vm.filterFields&&0!==_vm.filterFields.length?_c("cap4-condition-filter",{attrs:{hub:_vm.hub,filterFields:_vm.filterFields,data:_vm.testData}}):_vm._e()],1),_vm._v(" "),_c("div",{staticClass:"cap4-formRelation__down"},[_vm.filterFields&&0!==_vm.filterFields.length?_c("cap4-condition-content",{attrs:{hub:_vm.hub,ip:_vm.ip,filterFields:_vm.filterFields,data:_vm.testData},on:{organization:_vm.organization,datetime:_vm.datetime,cmpAlert:_vm.cmpAlert,chooseCdtion:_vm.chooseCdtion}}):_vm._e(),_vm._v(" "),_c("div",{staticClass:"cap4-formRelation__wrapper"},[_vm.fetched>0&&!_vm.data.length?_c("cap4-base-none",{attrs:{data:_vm.none}}):_vm._e(),_vm._v(" "),_c("div",{staticClass:"cap4-formRelation__container"},[_vm.data.length?_c("relation-list",{attrs:{formType:_vm.formType,data:_vm.data,page:_vm.page,pageSize:_vm.pageSize},on:{relationEvent:_vm.relationEvent}}):_vm._e(),_vm._v(" "),_vm.moreState?_c("AddMore"):_vm._e()],1)],1),_vm._v(" "),_c("Footers",{attrs:{type:"formInsert"===_vm.formType?"sure-checkable":"sure",checked:_vm.checkedAll},on:{toggleCheck:_vm.handleToggleCheck,saveFormData:_vm.ok}})],1)])},staticRenderFns=[],esExports={render:render,staticRenderFns:staticRenderFns};__webpack_exports__.a=esExports},283:function(module,__webpack_exports__,__webpack_require__){"use strict";var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("section",{staticClass:"cap4-relationCnt"},_vm._l(_vm.data,function(item,index){return index<_vm.page*_vm.pageSize?_c("div",{staticClass:"cap4-relationCnt__list",class:item.showDataList.length>4?"is-more":""},[_c("div",{staticClass:"cap4-relationCnt__left",on:{tap:function($event){_vm.relationEvent("left",item)}}},["formInsert"===_vm.initFormType?_c("div",{staticClass:"cap4-relationCnt__checkBox"},[item.state?_c("i",{staticClass:"icon CAP cap-icon-fuxuan-xuanzhong"}):_c("i",{staticClass:"icon CAP cap-icon-fuxuan-moren"})]):_c("div",{staticClass:"cap4-relationCnt__checkBox"},[item.state?_c("i",{staticClass:"icon CAP cap-icon-danxuan-xuanzhong"}):_c("i",{staticClass:"icon CAP cap-icon-danxuan-moren"})])]),_vm._v(" "),item.showAll?_c("div",{staticClass:"cap4-relationCnt__right",on:{tap:function($event){_vm.relationEvent("right",item)}}},_vm._l(item.showDataList,function(i,j){return _c("div",{staticClass:"cap4-relationCnt__item"},[_c("div",{staticClass:"cap4-relationCnt__display",domProps:{textContent:_vm._s(item.showData[i].display)}}),_vm._v(" "),_c("div",{staticClass:"cap4-relationCnt__value",domProps:{textContent:_vm._s(item.showData[i].showValue)}})])})):_c("div",{staticClass:"cap4-relationCnt__right",on:{tap:function($event){_vm.relationEvent("right",item)}}},_vm._l(item.showDataList,function(i,j){return j<4?_c("div",{staticClass:"cap4-relationCnt__item"},[_c("div",{staticClass:"cap4-relationCnt__display",domProps:{textContent:_vm._s(item.showData[i].display)}}),_vm._v(" "),_c("div",{staticClass:"cap4-relationCnt__value",domProps:{textContent:_vm._s(item.showData[i].showValue)}})]):_vm._e()})),_vm._v(" "),item.showDataList.length>4&&!item.showAll?_c("div",{staticClass:"cap4-relationCnt__show",on:{tap:function($event){_vm.relationEvent("bottom",item)}}},[_c("i",{staticClass:"icon CAP cap-icon-youjiantou2"})]):item.showDataList.length>4&&item.showAll?_c("div",{staticClass:"cap4-relationCnt__show",on:{tap:function($event){_vm.relationEvent("bottom",item)}}},[_c("i",{staticClass:"icon CAP cap-icon-youjiantou-copy"})]):_vm._e()]):_vm._e()}))},staticRenderFns=[],esExports={render:render,staticRenderFns:staticRenderFns};__webpack_exports__.a=esExports},285:function(module,__webpack_exports__,__webpack_require__){"use strict";var render=function(){var _vm=this,_h=_vm.$createElement;_vm._self._c;return _vm._m(0)},staticRenderFns=[function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("section",{staticClass:"cap4-addMore"},[_c("div",{staticClass:"cap4-addMore__content"},[_c("div",{staticClass:"cap4-addMore__loading"},[_c("i",{staticClass:"icon CAP cap-icon-jiazaibai-tou"})]),_vm._v("\n        \u52a0\u8f7d\u66f4\u591a\n    ")])])}],esExports={render:render,staticRenderFns:staticRenderFns};__webpack_exports__.a=esExports}});