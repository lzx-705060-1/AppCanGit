/*! >>> built at 2018-12-5 14:53:47 */
webpackJsonp([0,2],{205:function(module,__webpack_exports__,__webpack_require__){"use strict";function injectStyle(ssrContext){__webpack_require__(247)}Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_formson_detail_vue__=__webpack_require__(227),normalizeComponent=__webpack_require__(42),__vue_styles__=injectStyle,Component=normalizeComponent(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_formson_detail_vue__.a,null,!1,__vue_styles__,null,null);__webpack_exports__.default=Component.exports},206:function(module,__webpack_exports__,__webpack_require__){"use strict";function injectStyle(ssrContext){__webpack_require__(259)}Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_formmain_vue__=__webpack_require__(249),normalizeComponent=__webpack_require__(42),__vue_styles__=injectStyle,Component=normalizeComponent(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_formmain_vue__.a,null,!1,__vue_styles__,null,null);__webpack_exports__.default=Component.exports},208:function(module,__webpack_exports__,__webpack_require__){"use strict";function _playFile(id,filePath,fileName,lastModified){cmp.dialog.loading("\u6587\u4ef6\u4e0b\u8f7d\u4e2d"),cmp.att.download({url:filePath,title:fileName,extData:{lastModified:lastModified,fileId:id,origin:cmp.origin},progress:function(result){},success:function(result){var localPath=result.target;localPath="file://"+localPath,cmp.dialog.loading(!1),cmp.audio.play({filepath:localPath,filename:fileName})},error:function(e){cmp.notification.alert(e,function(){cmp.dialog.loading(!1)},"\u63d0\u793a","\u786e\u5b9a")}})}__webpack_require__.d(__webpack_exports__,"u",function(){return URLS}),__webpack_require__.d(__webpack_exports__,"B",function(){return path}),__webpack_require__.d(__webpack_exports__,"c",function(){return ready}),__webpack_require__.d(__webpack_exports__,"i",function(){return openFormSummary}),__webpack_require__.d(__webpack_exports__,"z",function(){return openExternalUrl}),__webpack_require__.d(__webpack_exports__,"j",function(){return openWebView}),__webpack_require__.d(__webpack_exports__,"f",function(){return closeWebView}),__webpack_require__.d(__webpack_exports__,"d",function(){return openLoading}),__webpack_require__.d(__webpack_exports__,"g",function(){return closeLoading}),__webpack_require__.d(__webpack_exports__,"e",function(){return dialog}),__webpack_require__.d(__webpack_exports__,"h",function(){return toast}),__webpack_require__.d(__webpack_exports__,"l",function(){return fireEvent}),__webpack_require__.d(__webpack_exports__,"k",function(){return ajax}),__webpack_require__.d(__webpack_exports__,"a",function(){return serverIp}),__webpack_require__.d(__webpack_exports__,"b",function(){return getParams}),__webpack_require__.d(__webpack_exports__,"A",function(){return getUrlParams}),__webpack_require__.d(__webpack_exports__,"q",function(){return dtPicker}),__webpack_require__.d(__webpack_exports__,"r",function(){return organize}),__webpack_require__.d(__webpack_exports__,"o",function(){return uploadImages}),__webpack_require__.d(__webpack_exports__,"p",function(){return uploadAttachment}),__webpack_require__.d(__webpack_exports__,"t",function(){return location}),__webpack_require__.d(__webpack_exports__,"s",function(){return showLocation}),__webpack_require__.d(__webpack_exports__,"m",function(){return imagesBrowser}),__webpack_require__.d(__webpack_exports__,"n",function(){return filesBrowser}),__webpack_require__.d(__webpack_exports__,"v",function(){return relationDoc}),__webpack_require__.d(__webpack_exports__,"w",function(){return mark}),__webpack_require__.d(__webpack_exports__,"x",function(){return photoLocation}),__webpack_require__.d(__webpack_exports__,"y",function(){return scanQRCode});var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__(44),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1__utils_tools_js__=__webpack_require__(215),SYMB="ios"===__WEBPACK_IMPORTED_MODULE_1__utils_tools_js__.a.systemType()||"iphoneX"===__WEBPACK_IMPORTED_MODULE_1__utils_tools_js__.a.systemType()?"":"?",RT_URL=cmp.platform.CMPShell?"http://cap4.v5.cmp/v1.0.0/htmls/native/form/index.html"+SYMB+"#/":"/seeyon/m3/apps/v5/cap4/htmls/native/form/index.html"+SYMB+"#/",CAP3_UNFLOW_FORM_URL=cmp.platform.CMPShell?"http://unflowform.v5.cmp/v1.0.0/html/info.html":"/seeyon/m3/apps/v5/unflowform/html/info.html",BASE_URL=RT_URL,FILE_URL="/seeyon/rest/attachment?token=&firstSave=true&applicationCategory=13&option.n_a_s=1",URLS={collaboration:cmp.platform.CMPShell?"http://collaboration.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/collaboration",meeting:cmp.platform.CMPShell?"http://meeting.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/meeting",edoc:cmp.platform.CMPShell?"http://edoc.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/edoc",news:cmp.platform.CMPShell?"http://news.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/news",bulletin:cmp.platform.CMPShell?"http://bulletin.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/bulletin",inquiry:cmp.platform.CMPShell?"http://inquiry.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/inquiry",bbs:cmp.platform.CMPShell?"http://bbs.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/bbs",doc:cmp.platform.CMPShell?"http://doc.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/doc"},path=(cmp.platform,{base:cmp.platform.CMPShell?"http://cap4.v5.cmp/v1.0.0":"/seeyon/m3/apps/v5/cap4"}),ready=function(handle){cmp.ready(handle)},openFormSummary=function(payload){var ignore=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(payload.summaryId){var url=URLS.collaboration+"/html/details/summary.html";return openWebView(url,payload,"all",ignore)}return"cap3"===payload.version?openWebView(CAP3_UNFLOW_FORM_URL,payload,"all",ignore):openWebView("formmain",payload,null,ignore)},openExternalUrl=function(url){var ignore=arguments.length>1&&void 0!==arguments[1]&&arguments[1],done=function(){cmp.platform.CMPShell?cmp.openWebView({url:url,useNativebanner:!0}):cmp.href.next(url)};if(ignore)return done();cmp.platform.CMPShell?cmp.event.trigger("beforeviewleave",document,{location:"store",done:done}):cmp.event.trigger("beforepageredirect",document,{location:"store",done:done})},openWebView=function(route,data,type){var ignore=arguments.length>3&&void 0!==arguments[3]&&arguments[3],url="all"===type?route:""+BASE_URL+route,done=function(){cmp.platform.CMPShell?cmp.href.next(url,data,{openWebViewCatch:1}):cmp.href.next(url,data)};if(ignore)return done();cmp.platform.CMPShell?cmp.event.trigger("beforeviewleave",document,{location:"store",done:done}):cmp.event.trigger("beforepageredirect",document,{location:"store",done:done})},closeWebView=function(){var data=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];data?setTimeout(function(){return cmp.href.back(!0===data?"":data)},30):cmp.href.back()},openLoading=function(params){cmp.dialog.loading(params)},closeLoading=function(){cmp.dialog.loading(!1)},dialog=function(params){switch(params.type){case"warning":cmp.notification.confirm(params.text,function(index){params.callback&&params.callback(index)},null,params.buttons,null,null,params.buttons.length-1);break;case"success":cmp.dialog.success(params.text,function(index){params.callback&&params.callback(index)},null,params.buttons,!0);break;case"prompt":cmp.notification.prompt(params.title,function(index,val){params.callback&&params.callback(index,val)},params.buttons,params.placeholder,params.defaultValue,params.subType,"notClose");break;case"alert":cmp.notification.alert(params.text,function(index){params.callback&&params.callback(index)},params.title,params.buttons,!0);break;case"close":cmp.notification.close({})}},toast=function(text,position,time,type){cmp.notification.toast(text,position,time,type)},fireEvent=function(params){cmp.webViewListener.fire(params)},ajax=function(params){cmp.ajax({type:params.type||"POST",data:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(params.data),url:params.url.match(/seeyon/)?params.url:serverIp()+"/seeyon/"+params.url,timeout:params.timeout||"30000",dataType:"json",cmpReady2Fire:!0,fastAjax:!window.CMPREADYMARK,headers:{"Content-Type":"application/json; charset=utf-8","Accept-Language":"zh-CN",token:cmp.token||""},success:params.success,error:params.error})},serverIp=function(){return cmp.serverIp},getParams=function(){return cmp.href.getParam()},getUrlParams=function(){var result={},hrefArr=window.location.href.split("?");if(hrefArr.length>1){hrefArr[1].split("&").forEach(function(v){result[v.split("=")[0]]=v.split("=")[1]})}return result},dtPicker=function(params,callback){new cmp.DtPicker({value:params.value,beginYear:(new Date).getFullYear()-100,endYear:(new Date).getFullYear()+100,type:params.type}).show(function(rs){callback(rs.value)})},organize=function(params,extra){var id=params.recordId?params.id+"_"+params.recordId:params.id;cmp.selectOrg(id,{type:2,minSize:-1,maxSize:-1===params.type.indexOf("multi")?1:-1,selectType:-1===params.type.indexOf("multi")?params.type:params.type.substr(5,params.type.length),multitype:!1,lightOptsChange:!1,fillback:null,label:["dept","org","post","team","extP"],fillBackData:extra.fillBackData,excludeData:extra.excludeData,vj:!1,callback:function(result){extra.callback(JSON.parse(result).orgResult),cmp.selectOrgDestory(id)},closeCallback:function(){extra.closeCallback(),cmp.selectOrgDestory(id)}})},uploadImages=function(params,num,extra){cmp.dialog.actionSheet([{key:1,name:"\u62cd\u7167"},{key:2,name:"\u672c\u5730\u56fe\u7247"}],"\u53d6\u6d88",function(result){cmp.camera.getPictures({compress:!0,quality:100,targetWidth:-1,targetHeight:-1,saveToPhotoAlbum:!1,destinationType:1,sourceType:"1"===result.key?1:2,encodingType:0,pictureNum:num,success:function(cameraResult){var files=cameraResult.files,num=params.value.length;files.forEach(function(){params.uploadState.push(!1),params.value.push("")}),cmp.att.upload({url:""+serverIp()+FILE_URL,fileList:files,title:"",extData:"",success:function(ret){var data=JSON.parse(ret.response);extra.success(data.atts[0],num),num++},error:function(){extra.error()}})}})})},uploadAttachment=function(params,extra){var items=[{key:1,name:"\u62cd\u7167"},{key:2,name:"\u8bed\u97f3"},{key:3,name:"\u672c\u5730\u6587\u4ef6"},{key:4,name:"\u672c\u5730\u56fe\u7247"}];cmp.platform.CMPShell||items.splice(1,1),cmp.dialog.actionSheet(items,"\u53d6\u6d88",function(result){var type="";switch(result.key){case"1":type="photo";break;case"2":type="voice";break;case"3":type="localFile";break;case"4":type="picture"}cmp.att.suite({type:type,pictureNum:9,initDocData:null,maxFileSize:5242880,extData:{firstSave:!0},success:function(ret){var files={name:ret.att[0].filename,size:ret.att[0].size};extra.success(files,ret.att[0])},error:function(){extra.error()},cancel:function(){extra.cancel()}})},function(){})},location=function(params,extra){cmp.lbs.getLocationInfo({success:function(result){ajax({type:"POST",data:result,url:serverIp()+"/seeyon/rest/cmplbs/save",success:function(ret){extra.success(result,ret.value)},error:function(){}})},error:function(){extra.error()}})},showLocation=function(params){cmp.lbs.showLocationInfo({lbsUrl:serverIp()+"/seeyon/rest/cmplbs/"+params.valueId,success:function(result){}})},imagesBrowser=function(urls,index){var imgsObj=[];urls.forEach(function(v){imgsObj.push({small:v,big:v.split("&showType=small")[0]})}),cmp.sliders.addNew(imgsObj),cmp.sliders.detect(index)},_readFile=function(id,filePath,fileName,lastModified){cmp.dialog.loading(),cmp.att.read({path:filePath,filename:fileName,extData:{fileId:id,lastModified:lastModified,origin:cmp.origin},success:function(result){cmp.dialog.loading(!1)},error:function(e){cmp.dialog.loading(!1),cmp.notification.alert("\u6587\u4ef6\u4e0d\u5b58\u5728",function(){cmp.dialog.loading(!1)},"\u63d0\u793a","\u786e\u5b9a")}})},filesBrowser=function(params){console.log(params);var fileName=params.filename,fileId=params.fileId,lastModified=params.lastModified||params.createDate||params.createdate,suffix=fileName.substr(fileName.lastIndexOf(".")+1,fileName.length),suffixMap={wps:"doc",et:"xls"},downFileName="";if(fileName){downFileName=fileName;var dotIndex=downFileName.lastIndexOf(".");if(-1!=dotIndex){var pureName=downFileName.substring(0,dotIndex),fileSuffix=downFileName.substring(dotIndex+1);for(var subType in suffixMap)if(fileSuffix.toLowerCase()==subType){downFileName=pureName+"."+suffixMap[subType];break}}downFileName="?fileName="+downFileName}var filePath=cmp.origin+"/rest/attachment/file/"+fileId+downFileName;if(cmp.system.filePermission()){var items=[{key:"save",name:"\u4fdd\u5b58"}];cmp.att.canSee(suffix)&&items.unshift({key:"see",name:"\u67e5\u770b"}),cmp.dialog.actionSheet(items,"\u53d6\u6d88",function(item){"see"==item.key?(filePath=cmp.origin+"/rest/attachment/file/"+fileId+downFileName,cmp.att.canPlay(suffix)?_playFile(fileId,filePath,fileName,lastModified):_readFile(fileId,filePath,fileName,lastModified)):"save"==item.key&&(cmp.dialog.loading(),filePath=encodeURI(encodeURI(filePath)),cmp.att.download({url:filePath,title:fileName,extData:{lastModified:lastModified,fileId:fileId,origin:cmp.origin},progress:function(result){cmp.dialog.loading(!1)},success:function(result){var msg="";msg=/jpg|jpeg|bmp|png/gi.test(suffix)?"\u6587\u4ef6\u5df2\u4e0b\u8f7d\u5230\u624b\u673a\u76f8\u518c\uff0c\u8bf7\u5230\u76f8\u518c\u67e5\u770b":"\u6587\u4ef6\u5df2\u4e0b\u8f7d\u5230\u624b\u673a\uff0c\u8bf7\u5230\u79bb\u7ebf\u6587\u6863\u67e5\u770b",cmp.notification.alert(msg,function(){cmp.dialog.loading(!1)},"\u63d0\u793a","\u786e\u5b9a")},error:function(e){cmp.notification.alert("\u6587\u4ef6\u4e0d\u5b58\u5728",function(){cmp.dialog.loading(!1)},"\u63d0\u793a","\u786e\u5b9a")}}))},function(){})}else if(cmp.att.canDownload4Wechat(suffix)){var id=params.fileId,filePath="";filePath=cmp.origin+"/rest/attachment/file/"+id+downFileName,cmp.att.download({url:filePath,title:fileName})}else toast("\u5fae\u534f\u540c\u4e0d\u652f\u6301\u9644\u4ef6\u4e0b\u8f7d!","center",1500,0)},relationDoc=function(params,extra){var fillbackData=[],id=params.id+params.recordId||"";params.attachmentInfo.attachmentInfos.forEach(function(v){var tempFill={category:"1",createdate:v.createdate,description:v.description,extraMap:{},fileUrl:v.fileUrl,genesisId:v.genesisId,icon:"",id:v.id,mimeType:v.mimeType,new:!0,officeTransformEnable:"disable",remoteSource:"",size:"0",sort:v.sort,reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,type:v.mimeType,v:v.v};fillbackData.push(tempFill)}),cmp.accDoc(id,{fillbackData:fillbackData,callback:function(result){extra.success(JSON.parse(result))},closeCallback:function(){}})},mark=function(params,extra){cmp.lbs.markLocation({success:function(result){ajax({type:"POST",data:result,url:serverIp()+"/seeyon/rest/cmplbs/save",success:function(ret){extra.success(result,ret.value)},error:function(){}})},error:function(){extra.error()}})},photoLocation=function(params,extra){cmp.lbs.takePicture({userName:cmp.member.name,uploadPicUrl:""+serverIp()+FILE_URL,serverDateUrl:serverIp()+"/seeyon/rest/cmplbs/servertime",location:"",success:function(ret){ajax({type:"POST",data:ret,url:serverIp()+"/seeyon/rest/cmplbs/save",success:function(r){params.uploadState=[],params.value=[],params.uploadState.push(!1),params.value.push(null),extra.success(ret.listAttachment[0],ret.lbsAddr,r.value,0)},error:function(){}})},error:function(){extra.error()},cancel:function(){}})},scanQRCode=function(callback){if(!cmp.platform.CMPShell)return toast("\u5fae\u534f\u540c\u4e0d\u652f\u6301\u4e8c\u7ef4\u7801\u626b\u7801!","center",1500,0);cmp.barcode.scan({success:function(result){callback(null,result)},error:function(err){console.log(err),"18005"!==String(err.code)&&callback({message:"barcode scan error!"})}})}},209:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",function(){return registerHandler}),__webpack_require__.d(__webpack_exports__,"l",function(){return loadForm}),__webpack_require__.d(__webpack_exports__,"f",function(){return saveForm}),__webpack_require__.d(__webpack_exports__,"d",function(){return calculateForm}),__webpack_require__.d(__webpack_exports__,"b",function(){return mutateFormson}),__webpack_require__.d(__webpack_exports__,"a",function(){return fetchRelationList}),__webpack_require__.d(__webpack_exports__,"e",function(){return fetchRelationFillData}),__webpack_require__.d(__webpack_exports__,"h",function(){return mutateAttachment}),__webpack_require__.d(__webpack_exports__,"i",function(){return removeServerCache}),__webpack_require__.d(__webpack_exports__,"j",function(){return autoAggregate}),__webpack_require__.d(__webpack_exports__,"g",function(){return decodeBarCode}),__webpack_require__.d(__webpack_exports__,"k",function(){return getProtectedData});var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__=__webpack_require__(211),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__=__webpack_require__(208),__WEBPACK_IMPORTED_MODULE_2__utils_index__=__webpack_require__(23),codeMap={2006:"\u60a8\u65e0\u6743\u9650\u64cd\u4f5c\uff0c\u8bf7\u8054\u7cfb\u5e94\u7528\u7ba1\u7406\u5458\uff01",2008:"\u6570\u636e\u72b6\u6001\u4e3a\u9501\u5b9a",2010:"\u5f53\u524d\u9875\u9762\u56e0\u4e3a\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u7f13\u5b58\u5df2\u7ecf\u5931\u6548\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\uff01",2011:"\u8868\u5355\u6570\u636e\u5df2\u7ecf\u88ab\u5220\u9664"},handlers={},registerHandler=function(name,cb){handlers[name]=cb},sendHandler=function(name,payload){handlers[name]&&handlers[name](payload)},serviceCreator=function(options){var deferred=new __WEBPACK_IMPORTED_MODULE_2__utils_index__.c;return __WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__.k(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({},options,{success:function(response){var data=response.data;if(data&&data.code&&codeMap[data.code])return sendHandler("error",codeMap[data.code]);deferred.resolve(response)},error:function(err){return deferred.reject(err)}})),deferred},loadForm=function(data){return serviceCreator({url:"rest/cap4/form/createOrEdit",data:data})},saveForm=function(data){return serviceCreator({url:"rest/cap4/form/saveOrUpdate",data:data})},calculateForm=function(data){var deferred=new __WEBPACK_IMPORTED_MODULE_2__utils_index__.c;return serviceCreator({url:"rest/cap4/form/calculate",data:data}).then(function(response){var data=response.data;data&&"2000"!==data.code?(__WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__.e({type:"warning",title:"\u63d0\u793a\u4fe1\u606f",text:data.message||"unknow error",buttons:["\u786e\u5b9a"],callback:function(){}}),deferred.reject(response)):deferred.resolve(response)},function(err){return deferred.reject(err)}),deferred},mutateFormson=function(data){var deferred=new __WEBPACK_IMPORTED_MODULE_2__utils_index__.c;return serviceCreator({url:"rest/cap4/form/addOrDelDataSubBean",data:data}).then(function(response){var data=response.data;data&&"2000"!==data.code?(__WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__.e({type:"warning",title:"\u63d0\u793a\u4fe1\u606f",text:data.message||"unknow error",buttons:["\u786e\u5b9a"],callback:function(){}}),deferred.reject(response)):deferred.resolve(response)},function(err){return deferred.reject(err)}),deferred},fetchRelationList=function(data){return serviceCreator({url:"rest/cap4/form/getFormRelationDatas",data:data})},fetchRelationFillData=function(data){var deferred=new __WEBPACK_IMPORTED_MODULE_2__utils_index__.c;return serviceCreator({url:"rest/cap4/form/dealSelectedRelationData",data:data}).then(function(response){var data=response.data;data&&"2000"!==data.code?(__WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__.e({type:"warning",title:"\u63d0\u793a\u4fe1\u606f",text:data.message||"unknow error",buttons:["\u786e\u5b9a"],callback:function(){}}),deferred.reject(response)):deferred.resolve(response)},function(err){return deferred.reject(err)}),deferred},mutateAttachment=function(data){return serviceCreator({url:"rest/cap4/form/addOrDelAttachment",data:data})},removeServerCache=function(data){return serviceCreator({type:"GET",url:"rest/cap4/form/removeSessionFormCache/"+data})},autoAggregate=function(data){return serviceCreator({url:"rest/cap4/form/refreshSubData",data:data})},decodeBarCode=function(data){return serviceCreator({url:"rest/capBarcode/decodeBarCode",data:data})},getProtectedData=function(data){return serviceCreator({url:"rest/cap4/form/getiSignatureProtectedData",data:data})}},210:function(module,__webpack_exports__,__webpack_require__){"use strict";var fieldTypes={input:["text","number","textarea"],normal:["text","textarea","date","datetime","maplocate"],checkbox:["checkbox"],enums:["select","radio","imageradio","imageselect"],enumsRadio:["radio","imageradio"],file:["image","attachment","document","mapphoto"],organize:["member","multimember","post","multipost","department","multidepartment","account","multiaccount","level","multilevel"],auxiliary:["suiLogo","suiLabel","suiLineGap","suiStatic"],map:["maplocate","mapmarked","mapphoto"],flow:["flowdealoption"]};__webpack_exports__.a=fieldTypes},211:function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _assign=__webpack_require__(240),_assign2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_assign);exports.default=_assign2.default||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}},212:function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _from=__webpack_require__(234),_from2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_from);exports.default=function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return(0,_from2.default)(arr)}},213:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={name:"footers",props:["type","bg","checked"],methods:{handleCheckAll:function(){this.$emit("toggleCheck",!this.checked)},saveFormData:function(type){this.$emit("saveFormData",type,!1)}}}},214:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__=__webpack_require__(208);__webpack_exports__.a=function(data){switch(data.inputType){case"image":data.attachmentInfo.attachmentInfos&&data.attachmentInfo.attachmentInfos.length?("[object String]"===Object.prototype.toString.call(data.value)&&(data.value=[],data.uploadState=[]),data.attachmentInfo.attachmentInfos.forEach(function(v){var attachInfo={id:v.id,fileUrl:v.fileUrl,size:v.size,createdate:v.createdate,filename:v.filename},url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/fileUpload.do?method=showRTE&fileId="+attachInfo.fileUrl+"&createDate="+attachInfo.createdate+"&type=image&showType=small";data.value.push(url),data.uploadState.push(!0)})):(data.attachmentInfo.attachmentInfos=[],data.value=[],data.uploadState=[]);break;case"document":case"attachment":data.attachmentInfo.attachmentInfos&&data.attachmentInfo.attachmentInfos.length?("[object String]"===Object.prototype.toString.call(data.value)&&(data.value=[]),data.attachmentInfo.attachmentInfos.forEach(function(v){var files={name:v.filename,size:v.size,type:v.mimeType};data.value.push(files)})):(data.attachmentInfo.attachmentInfos=[],data.value=[]);break;case"member":case"multimember":case"department":case"multidepartment":case"account":case"multiaccount":case"level":case"multilevel":case"post":case"multipost":if(data.valueId){var names=data.showValue,ids=data.valueId,result="";ids&&ids.split(",").forEach(function(v,index){var r=v;-1!==v.indexOf("|")&&(r=v.split("|")[0]),""!==result&&(result+=","),result+=r+"|"+names.split(",")[index]}),data.value=result}break;case"radio":case"select":case"imageradio":case"imageselect":data.value=data.valueId?data.valueId:data.value,data.enums.forEach(function(v){v.url&&-1===v.url.indexOf("http")&&(v.url=""+__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+v.url)});break;case"text":"DECIMAL"===data.fieldType&&data.valueId&&(data.value=data.valueId);break;case"mapmarked":data.value={text:data.showValue||"",url:""};break;case"mapphoto":data.attachmentInfo.attachmentInfos&&data.attachmentInfo.attachmentInfos.length?("[object String]"===Object.prototype.toString.call(data.value)&&(data.value=[],data.uploadState=[]),data.attachmentInfo.attachmentInfos.forEach(function(v){var attachInfo={id:v.id,fileUrl:v.fileUrl,size:v.size,createdate:v.createdate,filename:v.filename,subReference:v.subReference},val={url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/fileUpload.do?method=showRTE&fileId="+attachInfo.fileUrl+"&createDate="+attachInfo.createdate+"&type=image&showType=small",location:data.showValue};data.value.push(val),data.uploadState.push(!0)})):(data.attachmentInfo.attachmentInfos=[],data.value=[],data.uploadState=[]);break;case"logo":data.attrs.src&&-1===data.attrs.src.indexOf("http")&&(data.attrs.src=""+__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+data.attrs.src);break;case"date":data.value&&data.value.includes(" ")&&(data.value=data.value.split(" ")[0],data.showValue=data.value);break;case"datetime":data.value&&(data.value.includes(" ")||-1!==data.value.indexOf("*")||(data.value+=" 00:00",data.showValue=data.value));break;case"flowdealoption":data.value&&data.value.includes("@signet_host@")&&(data.value=data.value.replace(/@signet_host@/g,__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon"),data.showValue=data.value)}}},215:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_vue__=__webpack_require__(7),__WEBPACK_IMPORTED_MODULE_1__i18n__=__webpack_require__(47);__webpack_exports__.a={systemType:function(){var u=navigator.userAgent,result=void 0;return u.indexOf("Android")>-1||u.indexOf("Adr")>-1?result="android":u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)&&(result=u.includes("iPhoneX")?"iphoneX":"ios"),result},systemTime:function(){var date=new Date,dateArr=[date.getFullYear(),date.getMonth()+1,date.getDate(),date.getHours(),date.getMinutes()];return dateArr.forEach(function(v){v>0&&v<10&&(v="0"+v)}),dateArr[0]+"-"+dateArr[1]+"-"+dateArr[2]+" "+dateArr[3]+":"+dateArr[4]},instantiate:function(){var ctors={};return function(Component,props){var name=Component.name,ctor=ctors[name]||(ctors[name]=__WEBPACK_IMPORTED_MODULE_0_vue__.default.extend(Component)),instance=new ctor({i18n:__WEBPACK_IMPORTED_MODULE_1__i18n__.a,propsData:props});return instance.$mount(),document.body.appendChild(instance.$el),instance}}()}},216:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1__utils_index__=__webpack_require__(23),__WEBPACK_IMPORTED_MODULE_2__utils_bridge__=__webpack_require__(208),__WEBPACK_IMPORTED_MODULE_3__business_utils_service__=__webpack_require__(209);__webpack_exports__.a={methods:{copyFliterValue:function(fieldInfo,attachmentInfo){var isCustomField=fieldInfo.isCustomField,inputType=fieldInfo.inputType;(isCustomField||inputType.match(/^(flowdealoption|linenumber|document|attachment|image|maplocate|mapphoto|mapmarked)$/))&&fieldInfo.attachmentInfo&&(fieldInfo.uploadState=[]),isCustomField&&(fieldInfo.customValue="")},createFormson:function(tbName,params,_frontTableName,firstIndex,callback,relationData){var _this=this;__WEBPACK_IMPORTED_MODULE_3__business_utils_service__.b(params).then(function(result){if(console.log("create Formson",_frontTableName,tbName,result,params),__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.g(),"1"==result.data.firstIsNull){var record=_this.dbData.formsons[_frontTableName].records.splice(firstIndex,1)[0];if(record)for(var i in _this.dbData.relationSelector){var relation=_this.dbData.relationSelector[i];relation.fromSubDataId===record.recordId&&delete _this.dbData.relationSelector[i]}}console.log("xxxxxx",result.data.data),result.data.data.forEach(function(value,index){var initData=_this.initFormSonFieldDatas(_frontTableName);initData.listsIndex.forEach(function(v){var recordItem=initData.lists[v];value.dataSubInfos[v]&&recordItem&&(recordItem.recordId=value.recordId,_this._mergeToField(recordItem,value.dataSubInfos[v]),_this.mixFormsonData(recordItem,relationData,v,value.recordId))}),initData.recordId=value.recordId,_this._isRelation&&_this.dbData.formsons[_frontTableName].records.push(initData)}),callback&&callback()},function(){__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.g(),__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.h("\u64cd\u4f5c\u5931\u8d25","center",1500,0)})},mixFormsonData:function(recordItem,relationData,fieldId,recordId){for(var i=0;i<relationData.length;i++){var relationRecord=relationData[i].relationData;for(var j in relationRecord)fieldId==j&&relationData[i].newRecordId==recordId&&recordItem.recordId==relationData[i].newRecordId&&(console.log("merge",relationRecord[j].showValue),this._mergeToField(recordItem,relationRecord[j]),recordItem.relationData&&(recordItem.relationData.toMasterDataId=relationData[i].dataId))}},getNewFormsonData:function(tbName,data,callback,isAutoFill){var xform=this.dbData,rIds=[],relationParams={},toMasterDataIds={};data.forEach(function(v1){rIds.push(v1.newRecordId||""),v1.newRecordId&&(toMasterDataIds[v1.newRecordId]=v1.dataId,relationParams[v1.newRecordId]={},v1.relationData&&__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(v1.relationData).forEach(function(v2){relationParams[v1.newRecordId][v2]={value:v1.relationData[v2].value}}));var keyId=v1.newRecordId?v1.fromRelationAttr+"_"+v1.newRecordId:v1.fromRelationAttr,obj={keyId:keyId,fieldName:v1.fromRelationAttr,toMasterDataId:v1.dataId,toSubDataId:v1.subDataId,toFormId:v1.toFormId,formType:v1.toFormType,fromSubDataId:v1.newRecordId};xform.relationSelector[keyId]=obj});var _getFirstRecordId=this.getFirstRecordId(tbName,isAutoFill),firstRecordId=_getFirstRecordId.firstRecordId,firstIndex=_getFirstRecordId.firstIndex,_frontTableName=_getFirstRecordId._frontTableName;if(!_frontTableName)return callback&&callback();var params={firstRecordId:firstRecordId,formMasterId:xform.data.content.contentDataId,formId:xform.data.content.contentTemplateId,tableName:tbName,recordIds:rIds,type:"add",rightId:xform.data.content.rightId,relationParams:relationParams};return __WEBPACK_IMPORTED_MODULE_2__utils_bridge__.d("\u589e\u52a0\u660e\u7ec6\u4e2d..."),this.createFormson(tbName,params,_frontTableName,firstIndex,callback,data)},initFormSonFieldDatas:function(_frontTableName){return _frontTableName?__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.b)(!0,this.dbData.formsons[_frontTableName].templateRecord):this._isRelation?__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.b)(!0,this.dbData.formsons[this._relationParam.frontTableName].templateRecord):__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.b)(!0,this.dbData.formsons[frontTableName].templateRecord)},getFirstRecordId:function(tbName,isAutoFill){var _frontTableName=this._isRelation?this._relationParam.frontTableName:this.frontTableName;isAutoFill&&(_frontTableName=this.getFrontTbNameAndSetParams(tbName));for(var formson=this.dbData.formsons[_frontTableName],data=formson?formson.records:[],i=0;i<data.length;i++)if(data[i])return{firstRecordId:data[i].recordId,firstIndex:i,_frontTableName:_frontTableName};return{firstIndex:-1,firstRecordId:"",_frontTableName:_frontTableName}},getFrontTbNameAndSetParams:function(tbName){console.log("getFrontTbNameAndSetParams",tbName);var formsonsData=this.dbData.formsons;for(var name in formsonsData)if(formsonsData[name].tableName==tbName)return this._relationParam.frontTableName=name,this.formType="formInsert",name;return""}}}},217:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return _on}),__webpack_require__.d(__webpack_exports__,"a",function(){return _emit});var __WEBPACK_IMPORTED_MODULE_0_vue__=__webpack_require__(7),hub=new __WEBPACK_IMPORTED_MODULE_0_vue__.default,_on=function(){var _arguments=arguments;return cmp.platform.CMPShell?(_on=function(evtName,handle){cmp.webViewListener.add({type:evtName}),document.addEventListener(evtName,handle)})(arguments[0],arguments[1]):(_on=function(){return hub.$on.apply(hub,_arguments)})(arguments)},_emit=function(){var _arguments2=arguments;return cmp.platform.CMPShell?(_emit=function(evtName,data){cmp.webViewListener.fire({type:evtName,data:data.data})})(arguments[0],arguments[1]):(_emit=function(){return hub.$emit.apply(hub,_arguments2)})(arguments)}},218:function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)(123)},219:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__assets_js_api__=__webpack_require__(43),__WEBPACK_IMPORTED_MODULE_1__business_utils_service__=__webpack_require__(209);__webpack_exports__.a={methods:{allFormCalculate:function(callback){var params={id:"",isInCalculate:"1"};this.calculate(params,callback)},entireCalculate:function(callback,errback){return this.calculate({id:"",isInCalculate:"1"},callback,errback)},calculate:function(params,callback,errback){var _this=this;if(this._skipCalculate)return callback&&callback();if("browse"===this.dbData.pageParams.type)return callback&&callback();if(params.id){var payload={tableName:this._isFormson?this._formsonParam.tableName:this.dbData.data.tableInfo.formmain.tableName,recordId:this._isFormson?this.formsonData.recordId:"",isMaster:!this._isFormson,fieldInfo:params};console.log(payload),__WEBPACK_IMPORTED_MODULE_0__assets_js_api__.b.$emit("fieldChanged",payload)}if("1"!==params.isInCalculate)return callback&&callback();var content=this.dbData.data.content,request={formMasterDataId:content.contentDataId,formId:content.contentTemplateId,rightId:content.rightId,fieldName:params.id,fromRecordId:this._isFormson?this.formsonData.recordId:"",formSonTableName:this._isFormson?this._formsonParam.tableName:"",mergeData:this._buildSaveRequestParams("save",!0)};console.log("=== calculating ==="),__WEBPACK_IMPORTED_MODULE_1__business_utils_service__.d(request).then(function(result){_this._manipulateForm(result.data.data.tableData),callback&&callback()},errback)},setCalculateLock:function(flag){var _this2=this;void 0===flag?(console.log(">>> locked calculate in this loop"),this._skipCalculate=!0,this.$nextTick(function(){_this2._skipCalculate=!1,console.log("unlocked calculate <<<")})):this._skipCalculate=!!flag}}}},220:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_slicedToArray__=__webpack_require__(226),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_slicedToArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_slicedToArray__),__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__=__webpack_require__(208),__WEBPACK_IMPORTED_MODULE_3__business_utils_getSaveParams_js__=__webpack_require__(231),__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__=__webpack_require__(210),__WEBPACK_IMPORTED_MODULE_5__business_utils_service__=__webpack_require__(209),VALIDATE_CODE_MAP={2001:"",2004:"",2005:"",2006:"\u60a8\u65e0\u6743\u9650\u64cd\u4f5c\uff0c\u8bf7\u8054\u7cfb\u5e94\u7528\u7ba1\u7406\u5458\uff01",2007:"",2008:"\u6570\u636e\u72b6\u6001\u4e3a\u9501\u5b9a",2010:"\u5f53\u524d\u9875\u9762\u56e0\u4e3a\u957f\u65f6\u95f4\u672a\u64cd\u4f5c\uff0c\u7f13\u5b58\u5df2\u7ecf\u5931\u6548\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\uff01",2011:"\u8868\u5355\u6570\u636e\u5df2\u7ecf\u88ab\u5220\u9664"};__webpack_exports__.a={methods:{saveToServer:function(type,presubmit,callback,performer,moduleType,isReserved,contentOpts){var _this=this;if(this._isUnflow&&!presubmit){if(!this._validateFields())return}else if(performer&&"1"===performer.checkNull&&!this._validateFields(performer.failed))return;!presubmit&&this._isUnflow&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.d("\u4fdd\u5b58\u4e2d...");var pageParams=this.dbData.pageParams;pageParams.templateId&&"-1"===this.dbData.data.content.moduleTemplateId&&(this.dbData.data.content.moduleTemplateId=pageParams.templateId);var payload=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__business_utils_getSaveParams_js__.a)(pageParams.params.operateType,type,presubmit,performer,moduleType,this,contentOpts);__WEBPACK_IMPORTED_MODULE_5__business_utils_service__.f(payload).then(function(result){var _result$data=result.data,code=_result$data.code,data=_result$data.data;if("2000"===code){var snInfo=data.snInfo,foundSn=snInfo&&snInfo.length>0,messages=[];snInfo&&snInfo.forEach(function(item){messages.push("\u5df2\u5728"+item.display+"\u751f\u6210\u6d41\u6c34\u53f7:"+item.snmu)}),!presubmit&&_this._isUnflow&&_this.triggerListRefresh(),setTimeout(function(){presubmit?callback(payload):_this._isUnflow&&foundSn&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.e({type:"success",title:"\u63d0\u793a\u4fe1\u606f",text:messages.join(","),buttons:["\u786e\u5b9a"],callback:function(){"save"===type&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.f()}}),_this._isUnflow&&("save"!==type||!presubmit&&foundSn?"saveNew"===type?_this.loadFormData("saveNew",pageParams.params,0,!0):"saveCopy"===type&&(_this.dbData.data.content.contentDataId=data.formMasterId,_this.loadFormData("saveCopy",pageParams.params,0,!0)):isReserved?(__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.g(),presubmit||__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.h("\u4fdd\u5b58\u6210\u529f","center",1500,1)):_this.closeWebView())},1e3),performer&&performer.success&&(data.snInfo=messages.length?messages.join("<br />"):"",data.isCAP4=!0,performer.success(data))}else{if(__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.g(),("1"===payload.content.needCheckRule||"1"===payload.content.needDataUnique)&&(_this._validateData(result.data,type,!1,callback,performer),result.data&&result.data.data&&result.data.data.tableData)){var _data=result.data.data;_this._dropTableRecords(_data.clearTables),_this._manipulateForm(_data.tableData)}"2002"!==code&&performer&&performer.failed&&performer.failed()}},function(err){presubmit||(__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.g(),__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.h("\u4fdd\u5b58\u5931\u8d25","center",1500,0))})},_validateData:function(){for(var _this2=this,_len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];var _args=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_slicedToArray___default()(args,5),result=_args[0],type=_args[1],isPrev=_args[2],callback=_args[3],performer=_args[4],buttonMap={cancel:"\u53d6\u6d88",sure:"\u786e\u5b9a",go:"\u7ee7\u7eed"},text="",buttons=[buttonMap.sure],fields=void 0,cb=function(){};if(!isPrev){if("2002"===result.code){var ret=JSON.parse(result.data.validateResult);text=ret.ruleError,fields=ret.fields,1===ret.forceCheck?cb=function(){return performer&&performer.failed()}:(buttons=[buttonMap.go,buttonMap.cancel],cb=function(index){0===index?_this2.saveToServer(type,isPrev,callback,performer,_this2.dbData.pageParams.params.moduleType,!1,{needCheckRule:"0"}):1===index&&performer&&performer.failed()})}else"2003"===result.code?(text=result.data.validateDataUnique.msg,fields=result.data.validateDataUnique.uniqueField):text="2009"===result.code?result.data[__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(result.data)[0]]:VALIDATE_CODE_MAP[result.code]||"";var invalidData=this._invalidateFields(fields),isInComment=location.href.indexOf("/details/comment.html")>-1;text&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.e({type:"warning",title:"",text:text,buttons:buttons,callback:function(index){isInComment?_this2.dbData.invalidation={type:invalidData.type,fieldName:invalidData.fieldName,tableName:invalidData.tableName}:_this2._consumeInvalidation(invalidData),cb(index)}})}},consumeInvalidation:function(invalidation){location.href.indexOf("/details/comment.html")>-1||this._consumeInvalidation(invalidation)},_consumeInvalidation:function(invalidation){if("formain"===invalidation.type){var el=document.getElementById("master|"+invalidation.fieldName);el&&(el.scrollIntoViewIfNeeded?el.scrollIntoViewIfNeeded():el.scrollIntoView&&el.scrollIntoView())}else if("formson"===invalidation.type){var tableName=invalidation.tableName,fieldName=invalidation.fieldName,table=this.dbData.formsons[tableName];this.viewFormson(table,table.records[0],{focusField:fieldName})}},_validateFields:function(cb){var _dbData=this.dbData,formmains=_dbData.formmains,formsons=_dbData.formsons,win={title:"\u63d0\u793a\u6d88\u606f",sure:"\u786e\u5b9a",text:"\u4e0d\u80fd\u4e3a\u7a7a!"},result=!0,field=void 0;for(var p1 in formmains)if(formmains.hasOwnProperty(p1))for(var p2 in formmains[p1])if(formmains[p1].hasOwnProperty(p2)){var obj=formmains[p1][p2];if("1"===obj.isNotNull){if((obj.isAttachment||__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.file.includes(obj.inputType))&&0===obj.attachmentInfo.attachmentInfos.length){field=obj;break}if((__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.map.includes(obj.inputType)||__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.organize.includes(obj.inputType))&&""===obj.valueId){field=obj;break}if(__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.enumsRadio.includes(obj.inputType)&&"0"===obj.value){field=obj;break}if(!obj.value){field=obj;break}}}if(!field)for(var _p in formsons)if(formsons.hasOwnProperty(_p))for(var i=0,r=formsons[_p].records;i<r.length;++i){var record=formsons[_p].records[i];if(record)for(var _p2 in record.lists)if(record.lists.hasOwnProperty(_p2)){var _obj=record.lists[_p2];if("1"===_obj.isNotNull){if((_obj.isAttachment||__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.file.includes(_obj.inputType))&&0===_obj.attachmentInfo.attachmentInfos.length){field=_obj;break}if((__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.map.includes(_obj.inputType)||__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.organize.includes(_obj.inputType))&&""===_obj.valueId){field=_obj;break}if(__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types_js__.a.enumsRadio.includes(_obj.inputType)&&"0"===_obj.value){field=_obj;break}if(!_obj.value){field=_obj;break}}}}return field&&(__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.g(),__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.e({type:"warning",title:win.title,text:""+field.display+win.text,buttons:[win.sure],callback:function(){return cb&&cb()}}),result=!1),result},_invalidateFields:function(fields){var _this3=this,_dbData2=this.dbData,formmains=_dbData2.formmains,formsons=_dbData2.formsons,mains=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formmains),subs=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formsons),invalid={isDataInvalid:"1"},masterFields=[],detailFields=[],result={};return fields.forEach(function(fieldName){for(var i=0,l=mains.length;i<l;++i){var formmain=formmains[mains[i]];if(formmain.hasOwnProperty(fieldName))return masterFields.push(fieldName),result.type||(result.type="formain",result.fieldName=fieldName,result.table=formmain),_this3._setField(formmain[fieldName],invalid)}for(var _i=0,_l=subs.length;_i<_l;++_i){var formson=formsons[subs[_i]];if(formson.fieldInfo.hasOwnProperty(fieldName))return detailFields.push(fieldName),result.type||(result.type="formson",result.fieldName=fieldName,result.tableName=formson.frontTableName,result.table=formson),formson.records.forEach(function(record){_this3._setField(record.lists[fieldName],invalid)})}}),result},setFormsons:function(data){var formsons=this.dbData.formsons;return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formsons).some(function(v){if(formsons[v].tableName===data.tableName){var found={};return formsons[v].records.forEach(function(formson){found[formson.recordId]=!0}),data.fData&&found[data.fData.recordId]?formsons[v].records.some(function(vl){if(vl.recordId===data.fData.recordId)return vl.lists=data.fData.lists,!0}):formsons[v].records.push({recordId:data.fData.recordId,lists:data.fData.lists,listsIndex:data.fData.listsIndex}),!0}}),this.dbData},_buildSaveRequestParams:function(type,presubmit,performer){var _dbData$pageParams$pa=this.dbData.pageParams.params,operateType=_dbData$pageParams$pa.operateType,moduleType=_dbData$pageParams$pa.moduleType;return __webpack_require__.i(__WEBPACK_IMPORTED_MODULE_3__business_utils_getSaveParams_js__.a)(operateType,type,presubmit,performer,moduleType,this)},triggerListRefresh:function(){var params={type:this.type};"new"!==this.type&&(params.params=this.dbData.pageParams.params,params.formmainsData=this.dbData.formmains),__WEBPACK_IMPORTED_MODULE_2__utils_bridge_js__.l({type:"com.seeyon.m3.FormSaveSuccess",data:params})}}}},221:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__business_utils_store__=__webpack_require__(233),__WEBPACK_IMPORTED_MODULE_1__business_mixins_store_manipulate__=__webpack_require__(230);__webpack_exports__.a={mixins:[__WEBPACK_IMPORTED_MODULE_1__business_mixins_store_manipulate__.a],methods:{saveToStore:function(opts){var storeKey=this._buildStoreKey(opts),storeData=this._buildStoreData();return __WEBPACK_IMPORTED_MODULE_0__business_utils_store__.a.save(storeKey,storeData)},getFromStore:function(opts){var _this=this,consume=arguments.length>1&&void 0!==arguments[1]&&arguments[1],storeKey=this._buildStoreKey(opts);return __WEBPACK_IMPORTED_MODULE_0__business_utils_store__.a.get(storeKey,!0).then(function(data){return consume&&_this.clearFromStore(opts),{type:data.type,pageParams:data.pageParams,viewIndex:data.viewIndex,data:data.data,formmains:data.formmains,formsons:data.formsons,flowParam:data.flowParam,relationSelector:data.relationSelector,scrollY:data.scrollY,bSroll:data.bSroll,cFormSon:data.cFormSon,backupData:data.backupData,formsonData:data.formsonData,recordId:data.recordId,invalidation:data.invalidation}})},clearFromStore:function(opts){console.log("clearFromStore:");var storeKey=this._buildStoreKey(opts);return __WEBPACK_IMPORTED_MODULE_0__business_utils_store__.a.remove(storeKey)},_buildStoreKey:function(opts){if(this.DBKey)return this.DBKey;opts=opts||this._formainParam&&this._formainParam.params||this._formsonParam&&this._formsonParam.params||this._relationParam&&this._relationParam.params||this.dbData.pageParams.params;var _opts=opts;return _opts.moduleId+"_"+_opts.rightId+"_"+_opts.operateType},_buildStoreData:function(){var body=this.$refs.body,data=this.dbData,scrollY=body?body.scrollTop:0;return{type:data.type,pageParams:data.pageParams,viewIndex:data.viewIndex,data:data.data,formmains:data.formmains,formsons:data.formsons,flowParam:data.flowParam,relationSelector:data.relationSelector,scrollY:scrollY||data.scrollY,bSroll:data.bSroll,cFormSon:data.cFormSon,backupData:data.backupData,recordId:data.recordId,formsonData:data.formsonData,invalidation:data.invalidation}}}}},222:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1__utils_index__=__webpack_require__(23),__WEBPACK_IMPORTED_MODULE_2__business_utils_special__=__webpack_require__(214),__WEBPACK_IMPORTED_MODULE_3__business_utils_service__=__webpack_require__(209),__WEBPACK_IMPORTED_MODULE_4__utils_bridge__=__webpack_require__(208);__webpack_exports__.a={created:function(){var _this=this;__WEBPACK_IMPORTED_MODULE_3__business_utils_service__.c("error",function(reason){__WEBPACK_IMPORTED_MODULE_4__utils_bridge__.e({type:"warning",title:"\u63d0\u793a\u6d88\u606f",text:reason,buttons:["\u8fd4\u56de"],callback:function(){return _this._isFormmain?_this.closeWebView():_this._isFormson?_this.cancelSave(!0):_this._isRelation?_this.closeWebView("back"):void cmp.href.back()}})})},methods:{getBaseStyles:function(defaultSkin){if(!defaultSkin)return{};if(this._baseInfo)return this._baseInfo;var defaultBg="",fBg="";return defaultSkin.view.bgUrl?(defaultBg=__WEBPACK_IMPORTED_MODULE_4__utils_bridge__.a()+"/seeyon/common/cap4/design/"+defaultSkin.view.bgUrl.substr(2,defaultSkin.view.bgUrl.length-2),fBg=-1===defaultSkin.view.bgUrl.indexOf("/seeyon")?defaultSkin.view.bgColor+" url("+defaultBg+") no-repeat center center":defaultSkin.view.bgColor+" url("+__WEBPACK_IMPORTED_MODULE_4__utils_bridge__.a()+defaultSkin.view.bgUrl+") no-repeat center center"):fBg=defaultSkin.view.bgColor,this._baseInfo={formHeaderBg:""+defaultSkin.head.backgroundColor,formHeaderColor:""+defaultSkin.head.color,formNavBg:defaultSkin.nav?""+defaultSkin.nav.backgroundColor:"",formFooterBg:defaultSkin.nav?""+defaultSkin.nav.backgroundColor:"",formFooterColor:"",formBg:fBg,fieldLine:"1px solid "+defaultSkin.divider.backgroundColor,fieldBg:""+defaultSkin.widget.box.backgroundColor,fieldTitleDefaultColor:""+defaultSkin.widget.label.color,fieldValueDefaultColor:""+defaultSkin.widget.body.color,isNotNullBg:""+defaultSkin.required.backgroundColor,placeholderColor:""+defaultSkin.widget.placeholder.color,formsonTiTleBorder:"1px solid "+defaultSkin.formson.head.borderColor,formsonArrowColor:""+defaultSkin.formson.arrow.color,formsonBg:""+defaultSkin.formson.snap.box.backgroundColor,formsonBorder:"1px solid "+defaultSkin.formson.snap.box.borderColor,formsonTitle:""+defaultSkin.formson.snap.label.color,formsonValue:""+defaultSkin.formson.snap.body.color}},_setField:function(field,data){return this._mergeToField(field,data)},_mergeToField:function(field,data){__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(data).forEach(function(fieldName){var value=data[fieldName];"value"===fieldName?field.valueId=value:"showValue2"===fieldName?field.value=value:"relationInfo"===fieldName?field.relation=value:"[object Object]"===toString.call(field[fieldName])?__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.a)(field[fieldName],value):field[fieldName]=value}),__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_2__business_utils_special__.a)(field)},_getFormainField:function(fieldName){var formmains=this.dbData.formmains;return formmains[__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formmains)[0]][fieldName]||null},_getFormsonField:function(fieldName,tableName,recordId){var record=this._getRecordByTableAndId(tableName,recordId);return record?record.lists[fieldName]:null},_getFormsonByName:function(tableName){for(var formson,formsons=this.dbData.formsons,names=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formsons),i=0,l=names.length;i<l;++i)if(formson=formsons[names[i]],formson.tableName===tableName)return formson},_getRecordByTableAndId:function(tableName,recordId){for(var record,formson=this._getFormsonByName(tableName),records=formson.records,i=0,l=records.length;i<l;++i)if((record=records[i])&&record.recordId===recordId)return record},setRelationSelector:function(relationRecords){if(relationRecords&&relationRecords.length){var relationSelector=this.dbData.relationSelector;relationRecords.forEach(function(v){v.keyId=v.fieldName,v.fromSubDataId&&(v.keyId=v.fieldName+"_"+v.fromSubDataId),relationSelector[v.keyId]=v})}},_deleteRelation:function(keys){var relationSelector=this.dbData.relationSelector;Array.isArray(keys)||(keys=[keys]),keys.forEach(function(key){delete relationSelector[key]})},_deleteRelationByRecordId:function(recordId){var _this2=this;if(Array.isArray(recordId))return recordId.forEach(function(id){_this2._deleteRelationByRecordId(id)});var relationSelector=this.dbData.relationSelector,search="_"+recordId;__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(relationSelector).forEach(function(key){key.indexOf(search)>-1&&delete relationSelector[key]})},_buildRelationRightId:function(pcView,phoneView){return pcView=pcView||"",phoneView=phoneView||"","0"===pcView&&(pcView=""),"0"===phoneView&&(phoneView=""),pcView?phoneView?pcView+"_"+phoneView:pcView:phoneView}}}},223:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"d",function(){return imagesBrowser}),__webpack_require__.d(__webpack_exports__,"e",function(){return filesBrowser}),__webpack_require__.d(__webpack_exports__,"g",function(){return imagesEvent}),__webpack_require__.d(__webpack_exports__,"h",function(){return attachmentEvent}),__webpack_require__.d(__webpack_exports__,"a",function(){return timeEvent}),__webpack_require__.d(__webpack_exports__,"b",function(){return organizeEvent}),__webpack_require__.d(__webpack_exports__,"c",function(){return location}),__webpack_require__.d(__webpack_exports__,"f",function(){return relationDoc}),__webpack_require__.d(__webpack_exports__,"j",function(){return mark}),__webpack_require__.d(__webpack_exports__,"i",function(){return photoLocation});var __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__=__webpack_require__(208),__WEBPACK_IMPORTED_MODULE_1__business_utils_relationDoc__=__webpack_require__(232),imagesBrowser=function(urls,index){__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.m(urls,index)},filesBrowser=function(data){__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.n(data)},imagesEvent=function(options){var type=options.type,params=options.params,index=options.index,formData=options.formData;if("browse"===type)imagesBrowser(params.value,index);else if("upload"===type){var maxSize=params.attachmentInfo.baseAttachmentInfo.maxImgSize;if(params.value.length>=Number(maxSize))return void __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.h("\u4f60\u6700\u591a\u53ea\u80fd\u4e0a\u4f20"+maxSize+"\u5f20\u56fe\u7247","center",1500,0);__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.o(params,""+(Number(maxSize)-params.value.length),{success:function(data,index){var attachInfo={id:data.id,fileUrl:data.fileUrl,size:data.size,createdate:data.createdate,filename:data.filename};params.attachmentInfo.attachmentInfos.push(attachInfo);var url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/fileUpload.do?method=showRTE&fileId="+data.fileUrl+"&createDate="+data.createdate+"&type=image&showType=small";params.value.splice(index,1,url),params.uploadState.splice(index,1,!0);var updateParams={attachments:[attachInfo],reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,baseAttachmentInfo:params.attachmentInfo.baseAttachmentInfo,formMasterId:formData.content.contentDataId};__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"POST",data:updateParams,url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/cap4/form/addOrDelAttachment",success:function(){},error:function(){}})},error:function(){}})}else if("close"===type){var updateParams={attachments:params.attachmentInfo.attachmentInfos.slice(index,index+1),reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,baseAttachmentInfo:params.attachmentInfo.baseAttachmentInfo,formMasterId:formData.content.contentDataId,type:"delete"};__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"POST",data:updateParams,url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/cap4/form/addOrDelAttachment",success:function(result){result.data&&"2000"===result.data.code&&(params.value.splice(index,1),params.uploadState.splice(index,1),params.attachmentInfo.attachmentInfos.splice(index,1))},error:function(){}})}},attachmentEvent=function(options){var type=options.type,params=options.params,index=options.index,formData=options.formData;if("browse"===type){var currentFile=params.attachmentInfo.attachmentInfos[index],data={path:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/fileDownload.do?method=doDownload&fileId="+currentFile.fileUrl+"&createDate="+currentFile.createdate+"&filename="+currentFile.filename+"&v="+currentFile.v,filename:currentFile.filename,fileId:currentFile.fileUrl,lastModified:currentFile.createdate};filesBrowser(data)}else if("upload"===type)__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.p(params,{success:function(files,data){var attachInfo={id:data.id,fileUrl:data.fileUrl,size:data.size,createdate:data.createdate,filename:data.filename,v:data.v};params.attachmentInfo.attachmentInfos.push(attachInfo),params.value.push(files);var updateParams={attachments:[attachInfo],reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,baseAttachmentInfo:params.attachmentInfo.baseAttachmentInfo,formMasterId:formData.content.contentDataId};__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"POST",data:updateParams,url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/cap4/form/addOrDelAttachment",success:function(){},error:function(){}})},error:function(){},cancel:function(){}});else if("close"===type){var updateParams={attachments:params.attachmentInfo.attachmentInfos.slice(index,index+1),reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,baseAttachmentInfo:params.attachmentInfo.baseAttachmentInfo,formMasterId:formData.content.contentDataId,type:"delete"};__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"POST",data:updateParams,url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/cap4/form/addOrDelAttachment",success:function(result){result.data&&"2000"===result.data.code&&(params.value.splice(index,1),params.attachmentInfo.attachmentInfos.splice(index,1))},error:function(){}})}},timeEvent=function(type,params){"close"===type?params.value="":__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.q(params,function(value){params.value=value})},organizeEvent=function(type,params){if("close"===type)params.value="",params.valueId="",params.showValue="";else if("choose"===type){var ret=[];params.value&&params.value.split(",").forEach(function(v){ret.push({id:v.split("|")[0],name:v.split("|")[1],type:-1===params.type.indexOf("multi")?params.type:params.type.substr(5,params.type.length)})}),__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.r(params,{fillBackData:ret,excludeData:[],callback:function(result){var ids=[],values=[],showValues=[];result.forEach(function(v){values.push(v.id+"|"+v.name),ids.push(""+v.id),showValues.push(v.name)}),params.value=values.join(","),params.valueId=ids.join(","),params.showValue=showValues.join(",")},closeCallback:function(){}})}},location=function(type,params){if(!cmp.platform.CMPShell)return void __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.h("\u5fae\u534f\u540c\u4e0d\u652f\u6301\u4f4d\u7f6e\u5b9a\u4f4d!","center",1500,0);var origin=params.placeHolder;"browse"===type?__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.s(params):"get"===type?(params.placeHolder="\u6b63\u5728\u5b9a\u4f4d...",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.t(params,{success:function(value,id){params.value=value.lbsAddr,params.valueId=id,params.placeHolder=origin},error:function(){}})):"close"===type&&(params.value="",params.valueId="",params.placeHolder=origin)},relationDoc=function(options){var type=options.type,params=options.params,index=options.index,formData=options.formData;if("browse"===type){var currentFile=params.attachmentInfo.attachmentInfos[index],baseObjectId=params.attachmentInfo.baseAttachmentInfo.reference;window.summaryBO&&window.summaryBO.summary&&(baseObjectId=window.summaryBO.summary.id);var category=params.attachmentInfo.baseAttachmentInfo.category,url=void 0,data=void 0;switch(currentFile.mimeType){case"meeting":data={openFrom:"glwd",meetingId:currentFile.description,baseApp:category,baseObjectId:baseObjectId},url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.meeting+"/html/meetingDetail.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,data,"all");break;case"collaboration":data={openFrom:"glwd",affairId:currentFile.description,baseApp:1,baseObjectId:baseObjectId},url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.collaboration+"/html/details/summary.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,data,"all");break;case"edoc":data={listType:"glwd",openFrom:"glwd",summaryId:currentFile.description,baseApp:category,baseObjectId:baseObjectId},url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.edoc+"/html/edocSummary.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,data,"all");break;case"km":case"docFile":__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__business_utils_relationDoc__.a)(currentFile.description,currentFile)}}else if("upload"===type)__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.v(params,{success:function(fileurls){var selectedIdMap={},newSelectedIdMap={};params.attachmentInfo.attachmentInfos.forEach(function(item,index){selectedIdMap[item.fileUrl]=""}),fileurls.forEach(function(v,i){var data=JSON.parse(v);if(selectedIdMap.hasOwnProperty(data.fileUrl))newSelectedIdMap[data.fileUrl]="";else{var fileName="",genesisId="",description="",fileUrl="";switch(data.type){case"collaboration":fileName=data.subject,genesisId=data.startMemberId,description=data.affairId,fileUrl=data.affairId;break;case"edoc":fileName=data.docName||data.secretLevelName,genesisId=data.summary.startUserId,description=data.affairId,fileUrl=data.affairId;break;case"km":case"docFile":fileName=data.docName,genesisId=data.fr_id,description=data.fr_id,fileUrl=data.fr_id,data.type="km";break;case"meeting":break;default:2!==data.type&&"2"!==data.type||(fileName=data.subject,genesisId=data.startMemberId,description=data.summaryId,fileUrl=data.affairId)}newSelectedIdMap[fileUrl]="";var attachInfo={id:data.id||"",fileUrl:fileUrl,size:data.size||"0",createdate:data.createDate||"",filename:fileName,v:data.v||"",mimeType:data.type,genesisId:genesisId,description:description,sort:params.attachmentInfo.attachmentInfos.length+i};params.attachmentInfo.attachmentInfos.push(attachInfo),params.value.push({name:fileName,size:data.size||"0",type:data.type})}});for(var len=params.attachmentInfo.attachmentInfos.length,i=0;i<len;){var item=params.attachmentInfo.attachmentInfos[i];newSelectedIdMap.hasOwnProperty(item.fileUrl)?i++:(params.attachmentInfo.attachmentInfos.splice(i,1),params.value.splice(i,1),len--)}var updateParams={attachments:params.attachmentInfo.attachmentInfos,reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,baseAttachmentInfo:params.attachmentInfo.baseAttachmentInfo,formMasterId:formData.content.contentDataId,subType:"document"};__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"POST",data:updateParams,url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/cap4/form/addOrDelAttachment",success:function(){},error:function(){}})},error:function(){},cancel:function(){}});else if("close"===type){var updateParams={attachments:params.attachmentInfo.attachmentInfos.slice(index,index+1),reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,baseAttachmentInfo:params.attachmentInfo.baseAttachmentInfo,formMasterId:formData.content.contentDataId,subType:"document",type:"delete"};__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"POST",data:updateParams,url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/cap4/form/addOrDelAttachment",success:function(result){result.data&&"2000"===result.data.code&&(params.value.splice(index,1),params.attachmentInfo.attachmentInfos.splice(index,1))},error:function(){}})}},mark=function(type,params){if(!cmp.platform.CMPShell)return void __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.h("\u5fae\u534f\u540c\u4e0d\u652f\u6301\u5730\u56fe\u6807\u6ce8!","center",1500,0);"browse"===type?__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.s(params):"get"===type?__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.w(params,{success:function(value,id){params.value={text:value.lbsAddr,url:""},params.valueId=id},error:function(){}}):"close"===type&&(params.value.text="",params.value.url="",params.valueId="")},photoLocation=function(options){var type=options.type,params=options.params,index=options.index,formData=options.formData;if(!cmp.platform.CMPShell)return void __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.h("\u5fae\u534f\u540c\u4e0d\u652f\u6301\u62cd\u7167\u5b9a\u4f4d!","center",1500,0);if("browse"===type)imagesBrowser([params.value[0].url],index);else if("browserLocation"===type)__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.s(params);else if("upload"===type){if(params.value.length&&params.value[0])return void __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.e({type:"warning",title:"\u63d0\u793a\u6d88\u606f",text:"\u7167\u7247\u5df2\u5b58\u5728\uff0c\u662f\u5426\u66f4\u65b0\uff1f",buttons:["\u786e\u5b9a","\u53d6\u6d88"],callback:function(i){0===i&&__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.x(params,{success:function(data,lbsAddr,id,ind){var attachInfo={id:data.id,fileUrl:data.fileUrl,size:data.size,createdate:data.createdate,filename:data.filename,subReference:id};params.attachmentInfo.baseAttachmentInfo.subReference=id;var v={url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/fileUpload.do?method=showRTE&fileId="+data.fileUrl+"&createDate="+data.createdate+"&type=image&showType=small",location:lbsAddr};params.attachmentInfo.attachmentInfos.splice(ind,1,attachInfo),params.value.splice(ind,1,v),params.uploadState.splice(ind,1,!0),params.valueId=id;var updateParams={attachments:[attachInfo],reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,baseAttachmentInfo:params.attachmentInfo.baseAttachmentInfo,formMasterId:formData.content.contentDataId};__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"POST",data:updateParams,url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/cap4/form/addOrDelAttachment",success:function(){},error:function(){}})},error:function(){}})}});__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.x(params,{success:function(data,lbsAddr,id,ind){var attachInfo={id:data.id,fileUrl:data.fileUrl,size:data.size,createdate:data.createdate,filename:data.filename,subReference:id};params.attachmentInfo.baseAttachmentInfo.subReference=id;var v={url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/fileUpload.do?method=showRTE&fileId="+data.fileUrl+"&createDate="+data.createdate+"&type=image&showType=small",location:lbsAddr};params.attachmentInfo.attachmentInfos.splice(ind,1,attachInfo),params.value.splice(ind,1,v),params.uploadState.splice(ind,1,!0),params.valueId=id;var updateParams={attachments:[attachInfo],reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,baseAttachmentInfo:params.attachmentInfo.baseAttachmentInfo,formMasterId:formData.content.contentDataId};__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"POST",data:updateParams,url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/cap4/form/addOrDelAttachment",success:function(){},error:function(){}})},error:function(){}})}else if("close"===type){var updateParams={attachments:params.attachmentInfo.attachmentInfos.slice(index,index+1),reference:params.attachmentInfo.baseAttachmentInfo.reference,subReference:params.attachmentInfo.baseAttachmentInfo.subReference,baseAttachmentInfo:params.attachmentInfo.baseAttachmentInfo,formMasterId:formData.content.contentDataId,type:"delete"};__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"POST",data:updateParams,url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/cap4/form/addOrDelAttachment",success:function(result){result.data&&"2000"===result.data.code&&(params.value.splice(index,1),params.uploadState.splice(index,1),params.attachmentInfo.attachmentInfos.splice(index,1),params.valueId="")},error:function(){}})}}},224:function(module,exports,__webpack_require__){"use strict";exports.__esModule=!0;var _defineProperty=__webpack_require__(218),_defineProperty2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_defineProperty);exports.default=function(obj,key,value){return key in obj?(0,_defineProperty2.default)(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}},225:function(module,__webpack_exports__,__webpack_require__){"use strict";function injectStyle(ssrContext){__webpack_require__(238)}var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_footers_vue__=__webpack_require__(213),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4689a137_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_footers_vue__=__webpack_require__(239),normalizeComponent=__webpack_require__(42),__vue_styles__=injectStyle,Component=normalizeComponent(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_footers_vue__.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_4689a137_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_footers_vue__.a,!1,__vue_styles__,null,null);__webpack_exports__.a=Component.exports},226:function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)(126)},227:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify__=__webpack_require__(44),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__=__webpack_require__(212),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_3_vue__=__webpack_require__(7),__WEBPACK_IMPORTED_MODULE_4_form_widget__=__webpack_require__(46),__WEBPACK_IMPORTED_MODULE_5__components_footers_footers_vue__=__webpack_require__(225),__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__=__webpack_require__(208),__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__=__webpack_require__(223),__WEBPACK_IMPORTED_MODULE_9__components_custom_custom_vue__=(__webpack_require__(214),__webpack_require__(243)),__WEBPACK_IMPORTED_MODULE_10__utils_tools_js__=__webpack_require__(215),__WEBPACK_IMPORTED_MODULE_11__utils_hub__=__webpack_require__(217),__WEBPACK_IMPORTED_MODULE_12__business_mixins_form_save__=__webpack_require__(220),__WEBPACK_IMPORTED_MODULE_13__business_mixins_form_util__=__webpack_require__(222),__WEBPACK_IMPORTED_MODULE_14__business_mixins_form_relation__=__webpack_require__(229),__WEBPACK_IMPORTED_MODULE_15__business_mixins_form_calculate__=__webpack_require__(219),__WEBPACK_IMPORTED_MODULE_16__business_mixins_form_external__=__webpack_require__(241),__WEBPACK_IMPORTED_MODULE_17__business_mixins_form_formson__=__webpack_require__(216),__WEBPACK_IMPORTED_MODULE_18__mixins_form_store__=__webpack_require__(221),__WEBPACK_IMPORTED_MODULE_19__utils_index__=__webpack_require__(23),__WEBPACK_IMPORTED_MODULE_20__business_utils_service__=__webpack_require__(209),__WEBPACK_IMPORTED_MODULE_21__assets_js_api__=__webpack_require__(43),__WEBPACK_IMPORTED_MODULE_22__utils_dragger_js__=__webpack_require__(242);__WEBPACK_IMPORTED_MODULE_3_vue__.default.use(__WEBPACK_IMPORTED_MODULE_4_form_widget__.default),__WEBPACK_IMPORTED_MODULE_3_vue__.default.use(__WEBPACK_IMPORTED_MODULE_4_form_widget__.Cap4SelectContentImage),__WEBPACK_IMPORTED_MODULE_3_vue__.default.use(__WEBPACK_IMPORTED_MODULE_4_form_widget__.Cap4SelectContent),__WEBPACK_IMPORTED_MODULE_3_vue__.default.use(__WEBPACK_IMPORTED_MODULE_4_form_widget__.Cap4BaseActionsheet),__webpack_exports__.a={name:"Formson",props:["params"],mixins:[__WEBPACK_IMPORTED_MODULE_18__mixins_form_store__.a,__WEBPACK_IMPORTED_MODULE_12__business_mixins_form_save__.a,__WEBPACK_IMPORTED_MODULE_13__business_mixins_form_util__.a,__WEBPACK_IMPORTED_MODULE_15__business_mixins_form_calculate__.a,__WEBPACK_IMPORTED_MODULE_14__business_mixins_form_relation__.a,__WEBPACK_IMPORTED_MODULE_16__business_mixins_form_external__.a,__WEBPACK_IMPORTED_MODULE_17__business_mixins_form_formson__.a],components:{Footers:__WEBPACK_IMPORTED_MODULE_5__components_footers_footers_vue__.a,CustomPrefix:__WEBPACK_IMPORTED_MODULE_9__components_custom_custom_vue__.a},directives:{dragger:__WEBPACK_IMPORTED_MODULE_22__utils_dragger_js__.a},data:function(){return{data:{},formsonData:{},extra:{through:{}},type:"",recordId:"",contentScrollState:!0,selectedMasterDataId:""}},computed:{currentFormMeta:function(){return{tableCategory:"formson",tableName:this._formsonParam.tableName}},currentFormData:function(){return{rawData:this.dbData.data,formmains:this.dbData.formmains,formsons:this.dbData.formsons}}},created:function(){var forward=__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.b()||{};this._isFormson=!0,this._formsonParam=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_19__utils_index__.b)(!0,forward),this.DBKey=forward.DBKey,this.type=forward.type,this.rightId=forward.params.rightId,this.recordId=forward.recordId,this.tableName=forward.tableName,window.xform=this},mounted:function(){var _this=this;this.getFromStore().then(function(ret){if(_this.dbData=ret,__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_21__assets_js_api__.c)(_this),_this.recordId&&(_this.dbData.recordId=_this.recordId),_this.dbData.backupData||(_this.dbData.backupData=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_19__utils_index__.b)(!0,ret)),!_this.dbData||!_this.dbData.recordId)return _this.getFormsonData("init");_this.formsonData=_this._getRecordByTableAndId(_this.tableName,_this.dbData.recordId)}).then(function(){_this.$nextTick(function(){var _formsonParam=_this._formsonParam,tableName=_formsonParam.tableName,focusField=_formsonParam.focusField,recordId=_this.formsonData.recordId,el=document.getElementById(tableName+"|"+recordId+"|"+focusField);el&&(el.scrollIntoViewIfNeeded?el.scrollIntoViewIfNeeded():el.scrollIntoView&&el.scrollIntoView()),__WEBPACK_IMPORTED_MODULE_21__assets_js_api__.b.$emit("formsonRendered",{metadata:_this.dbData.data})})}),this.addListenerEvent()},render:function(){return this.renderFrame()},methods:{getBaseStyles:function(){var defaultSkin=this._formsonParam.skinDefault,defaultBg="",fBg="";return defaultSkin.view.bgUrl?(defaultBg=__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.a()+"/seeyon/common/cap4/design/"+defaultSkin.view.bgUrl.substr(2,defaultSkin.view.bgUrl.length-2),fBg=-1===defaultSkin.view.bgUrl.indexOf("/seeyon")?defaultSkin.view.bgColor+" url("+defaultBg+") no-repeat center center":defaultSkin.view.bgColor+" url("+__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.a()+defaultSkin.view.bgUrl+") no-repeat center center"):fBg=defaultSkin.view.bgColor,{formHeaderBg:""+defaultSkin.head.backgroundColor,formHeaderColor:""+defaultSkin.head.color,formNavBg:defaultSkin.nav?""+defaultSkin.nav.backgroundColor:"",formFooterBg:defaultSkin.nav?""+defaultSkin.nav.backgroundColor:"",formFooterColor:"",formBg:fBg,fieldLine:"1px solid "+defaultSkin.divider.backgroundColor,fieldBg:""+defaultSkin.widget.box.backgroundColor,fieldTitleDefaultColor:""+defaultSkin.widget.label.color,fieldValueDefaultColor:""+defaultSkin.widget.body.color,isNotNullBg:""+defaultSkin.required.backgroundColor,placeholderColor:""+defaultSkin.widget.placeholder.color,formsonTiTleBorder:"1px solid "+defaultSkin.formson.head.borderColor,formsonArrowColor:""+defaultSkin.formson.arrow.color,formsonBg:""+defaultSkin.formson.snap.box.backgroundColor,formsonBorder:"1px solid "+defaultSkin.formson.snap.box.borderColor,formsonTitle:""+defaultSkin.formson.snap.label.color,formsonValue:""+defaultSkin.formson.snap.body.color}},getFormsonData:function(type){var _this2=this,params=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_19__utils_index__.b)(!0,this._formsonParam.params);return"saveCopy"===type&&(params.recordIds=[this.formsonData.recordId],params.type="copy"),params.from="lightForm",params.mergeData=this._buildSaveRequestParams("save",!0),__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.d("\u6570\u636e\u52a0\u8f7d\u4e2d..."),__WEBPACK_IMPORTED_MODULE_20__business_utils_service__.b(params).then(function(res){var _res$data=res.data,data=(_res$data.code,_res$data.data);__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.g(),_this2._manipulateForm(data.tableData,{record:function(action,payload){console.log([action,payload]);var table=payload.table,records=payload.records,record=records[0],dbData=_this2.dbData;if("add"===action){var _table$records;(_table$records=table.records).push.apply(_table$records,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(records)),_this2.formsonData=record,dbData.recordId=record.recordId,_this2.saveToStore(),"init"!==type&&(dbData.backupData=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_19__utils_index__.b)(!0,dbData))}}})},function(err){__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.g(),__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.h("\u64cd\u4f5c\u5931\u8d25","center",1500,0)})},copyUpdateFormsonData:function(retRecord){var lists=this.formsonData.lists;for(var i in lists){var fieldData=lists[i];fieldData.recordId=retRecord.recordId,retRecord.dataSubInfos[i]&&(this._mergeToField(fieldData,retRecord.dataSubInfos[i]),this.copyFliterValue(fieldData,retRecord.dataSubInfos[i].attachmentInfo))}},addListenerEvent:function(){var _this3=this;__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.c(function(){document.title=_this3._formsonParam.title,cmp.backbutton(),cmp.backbutton.push(function(){_this3.cancelSave()}),__WEBPACK_IMPORTED_MODULE_11__utils_hub__.b("com.seeyon.m3.SYNC_DB_DATA",function(evt){var _evt$data=evt.data,target=_evt$data.target,DBKey=(_evt$data.data,_evt$data.DBKey);"formson"===target&&DBKey===_this3._buildStoreKey()&&_this3.getFromStore().then(function(cacheData){_this3.dbData=cacheData,_this3.formsonData=_this3._getRecordByTableAndId(_this3.tableName,_this3.dbData.recordId)})});var handleRedirect=function(evt){console.log("beforepageredirect:",evt);var data=evt.data||{},done=data.done,location=data.location,cb=function(){return done&&done()};"changeFormType"in data||("server"===location?_this3.saveToServer("save",!0,cb,null,_this3.dbData.pageParams.params.moduleType,!0,{needCheckRule:"0",needDataUnique:"0",needSn:"0"}):_this3.saveToStore().then(cb,cb))};document.addEventListener("beforepageredirect",handleRedirect,!1),document.addEventListener("beforeviewleave",handleRedirect,!1)})},renderFrame:function(){var h=this.$createElement;if(this._formsonParam)return h("section",{class:"cap4-formBody__index",style:{background:this.getBaseStyles().formBg,backgroundSize:"100% 100%",position:"absolute",top:"0",left:"0",zIndex:"70"}},[this.renderHeader(),this.renderWrapper(),this.renderFooter(),this.renderQRCode()])},renderQRCode:function(){var h=this.$createElement;if(this.dbData&&this.dbData.data.content.allowQRScan)return h("div",{class:"icon CAP cap-icon-saoyisao form-qr-scan",ref:"qrScan",on:{tap:this.scanQRCode},directives:[{name:"dragger",value:!0}]})},renderHeader:function(){},renderWrapper:function(){return(0,this.$createElement)("div",{class:"cap4-formBody__wrapper",style:this.contentScrollState?{}:{overflowY:"hidden"}},[this.renderContainer()])},renderContainer:function(){var _this4=this,h=this.$createElement;return console.log("render formsonData",JSON.parse(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_json_stringify___default()(this.formsonData))),this.formsonData.lists||this.formsonData.listsIndex?h("div",{class:"cap4-formBody__container"},[this.formsonData.listsIndex.map(function(item){var data=_this4.formsonData.lists[item];return h("div",{attrs:{id:_this4._formsonParam.tableName+"|"+data.recordId+"|"+data.id},key:item},[_this4.renderComponents(data,data)])})]):""},renderFooter:function(){var h=this.$createElement,baseInfo=this.getBaseStyles();return h(__WEBPACK_IMPORTED_MODULE_5__components_footers_footers_vue__.a,{attrs:{type:this.type,bg:baseInfo.formNavBg},on:{saveFormData:this.saveFormData}})},renderComponents:function(item,data){var h=this.$createElement;switch(item.ctrlType){case"suiStatic":return h("section",{style:data.extra},[h("pre",[data.display])]);case"suiLabel":return h("cap4-link",{attrs:{data:data},on:{linkEvent:this.linkUrl}});case"suiLogo":return h("cap4-link-image",{attrs:{data:data},on:{linkImageEvent:this.linkImageUrl}});case"suiLineGap":return h("cap4-interval",{attrs:{data:data}});case"suiCustomControl":return h("custom-prefix",{attrs:{data:data,formdata:this.currentFormData,formDetails:this.currentFormMeta,formStore:this.dbData},on:{externalManipulateForm:this.handleExternalManipulateForm,externalCallApi:this.handleExternalCallApi,externalFillNormalField:this.handleExternalFillNormalField,externalFillAttachField:this.handleExternalFillAttachField}});default:switch(data.inputType){case"text":if("VARCHAR"===data.fieldType)return h("cap4-text",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,linkEvent:this.linkUrl}});if("DECIMAL"===data.fieldType)return h("cap4-number",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation}});break;case"textarea":return h("cap4-textarea",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,textAreaAddContent:this.textAreaAddContent,linkEvent:this.linkUrl}});case"checkbox":return h("cap4-checkbox",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation}});case"radio":return h("cap4-radio",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation}});case"date":return h("cap4-date",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,selectTime:__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.a}});case"datetime":return h("cap4-datetime",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,selectTime:__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.a}});case"select":return h("cap4-select",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,selectEvent:this.selectEvent}});case"member":case"multimember":return h("cap4-choose-people",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,chooseOrganize:__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.b}});case"post":case"multipost":return h("cap4-choose-post",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,chooseOrganize:__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.b}});case"department":case"multidepartment":return h("cap4-choose-department",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,chooseOrganize:__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.b}});case"account":case"multiaccount":return h("cap4-choose-company",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,chooseOrganize:__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.b}});case"level":case"multilevel":return h("cap4-choose-duty",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,chooseOrganize:__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.b}});case"image":return h("cap4-images",{attrs:{data:data},on:{calculate:this.calculate,imagesEvent:this.imagesEvent}});case"attachment":return h("cap4-attachment",{attrs:{data:data},on:{calculate:this.calculate,attachmentEvent:this.attachmentEvent}});case"maplocate":return h("cap4-location",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,locationEvent:__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.c}});case"mapphoto":return h("cap4-photo-location",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,photoEvent:this.photoEvent}});case"mapmarked":return h("cap4-location-mark",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,markEvent:this.markEvent}});case"document":return h("cap4-relation-doc",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,documentEvent:this.documentEvent}});case"imageradio":return h("cap4-radio-image",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation}});case"imageselect":return h("cap4-select-image",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,selectImageEvent:this.selectImageEvent}});case"flowdealoption":return h("cap4-flow",{attrs:{data:data},on:{calculate:this.calculate}})}}return""},saveFormData:function(type,isPrev){var _this5=this;isPrev||(__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.h("\u4fdd\u5b58\u6210\u529f","center",1500,1),setTimeout(function(){switch(type){case"save":_this5.closeWebView();break;case"saveNew":case"saveCopy":_this5.getFormsonData(type)}},1e3))},imagesBrowser:function(urls,index){__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.d(urls,index)},filesBrowser:function(files,index){__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.e(files,index)},scanQRCode:function(){var _this6=this;__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.y(function(err,result){if(err)return __WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.e({type:"alert",title:"",text:"\u626b\u63cf\u4e8c\u7ef4\u7801\u5931\u8d25",buttons:["\u786e\u5b9a"]});var data=null;try{data=JSON.parse(result.text)}catch(e){}data&&"cap4form"===data.codeType?_this6.saveToServer("save",!0,function(){__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.d("\u626b\u7801\u4e2d...");var payload={formId:_this6.dbData.data.content.contentTemplateId,dataId:_this6.dbData.data.content.contentDataId,moduleId:_this6.dbData.data.content.moduleId,rightId:_this6.dbData.data.content.rightId,recordId:_this6.dbData.recordId,tableName:_this6.tableName,content:result.text};__WEBPACK_IMPORTED_MODULE_20__business_utils_service__.g(payload).then(function(res){var _res$data2=res.data,data=(_res$data2.code,_res$data2.data);__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.g(),res.data.success?_this6._manipulateForm(data.tableData,null,function(){_this6.allFormCalculate()}):__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.e({type:"alert",title:"",text:res.data.msg||"\u4e8c\u7ef4\u7801\u89e3\u7801\u5931\u8d25",buttons:["\u786e\u5b9a"]})},function(err){__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.g(),__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.h(err.message||"\u4e8c\u7ef4\u7801\u89e3\u7801\u5931\u8d25","center",1500,0)})},null,_this6.dbData.pageParams.params.moduleType,!0,{needCheckRule:"0",needDataUnique:"0",needSn:"0"}):__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.h("\u6682\u4e0d\u652f\u6301\u6b64\u7c7b\u578b\u4e8c\u7ef4\u7801","center",1500,0)})},relation:function(opts,params){var _this7=this,type=opts.type,throughType=opts.throughType;if("icon"===type)if(params.relation.mainSelector){var relationSelector=this.dbData.relationSelector[params.relation.mainSelector],mainName="";if(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(this.dbData.formmains).forEach(function(m){mainName=_this7.dbData.formmains[m][params.relation.mainSelector]?_this7.dbData.formmains[m][params.relation.mainSelector].display:params.relation.mainSelectorDisplay}),!relationSelector)return __WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.h("\u8bf7\u5148\u9009\u62e9"+mainName+"\uff01","center",1500,0);this.selectedMasterDataId=relationSelector.toMasterDataId,this.selectedMasterDataId?(console.log("formsonToRelation",params),this.formsonToRelation(params)):__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.h("\u8bf7\u5148\u9009\u62e9"+mainName+"\uff01","center",1500,0)}else console.log("formsonToRelation",params),this.formsonToRelation(params);else if("value"===type){var formsonData=this.formsonData,recordId=formsonData.recordId,id=params.id,relation=params.relation,relationData=params.relationData,triggerData=params.triggerData,pid=recordId?id+"_"+recordId:id,rightId=void 0,moduleId=void 0,moduleType=void 0,payload=void 0;"relation"===throughType?(rightId="default_form_cap3"===relation.toVersion?relation.phoneView:this._buildRelationRightId(relation.pcView,relation.phoneView),moduleId=relationData.toMasterDataId||this.dbData.relationSelector[pid].toMasterDataId,moduleType="6"===relation.toFormType?"42":relation.toFormType):"trigger"===throughType&&(rightId=this._buildRelationRightId(triggerData.pcView,triggerData.phoneView),moduleId=triggerData.toMasterDataId,moduleType="6"===triggerData.toFormType?"42":triggerData.toFormType),this.setFormsons({formsons:this.dbData.formsons,type:"save",fData:this.formsonData,tableName:this._formsonParam.tableName}),this.dbData.formsonData=this.formsonData,"1"===moduleType?(payload={summaryId:moduleId,operationId:rightId,openFrom:"formRelation"},window.summaryBO&&window.summaryBO.summary&&(payload.baseObjectId=window.summaryBO.summary.id,payload.baseApp="1")):payload="default_form_cap3"===relation.toVersion?{rightId:rightId,moduleType:moduleType,moduleId:moduleId,contentAllId:moduleId,showType:"browse",viewState:"2",version:"cap3"}:{formType:"formmain",type:"browse",params:{rightId:rightId,moduleId:moduleId,moduleType:moduleType,operateType:"2"}},moduleType?__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.i(payload):__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.e({type:"warning",title:"",text:"\u8be5\u6761\u6570\u636e\u88ab\u5220\u9664",buttons:["\u786e\u5b9a"]})}},textAreaAddContent:function(params){var currentUser=this.dbData.data.user?this.dbData.data.user.name:"",currentTime=function(){return __WEBPACK_IMPORTED_MODULE_10__utils_tools_js__.a.systemTime()},base="["+currentUser+" "+currentTime()+"]";__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.e({type:"prompt",subType:4,title:"\u8bf7\u8f93\u5165\u60a8\u8981\u8ffd\u52a0\u7684\u5185\u5bb9",placeholder:"",defaultValue:"",buttons:["\u53d6\u6d88","\u786e\u5b9a"],callback:function(index,val){if(1===index){var baseSize=base.length,maxLength=Number(params.fieldLength)-params.value.length-baseSize,obj={type:"correct",data:val};"LONGTEXT"!==params.fieldType&&(maxLength<=0?(obj.type="error_01",obj.data="\u8d85\u8fc7\u5b57\u6bb5\u6700\u5927\u957f\u5ea6\uff0c\u5df2\u7ecf\u65e0\u6cd5\u7ee7\u7eed\u8ffd\u52a0\u6587\u5b57\u4e86\uff01"):val.length>maxLength&&(obj.type="error_02",obj.data="\u8ffd\u52a0\u6587\u672c\u6700\u5927\u957f\u5ea6\uff1a"+3*maxLength+"\uff01\uff08\u4e2d\u82f1\u6587\u3001\u6570\u5b57\u5b57\u7b26\u90fd\u5360\u636e\u4e09\u4e2a\u5b57\u7b26\u7684\u957f\u5ea6\uff09")),"error_01"===obj.type||"error_02"===obj.type?__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.e({type:"alert",title:"\u63d0\u793a\u6d88\u606f",text:obj.data,buttons:["\u786e\u5b9a"]}):(__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.e({type:"close"}),""!==params.value&&(params.value+="\r\n"),params.value+=obj.data+"\r\n\t["+currentUser+" "+currentTime()+"]",params.value=params.value.replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g,""))}else __WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.e({type:"close"})}})},linkUrl:function(params){var _params$attrs=params.attrs,linkable=_params$attrs.linkable,linkUrl=_params$attrs.linkUrl;linkable&&linkUrl&&__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.z(linkUrl)},linkImageUrl:function(params){this.linkUrl(params)},documentEvent:function(type,params,index){__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.f({type:type,params:params,index:index,formData:this.dbData.data})},imagesEvent:function(type,params,index){__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.g({type:type,params:params,index:index,formData:this.dbData.data})},attachmentEvent:function(type,params,index){__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.h({type:type,params:params,index:index,formData:this.dbData.data})},photoEvent:function(type,params,index){__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.i({type:type,params:params,index:index,formData:this.dbData.data})},markEvent:function(type,params){__WEBPACK_IMPORTED_MODULE_7__business_utils_native_js__.j(type,params)},selectImageEvent:function(params){var _this8=this;this.contentScrollState=!1;var sI=this.$cap4Selection({type:params.attrs.imgEnumFormat,data:params.enums,value:params.value,callback:function(type,result){if("complete"===type){if(!result)return sI.close(),void(_this8.contentScrollState=!0);params.value=result.id}sI.close(),_this8.contentScrollState=!0}})},selectEvent:function(params){var _this9=this;this.contentScrollState=!1;var sI=this.$cap4Select({data:params.enums,value:params.value,callback:function(type,result){if("complete"===type){if(!result)return sI.close(),void(_this9.contentScrollState=!0);params.value=result.id}sI.close(),_this9.contentScrollState=!0}})},cancelSave:function(immediate){this.closeWebView(immediate?"":"notSave")},openWebView:function(route,data,type){__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.j(route,data,type)},closeWebView:function(type){var _this10=this,deferred=new __WEBPACK_IMPORTED_MODULE_19__utils_index__.c,_dbData=this.dbData,data=_dbData.data,recordId=_dbData.recordId;if("notSave"!=type)this.setFormsons({formsons:this.dbData.formsons,type:"save",fData:this.formsonData,tableName:this._formsonParam.tableName}),deferred.resolve(1);else if(this.dbData=this.dbData.backupData,"new"===this.type){var params={formMasterId:data.content.contentDataId,formId:data.content.contentTemplateId,tableName:this._formsonParam.tableName,recordIds:[recordId],type:"delete",rightId:data.content.rightId,mergeData:this._buildSaveRequestParams("save",!0)};__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.d(" "),deferred=__WEBPACK_IMPORTED_MODULE_20__business_utils_service__.b(params),deferred.then(function(res){var _res$data3=res.data,data=(_res$data3.code,_res$data3.data);__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.g(),_this10._manipulateForm(data.tableData)},function(err){__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.g(),__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.h("\u64cd\u4f5c\u5931\u8d25","center",1500,0)})}else"edit"===this.type?(__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.d(" "),this.entireCalculate(function(){__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.g(" "),deferred.resolve(1)},function(){return __WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.g(" ")})):deferred.resolve(1);delete this.dbData.backupData,delete this.dbData.formsonData,delete this.dbData.recordId;var cb=function(){return _this10.saveToStore().then(function(){__WEBPACK_IMPORTED_MODULE_11__utils_hub__.a("com.seeyon.m3.SYNC_DB_DATA",{data:{target:"formmain",from:"formson",DBKey:_this10._buildStoreKey(),data:{recordType:_this10.type,recordId:_this10.formsonData.recordId,recordTable:_this10._formsonParam.tableName,frontTable:_this10._formsonParam.frontTableName}}}),__WEBPACK_IMPORTED_MODULE_6__utils_bridge_js__.f()})};deferred.then(cb,cb)}}}},228:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__js_adaptation__=__webpack_require__(245),__WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__=__webpack_require__(208),rloaded=/^(complete|loaded)$/,identifier="";__webpack_exports__.a={name:"CustomWidget",data:function(){var _data=this.data,id=_data.id,recordId=_data.recordId,formStore=this.formStore,viewIndex=formStore.viewIndex,_ref=formStore.data.content||{},contentDataId=_ref.contentDataId,channelId=recordId?""+id+recordId:""+id;return{widgetUid:contentDataId+"_"+viewIndex+"_"+channelId,channelId:channelId,message:{}}},props:["data","formdata","formDetails","formStore"],created:function(){this._customEvents=[]},mounted:function(){var _this=this;cmp.ready(function(){return _this.$nextTick(function(){return _this.load()})})},destroyed:function(){this._unbindEvents()},watch:{"$props.data":{handler:function(value){var _this2=this,channelId=this.channelId,widgetUid=this.widgetUid,formStore=this.formStore,_data2=this.data,id=_data2.id,recordId=_data2.recordId,viewIndex=formStore.viewIndex,_ref2=formStore.data.content||{},contentDataId=_ref2.contentDataId,newChannelId=recordId?""+id+recordId:""+id,newWidgetUid=contentDataId+"_"+viewIndex+"_"+newChannelId,source=this.data.customFieldInfo.mbInjectionInfo||{},scopeName=source.nameSpace;newWidgetUid!==widgetUid?(this.widgetUid=newWidgetUid,this.channelId=newChannelId,this.$nextTick(function(){window[scopeName]&&window[scopeName].destroy&&window[scopeName].destroy(channelId),_this2.load()})):__WEBPACK_IMPORTED_MODULE_0__js_adaptation__.a.ObserverEvent.trigger("Event"+channelId,value)},deep:!0}},methods:{load:function(){var source=this.data.customFieldInfo.mbInjectionInfo||{},wxpath=source.weixinpath||"collaboration",urlPrefix=cmp.platform.CMPShell?source.path:"/seeyon/m3/apps/v5/"+wxpath+"/",sourceUrl=urlPrefix+source.jsUri,entryName=source.initMethod;identifier=source.nameSpace;var scopeName=source.nameSpace,_data3=this.data,recordId=(_data3.id,_data3.recordId),uniqueId=this.channelId;__WEBPACK_IMPORTED_MODULE_0__js_adaptation__.a.adaptation({messageData:this.data,privateMessage:{recordsId:recordId,id:uniqueId},modifyFeld:["attachmentInfo","attrs","auth","ctrlBorderStyle","ctrlTitleStyle","ctrlType","customFieldInfo","digitNum","display","enums","extra","fieldLength","fieldType","formType","formatType","id","inputType","isInCalculate","isInCondition","isNotNull","placeHolder","radioAlignType","recordId","relation","showValue","type","value","valueId","customValue"],parentObject:this,formdata:this.formdata}),this._bindEvents(),this._doLoad(sourceUrl,urlPrefix,uniqueId,entryName,scopeName)},customEvent:function(){var newObj=__WEBPACK_IMPORTED_MODULE_0__js_adaptation__.a.parentGetData(this.data.id);this.$emit("modifyprops",newObj)},_bindEvents:function(){var _this3=this,channelId=this.channelId;this._unbindEvents(),this._listen("openPageMobile"+channelId,function(payload){__WEBPACK_IMPORTED_MODULE_1__utils_bridge_js__.j(payload.subUrl,{title:"\u67e5\u8be2",appId:payload.appId})}),this._listen("externalManipulateForm",function(payload){payload.privateId||console.warn("\u5fc5\u987b\u5305\u542bprivateId"),payload.privateId===channelId&&_this3.$emit("externalManipulateForm",payload)}),this._listen("externalCallApi",function(payload){payload.privateId||console.warn("\u5fc5\u987b\u5305\u542bprivateId"),payload.privateId===channelId&&_this3.$emit("externalCallApi",payload.data)}),this._listen("externalFillNormalField",function(payload){payload.privateId||console.warn("\u5fc5\u987b\u5305\u542bprivateId"),payload.privateId===channelId&&_this3.$emit("externalFillNormalField",payload.data)}),this._listen("externalFillAttachField",function(payload){payload.privateId||console.warn("\u5fc5\u987b\u5305\u542bprivateId"),payload.privateId===channelId&&_this3.$emit("externalFillAttachField",payload.data)})},_unbindEvents:function(){for(;this._events.length;){var detach=this._customEvents.shift();detach&&detach()}},_listen:function(name,cb){__WEBPACK_IMPORTED_MODULE_0__js_adaptation__.a.ObserverEvent.listen(name,cb);var detach=function(){__WEBPACK_IMPORTED_MODULE_0__js_adaptation__.a.ObserverEvent.remove(name,cb)};return this._customEvents.push(detach),detach},_doCreate:function(urlPrefix,privateId,entryName,scopeName){window[scopeName]&&window[scopeName][entryName]?window[scopeName][entryName]({adaptation:__WEBPACK_IMPORTED_MODULE_0__js_adaptation__.a,urlPrefix:urlPrefix,url_prefix:urlPrefix,privateId:privateId,getData:__WEBPACK_IMPORTED_MODULE_0__js_adaptation__.a.childrenGetData(privateId),formMessage:this.formDetails}):console.warn('"'+scopeName+'" not registered nor "'+scopeName+"."+entryName+'" not implemented yet.')},_doLoad:function(sourceUrl,urlPrefix,privateId,entryName,scopeName){var _this4=this;if(window[scopeName]&&window[scopeName][entryName])return this._doCreate(urlPrefix,privateId,entryName,scopeName);var head=document.getElementsByTagName("head")[0],script=document.createElement("script");script.src=sourceUrl,script.async=!0,head.appendChild(script),script.onerror=function(e){script.onload=script.onreadystatechange=script.onerror=null,console.warn('failed to load custom widget resource "'+sourceUrl+'"'+scopeName+'".')},script.onload=script.onreadystatechange=function(e){("load"===e.type||rloaded.exec(script.readyState))&&(script.onload=script.onreadystatechange=script.onerror=null,_this4._doCreate(urlPrefix,privateId,entryName,scopeName))}}}}},229:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__utils_index__=__webpack_require__(23),__WEBPACK_IMPORTED_MODULE_1__business_utils_service__=__webpack_require__(209);__webpack_exports__.a={methods:{getFillRelationData:function(params){return __WEBPACK_IMPORTED_MODULE_1__business_utils_service__.e(params)},getRelationParams:function(params){return{relationShipId:params.relationShipId,fromRightId:this.dbData.data.content.rightId,fromDataId:params.fromDataId,selectDatas:params.result,fromRecordId:params.fromRecordId}},getLength:function(obj){var ccount=0;for(var i in obj)ccount++;return ccount},relationFillbackFormmain:function(params){var _this=this;console.log("relationFillbackFormmain",params);var deferred=new __WEBPACK_IMPORTED_MODULE_0__utils_index__.c;if(!params.result.length)return deferred.resolve(),deferred;var setParams=this.getRelationParams(params);return this.getFillRelationData(setParams).then(function(res){var _res$data=res.data,data=(_res$data.code,_res$data.data);_this._manipulateForm(data.tableData),deferred.resolve()},function(err){console.log("error:",err)}),deferred},formsonToRelation:function(params){var payload={title:"\u5173\u8054\u5217\u8868",type:"browse",formType:"formson",params:params,content:this._formsonParam.params,recordId:this.formsonData.recordId,selectedMasterDataId:this.selectedMasterDataId,DBKey:this.DBKey,tbName:this._formsonParam.tableName,frontTableName:this._formsonParam.frontTableName};this.setFormsons({formsons:this.dbData.formsons,type:"save",fData:this.formsonData,recordId:this.formsonData.recordId,tableName:this._formsonParam.tableName}),this.dbData.formsonData=this.formsonData,this.openWebView("relation",payload)},relationFillbackFormson:function(params){var _this2=this,deferred=new __WEBPACK_IMPORTED_MODULE_0__utils_index__.c,setParams=this.getRelationParams(params);return this.getFillRelationData(setParams).then(function(res){var _res$data2=res.data,data=(_res$data2.code,_res$data2.data);_this2._manipulateForm(data.tableData,{record:function(action,payload){console.log([action,payload])}}),deferred.resolve()},function(err){console.log("error:",err)}),deferred}}}},230:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof__=__webpack_require__(45),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty__=__webpack_require__(224),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__=__webpack_require__(212),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_4__utils_index__=__webpack_require__(23),__WEBPACK_IMPORTED_MODULE_5__assets_js_api__=__webpack_require__(43);__webpack_exports__.a={methods:{_dropTableRecords:function(mutations){if(mutations&&!(!mutations.length>0)){var formsons=this.dbData.formsons;mutations.forEach(function(name){var formson=formsons[name];formson&&formson.records instanceof Array&&formson.records.splice(0)})}},_manipulateForm:function(mutations,plugin,callback){var _this=this,_dbData=this.dbData,formmains=_dbData.formmains,formsons=_dbData.formsons,formsonMap={};__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(formsons).forEach(function(name){var formson=formsons[name];formsonMap[formson.tableName]=formson}),plugin=plugin||{},__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(mutations||{}).forEach(function(name){var mutation=mutations[name];0===name.indexOf("formmain_")?_this._manipulateFormain(name,formmains[name],mutation,plugin):_this._manipulateFormson(name,formsonMap[name],mutation,plugin)}),callback&&callback(),__WEBPACK_IMPORTED_MODULE_5__assets_js_api__.b.$emit("updated"),this.setCalculateLock()},_manipulateFormain:function(tableName,table,mutation,plugin){var _this2=this;if(!table)return console.warn('formain "'+tableName+'" not found');var fieldPlugin=plugin.field;__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(mutation).forEach(function(action){if("update"===action){var fieldset=mutation[action];__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(fieldset).forEach(function(fieldName){var source=fieldset[fieldName];if("relationRecords"!==fieldName){var target=table[fieldName];if(!target||!source)return;_this2._setField(target,source),fieldPlugin&&fieldPlugin(target)}else _this2.setRelationSelector(source)})}})},_manipulateFormson:function(tableName,table,mutation,plugin){var _this3=this;if(!table)return console.warn('formson "'+tableName+'" not found');__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(mutation).forEach(function(action){var recordset=mutation[action];"add"===action?_this3._addRecord(table,recordset,plugin):"delete"===action?_this3._deleteRecord(table,recordset,plugin):"update"===action&&_this3._updateRecord(table,recordset,plugin)})},_addRecord:function(table,recordset,plugin){var _this4=this;Array.isArray(recordset)||(recordset=[recordset]);var recordPlugin=plugin.record,fieldPlugin=plugin.field,records=table.records,templateRecord=table.templateRecord,ignores=["recordId","relationRecords"],relations=[];recordset=recordset.map(function(fieldset){var record=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__utils_index__.b)(!0,templateRecord);return record.recordId=fieldset.recordId,__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(fieldset).forEach(function(name){if(!(ignores.indexOf(name)>-1)){var target=record.lists[name],source=fieldset[name];target&&source&&(target.recordId=record.recordId,_this4._setField(target,source),fieldPlugin&&fieldPlugin(target))}}),fieldset.relationRecords&&relations.push.apply(relations,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(fieldset.relationRecords)),record}),recordPlugin?recordPlugin("add",{table:table,records:recordset}):records.push.apply(records,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(recordset)),this.setRelationSelector(relations)},_deleteRecord:function(table,idsOrIndexes,plugin){var _this5=this,recordPlugin=plugin.record,records=table.records,deleted=[];if(Array.isArray(idsOrIndexes)||(idsOrIndexes=[idsOrIndexes]),"number"==typeof idsOrIndexes[0])idsOrIndexes.sort(function(a,b){return a>b?-1:1}),idsOrIndexes.forEach(function(index){var record=records[index];record&&(deleted.unshift(record),records.splice(index,1))});else for(var record,size=idsOrIndexes.length,i=0;size>0&&i<records.length;++i)(record=records[i])&&idsOrIndexes.indexOf(record.recordId)>-1&&(deleted.push(record),records.splice(i--,1),size--);deleted.forEach(function(record){_this5._deleteRelationByRecordId(record.recordId)}),recordPlugin&&recordPlugin("delete",{table:table,records:deleted})},_updateRecord:function(table,recordId,data,plugin){var _this6=this,records=table.records,ignores=["recordId","relationRecords"],recordMap={},updated=[],relations=[],recordset=void 0,recordPlugin=void 0,fieldPlugin=void 0;"string"==typeof recordId&&data?recordset=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_defineProperty___default()({},recordId,data):"object"===(void 0===recordId?"undefined":__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default()(recordId))&&recordId&&(recordset=recordId,plugin=data),recordPlugin=plugin.record,fieldPlugin=plugin.field,Array.isArray(recordset)&&(recordset=recordset.reduce(function(map,record){map[record.recordId]=record},{})),records.forEach(function(record){record&&(recordMap[record.recordId]=record)}),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(recordset).forEach(function(recordId){var fieldset=recordset[recordId],record=recordMap[recordId];record&&(updated.push(record),fieldset.relationRecords&&relations.push.apply(relations,__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_toConsumableArray___default()(fieldset.relationRecords)),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(fieldset).forEach(function(name){if(!(ignores.indexOf(name)>-1)){var target=record.lists[name],source=fieldset[name];target&&source&&(_this6._setField(target,source),fieldPlugin&&fieldPlugin(target))}}))}),recordPlugin&&recordPlugin("update",{table:table,records:updated}),this.setRelationSelector(relations)}}}},231:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__=__webpack_require__(211),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__=__webpack_require__(210),getSaveParams=function(operateType,type,isPrev,mainbodyArgs,moduleType,_this){var contentOpts=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},_this$dbData=_this.dbData,data=_this$dbData.data,formmains=_this$dbData.formmains,formsons=_this$dbData.formsons,relationSelector=_this$dbData.relationSelector,params={content:__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({},data.content),relationRecords:data.relationRecords,attachments:[],customFields:{}};switch(params.content.isMerge=isPrev?"1":"0",type){case"save":params.content.saveType="1";break;case"saveNew":params.content.saveType="2";break;case"saveCopy":params.content.saveType="3"}mainbodyArgs&&"saveAsTemplate"===mainbodyArgs.optType&&(params.content.saveType="4"),contentOpts&&(params.content=__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_extends___default()({},params.content,contentOpts)),params[data.tableInfo.formmain.tableName]={},__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formmains[data.tableInfo.formmain.tableName]).forEach(function(v){if(-1===__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.auxiliary.indexOf(formmains[data.tableInfo.formmain.tableName][v].ctrlType)){params[data.tableInfo.formmain.tableName][v]=formmains[data.tableInfo.formmain.tableName][v].value||"";var obj=formmains[data.tableInfo.formmain.tableName][v];obj.isCustomField&&obj.hasOwnProperty("customValue")&&(params.customFields[obj.id]=obj.customValue||""),-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.file.indexOf(obj.inputType)||obj.attachmentInfo&&obj.attachmentInfo.attachmentInfos&&obj.attachmentInfo.attachmentInfos.length?(obj.attachmentInfo.attachmentInfos.length?(obj.attachmentInfo.attachmentInfos.forEach(function(val){var attach={reference:obj.attachmentInfo.baseAttachmentInfo.reference,category:obj.attachmentInfo.baseAttachmentInfo.category,mimeType:"document"!==obj.attachmentInfo.baseAttachmentInfo.mimeType?obj.attachmentInfo.baseAttachmentInfo.mimeType:val.mimeType,subReference:"mapphoto"!==obj.type?obj.attachmentInfo.baseAttachmentInfo.subReference:val.subReference,type:obj.attachmentInfo.baseAttachmentInfo.type,genesisId:val.genesisId,description:val.description,sort:val.sort,id:val.id,fileUrl:val.fileUrl,size:val.size,createdate:val.createdate,filename:val.filename};params.attachments.push(attach)}),"mapphoto"!==obj.type&&(obj.valueId=obj.attachmentInfo.baseAttachmentInfo.subReference)):obj.valueId="",params[data.tableInfo.formmain.tableName][v]=obj.valueId):-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.map.indexOf(obj.inputType)?params[data.tableInfo.formmain.tableName][v]=obj.valueId:-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.organize.indexOf(obj.inputType)?params[data.tableInfo.formmain.tableName][v]=obj.valueId:-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.flow.indexOf(obj.inputType)&&(params[data.tableInfo.formmain.tableName][v]=obj.valueId)}}),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formsons).forEach(function(v){params[formsons[v].tableName]=[],formsons[v].records.forEach(function(val){var tempObj={id:val.recordId},fsonLists=val.lists;for(var props in fsonLists)Object.prototype.hasOwnProperty.call(fsonLists,props)&&-1===__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.auxiliary.indexOf(fsonLists[props].ctrlType)&&function(){tempObj[props]=fsonLists[props].value||"";var obj=fsonLists[props];obj.isCustomField&&obj.hasOwnProperty("customValue")&&(params.customFields[props+"_"+val.recordId]=obj.customValue||""),obj.isAttachment?(obj.attachmentInfo.attachmentInfos.length?(obj.attachmentInfo.attachmentInfos.forEach(function(value){var attach={reference:obj.attachmentInfo.baseAttachmentInfo.reference,category:obj.attachmentInfo.baseAttachmentInfo.category,mimeType:"document"!==obj.attachmentInfo.baseAttachmentInfo.mimeType?obj.attachmentInfo.baseAttachmentInfo.mimeType:value.mimeType,subReference:"mapphoto"!==obj.type?obj.attachmentInfo.baseAttachmentInfo.subReference:value.subReference,type:obj.attachmentInfo.baseAttachmentInfo.type,genesisId:value.genesisId,description:value.description,sort:value.sort,id:value.id,fileUrl:value.fileUrl,size:value.size,createdate:value.createdate,filename:value.filename};params.attachments.push(attach)}),"mapphoto"!==obj.type&&(obj.valueId=obj.attachmentInfo.baseAttachmentInfo.subReference)):obj.valueId="",tempObj[props]=obj.valueId):-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.map.indexOf(obj.inputType)?tempObj[props]=obj.valueId:-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.organize.indexOf(obj.inputType)?tempObj[props]=obj.valueId:-1!==__WEBPACK_IMPORTED_MODULE_2__business_utils_field_types_js__.a.flow.indexOf(obj.inputType)&&(tempObj[props]=obj.valueId)}();params[formsons[v].tableName].push(tempObj)})});for(var props in relationSelector)relationSelector.hasOwnProperty(props)&&function(){var rs=params.relationRecords,keyArr=[];if(rs.forEach(function(v){keyArr.push(v.keyId)}),-1===keyArr.indexOf(props))params.relationRecords.push(relationSelector[props]);else for(var i=0,l=rs.length;i<l;i++)if(rs[i].keyId===props){params.relationRecords.splice(i,1,relationSelector[props]);break}}();return params.content.operateType=operateType,_this.dbData.data.content.formsonNumThreshold&&(params[data.tableInfo.formmain.tableName]={},__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(formsons).forEach(function(v){params[formsons[v].tableName]=[]})),params};__webpack_exports__.a=getSaveParams},232:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return docJumpPage});var __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__=__webpack_require__(208),docJumpPage=function(docResourceId,loadParam,att){__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"GET",url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/doc/"+docResourceId+"?option.n_a_s=1",success:function(ret1){var _ref=ret1||{},frType=_ref.frType,pigeonholeType=_ref.pigeonholeType,sourceId=_ref.sourceId;if(void 0===frType)return __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.h("\u4e0d\u652f\u6301\u67e5\u770b","center",1500,0);__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"GET",url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/doc/canOppen?drId="+docResourceId+"&frType="+frType+"&entranceType=8&option.n_a_s=1",success:function(ret2){if("1"==ret2)return __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.h("\u4e0d\u652f\u6301\u67e5\u770b","center",1500,0);"51"==frType?__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.k({type:"GET",url:__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.a()+"/seeyon/rest/doc/docView?drId="+docResourceId+"&option.n_a_s=1",success:function(ret3){sourceId=ret3.sourceId,docResourceId=ret3.id,frType=ret3.frType,openDoc(sourceId,docResourceId,frType,pigeonholeType,loadParam,att)},error:function(){__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.h("\u4e0d\u652f\u6301\u67e5\u770b","center",1500,0)}}):openDoc(sourceId,docResourceId,frType,pigeonholeType,loadParam,att)},error:function(){__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.h("\u4e0d\u652f\u6301\u67e5\u770b","center",1500,0)}})},error:function(err){__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.h("\u4e0d\u652f\u6301\u67e5\u770b","center",1500,0)}})},openDoc=function(sourceId,docResourceId,frType,pigeonholeType,loadParam,att){var url,att=(loadParam.document||document,att||{});if(1==frType||9==frType){var paramData={openFrom:"docLib",affairId:sourceId,pigeonholeType:pigeonholeType||"",docResId:docResourceId,baseApp:att.category||"",baseObjectId:att.reference||""};url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.collaboration+"/html/details/summary.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,paramData,"all")}else if(2==frType){var paramData={listType:"glwd",openFrom:"docLib",summaryId:sourceId,docResId:docResourceId,baseApp:att.category||"",baseObjectId:att.reference||""};url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.edoc+"/html/edocSummary.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,paramData,"all")}else if(4==frType){var paramData={listType:"glwd",openFrom:"docLib",meetingId:sourceId,docResId:docResourceId,baseApp:att.category||"",baseObjectId:att.reference||""};url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.meeting+"/html/meetingDetail.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,paramData,"all")}else if(5==frType){var paramData={comeFrom:1,newsId:sourceId,pageInfo:loadParam.pageInfo};url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.news+"/html/newsView.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,paramData,"all")}else if(6==frType){var paramData={comeFrom:1,bulId:sourceId,pageInfo:loadParam.pageInfo};url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.bulletin+"/html/bulView.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,paramData,"all")}else if(7==frType){var paramData={comeFrom:1,inquiryId:sourceId,pageInfo:loadParam.pageInfo};url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.inquiry+"/html/inquiryView.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,paramData,"all")}else if(8==frType){var paramData={from:"pigeonhole",bbsId:sourceId,pageInfo:loadParam.pageInfo};url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.bbs+"/html/bbsView.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,paramData,"all")}else if(frType>=101&&frType<=122||frType>=21&&frType<=26){var paramData={drId:docResourceId,pageInfo:loadParam.pageInfo,glwd:!0};url=__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.u.doc+"/html/docView.html",__WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.j(url,paramData,"all")}else __WEBPACK_IMPORTED_MODULE_0__utils_bridge_js__.h("\u4e0d\u652f\u6301\u67e5\u770b","center",1500,0)}},233:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__(44),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1__utils_index__=__webpack_require__(23),store={save:function(cacheKey,cacheData){var deferred=new __WEBPACK_IMPORTED_MODULE_1__utils_index__.c;return cacheData=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.b)(!0,cacheData),cmp.storageDB.save(cacheKey,cacheData,function(result){console.log("cache.save:",cacheKey,cacheData,result),result.success?deferred.resolve(result):deferred.reject()}),deferred},get:function(cacheKey){var deferred=(!(arguments.length>1&&void 0!==arguments[1])||arguments[1],new __WEBPACK_IMPORTED_MODULE_1__utils_index__.c);return cmp.storageDB.get(cacheKey,function(result){if(console.log("cache.get:",cacheKey,result),result.success&&result.data){if(!result.data)return deferred.reject();deferred.resolve(JSON.parse(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(result.data)))}else deferred.reject()}),deferred},remove:function(cacheKey){var deferred=new __WEBPACK_IMPORTED_MODULE_1__utils_index__.c;return cmp.storageDB.delete(cacheKey,function(result){console.log("cache.remove:done",cacheKey),result.success?deferred.resolve(result):deferred.reject()}),deferred}};__webpack_exports__.a=store},234:function(module,exports,__webpack_require__){module.exports={default:__webpack_require__(235),__esModule:!0}},235:function(module,exports,__webpack_require__){__webpack_require__(25),__webpack_require__(237),module.exports=__webpack_require__(2).Array.from},236:function(module,exports,__webpack_require__){"use strict";var $defineProperty=__webpack_require__(8),createDesc=__webpack_require__(24);module.exports=function(object,index,value){index in object?$defineProperty.f(object,index,createDesc(0,value)):object[index]=value}},237:function(module,exports,__webpack_require__){"use strict";var ctx=__webpack_require__(10),$export=__webpack_require__(5),toObject=__webpack_require__(53),call=__webpack_require__(49),isArrayIter=__webpack_require__(48),toLength=__webpack_require__(51),createProperty=__webpack_require__(236),getIterFn=__webpack_require__(52);$export($export.S+$export.F*!__webpack_require__(50)(function(iter){Array.from(iter)}),"Array",{from:function(arrayLike){var length,result,step,iterator,O=toObject(arrayLike),C="function"==typeof this?this:Array,aLen=arguments.length,mapfn=aLen>1?arguments[1]:void 0,mapping=void 0!==mapfn,index=0,iterFn=getIterFn(O);if(mapping&&(mapfn=ctx(mapfn,aLen>2?arguments[2]:void 0,2)),void 0==iterFn||C==Array&&isArrayIter(iterFn))for(length=toLength(O.length),result=new C(length);length>index;index++)createProperty(result,index,mapping?mapfn(O[index],index):O[index]);else for(iterator=iterFn.call(O),result=new C;!(step=iterator.next()).done;index++)createProperty(result,index,mapping?call(iterator,mapfn,[step.value,index],!0):step.value);return result.length=index,result}})},238:function(module,exports){},239:function(module,__webpack_exports__,__webpack_require__){"use strict";var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return"new"===_vm.type||"edit"===_vm.type||"sure"===_vm.type||"sure-checkable"===_vm.type?_c("section",{staticClass:"cap4-footers",style:{background:_vm.bg}},["new"===_vm.type?_c("div",{staticClass:"cap4-footers__display is-justify"},[_c("div",{staticClass:"cap4-footers__btn",domProps:{textContent:_vm._s(_vm.$t("foot.saveNew"))},on:{tap:function($event){_vm.saveFormData("saveNew")}}}),_vm._v(" "),_c("div",{staticClass:"cap4-footers__btn",domProps:{textContent:_vm._s(_vm.$t("foot.saveCopy"))},on:{tap:function($event){_vm.saveFormData("saveCopy")}}}),_vm._v(" "),_c("div",{staticClass:"cap4-footers__btn",domProps:{textContent:_vm._s(_vm.$t("foot.save"))},on:{tap:function($event){_vm.saveFormData("save")}}})]):_vm._e(),_vm._v(" "),"edit"===_vm.type?_c("div",{staticClass:"cap4-footers__display is-alone"},[_c("div",{staticClass:"cap4-footers__btn",domProps:{textContent:_vm._s(_vm.$t("foot.save"))},on:{tap:function($event){_vm.saveFormData("save")}}})]):_vm._e(),_vm._v(" "),_vm.type.indexOf("sure")>-1?_c("div",{staticClass:"cap4-footers__display",class:"sure"===_vm.type?"is-alone":"is-alone-checkable"},["sure"!==_vm.type?_c("div",{staticClass:"cap4-footers__checker",on:{tap:_vm.handleCheckAll}},[_vm._v(_vm._s(_vm.checked?"\u53d6\u6d88\u5168\u9009":"\u5168\u9009"))]):_vm._e(),_vm._v(" "),_c("div",{staticClass:"cap4-footers__btn",domProps:{textContent:_vm._s(_vm.$t("foot.sure"))},on:{tap:function($event){_vm.saveFormData("sure")}}})]):_vm._e()]):_vm._e()},staticRenderFns=[],esExports={render:render,staticRenderFns:staticRenderFns};__webpack_exports__.a=esExports},240:function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)(14)},241:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof__=__webpack_require__(45),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof__),__WEBPACK_IMPORTED_MODULE_2__business_utils_service__=__webpack_require__(209),__WEBPACK_IMPORTED_MODULE_3__utils_index__=__webpack_require__(23),__WEBPACK_IMPORTED_MODULE_4__utils_bridge_js__=__webpack_require__(208);__webpack_exports__.a={methods:{handleExternalManipulateForm:function(payload){var data=payload.data,callback=payload.callback;this._manipulateForm(data,null,function(){return callback&&callback()})},handleExternalCallApi:function(payload){var action=payload.action,callback=payload.callback,validation=payload.validation,cb=function(){return callback&&callback()};"presave"===action?this.saveToServer("save",!0,cb,null,this.dbData.pageParams.params.moduleType,!0,validation):console.warn('unknow call "'+action+'"')},handleExternalFillNormalField:function(payload,callback){var _this=this;Array.isArray(payload)?payload.forEach(function(item){return _this._doExternalFillNormalField(item)}):payload&&"object"===(void 0===payload?"undefined":__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(payload))&&this._doExternalFillNormalField(payload),!1!==payload.calculate&&this.allFormCalculate(),callback&&callback()},handleExternalFillAttachField:function(payload,callback){var _this2=this,deferreds=[];return Array.isArray(payload)?payload.forEach(function(item){deferreds.push(_this2._doExternalFillAttachField(item))}):payload&&"object"===(void 0===payload?"undefined":__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_typeof___default()(payload))&&deferreds.push(this._doExternalFillAttachField(payload)),!1!==payload.calculate&&this.allFormCalculate(),__WEBPACK_IMPORTED_MODULE_3__utils_index__.c.when(deferreds).then(function(result){callback&&callback(result)})},_doExternalFillNormalField:function(payload){var tableCategory=payload.tableCategory,updateData=payload.updateData,_dbData=this.dbData,formmains=_dbData.formmains,data=(_dbData.formsons,_dbData.data),targetCtx="formmain"===tableCategory?formmains[data.tableInfo.formmain.tableName]:this.formsonData.lists;__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(updateData).forEach(function(fieldName,fieldIndex){var field=targetCtx[fieldName],updated=updateData[fieldName];field&&(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(updated).forEach(function(name,index){var value=updated[name];"value"===name?field.valueId=value:"showValue2"===name?field.value=value:field[name]=value}),targetCtx[fieldName]=field)})},_doExternalFillAttachField:function(payload){var deferred=new __WEBPACK_IMPORTED_MODULE_3__utils_index__.c,tableCategory=payload.tableCategory,fieldName=payload.fieldName,handlerMode=payload.handlerMode,_dbData2=this.dbData,formmains=(_dbData2.formsons,_dbData2.formmains),data=_dbData2.data,targetCtx="formmain"===tableCategory?formmains[data.tableInfo.formmain.tableName]:this.formsonData.lists,field=targetCtx[fieldName],attachData=field&&field.attachmentInfo,fieldAttachments=attachData&&attachData.attachmentInfos,fieldAttachBase=attachData&&attachData.baseAttachmentInfo;if(!fieldAttachments)return deferred.resolve(),deferred;var requestPayload={attachments:[],reference:fieldAttachBase.reference,subReference:fieldAttachBase.subReference,formMasterId:data.content.contentDataId};if("add"===handlerMode){var serverIp=__WEBPACK_IMPORTED_MODULE_4__utils_bridge_js__.a();payload.addAttchmentData.forEach(function(att){requestPayload.attachments.push(att),fieldAttachments.push(att),Array.isArray(field.value)&&("image"===att.type?field.value.push({url:serverIp+"/seeyon/fileUpload.do?method=showRTE&fileId="+att.fileUrl+"&createDate="+att.createdate+"&type=image&showType=small",bigUrl:serverIp+"/seeyon/fileUpload.do?method=showRTE&fileId="+att.fileUrl+"&createDate="+att.createdate+"&type=image&showType=big"}):"attachment"===att.type&&field.value.push({name:att.filename,size:att.size}))}),requestPayload.baseAttachmentInfo=fieldAttachBase}else"delete"===handlerMode&&payload.deleteAttchmentData.forEach(function(att){var index=-1;fieldAttachments.some(function(it,pos){return it.id===att&&(index=pos,!0)})&&(fieldAttachments.splice(index,1),requestPayload.type="delete",requestPayload.attachments.push({id:att}),Array.isArray(field.value)&&field.value.splice(index,1))});return requestPayload.attachments.length?__WEBPACK_IMPORTED_MODULE_2__business_utils_service__.h(requestPayload).then(function(res){return deferred.resolve(res)},function(err){return deferred.reject(err)}):deferred.resolve(),deferred}}}},242:function(module,__webpack_exports__,__webpack_require__){"use strict";function _nativeBind(el,name,cb){return el.addEventListener(name,cb,!1),function(){return el.removeEventListener(name,cb,!1)}}var __WEBPACK_IMPORTED_MODULE_0__utils_index__=__webpack_require__(23);__webpack_exports__.a={inserted:function(el){},bind:function(el,binding){var _mover={reposition:function(){if(void 0!==_mover.vw&&el){var styleTextArr=el.style.cssText.split(";");styleTextArr=styleTextArr.filter(function(item){var str=item.trim();return!(str.startsWith("left")||str.startsWith("top")||str.startsWith("right")||str.startsWith("bottom"))}),el.style.cssText=styleTextArr.join(";"),delete _mover.x,delete _mover.y}}},_opts={};try{_opts=JSON.parse(binding.value)}catch(e){}var defaultOpts={boundary:10,viewport:"parent"};_mover.options=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_0__utils_index__.a)(defaultOpts,_opts),_mover.detachStart=_nativeBind(el,"touchstart",function(e){var evt=e.changedTouches[0];_mover.x1=evt.clientX,_mover.y1=evt.clientY;var container=el.parentNode;if("body"===_mover.options.viewport&&(container=document.body),_mover.viewport=container.getBoundingClientRect(),void 0===_mover.x){var rect=el.getBoundingClientRect();_mover.x=rect.left,_mover.y=rect.top,_mover.width=rect.width,_mover.height=rect.height}_mover.detachMove=_nativeBind(el,"touchmove",function(e){var evt=e.changedTouches[0],dx=evt.clientX-_mover.x1,dy=evt.clientY-_mover.y1;if(e.preventDefault(),!_mover.running){if(Math.sqrt(dx*dx+dy*dy)<5)return;_mover.running=!0}var x=_mover.x+dx,y=_mover.y+dy;x=Math.min(x,_mover.viewport.right-_mover.options.boundary-_mover.width),y=Math.min(y,_mover.viewport.bottom-_mover.options.boundary-_mover.height),x=Math.max(_mover.viewport.left+_mover.options.boundary,x),y=Math.max(_mover.viewport.top+_mover.options.boundary,y),_mover.x2=x,_mover.y2=y,el.style.cssText="top:"+y+"px;left:"+x+"px"}),_mover.detachEnd=_nativeBind(el,"touchend",function(e){_mover.running&&(_mover.x=_mover.x2,_mover.y=_mover.y2,_mover.running=!1),_mover.detachMove(),_mover.detachEnd(),_mover.detachMove=_mover.detachEnd=null}),el.dataset._mover=_mover,el.reposition=_mover.reposition})},componentUpdated:function(el){console.log("dragger update"),el.dataset._mover&&(el.dataset._mover.reposition&&el.dataset._mover.reposition(),el.reposition=el.dataset._mover.reposition)},unbind:function(el){el.dataset._mover.detachMove&&el.dataset._mover.detachMove(),el.dataset._mover.detachEnd&&el.dataset._mover.detachEnd(),el.dataset._mover.detachStart&&el.dataset._mover.detachStart(),el.dataset._mover=null,el.reposition=null}}},243:function(module,__webpack_exports__,__webpack_require__){"use strict";function injectStyle(ssrContext){__webpack_require__(246)}var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_custom_vue__=__webpack_require__(228),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_091ab7e2_hasScoped_true_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_custom_vue__=__webpack_require__(248),normalizeComponent=__webpack_require__(42),__vue_styles__=injectStyle,Component=normalizeComponent(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_custom_vue__.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_091ab7e2_hasScoped_true_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_custom_vue__.a,!1,__vue_styles__,"data-v-091ab7e2",null);__webpack_exports__.a=Component.exports},244:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Event});var Event=function(){return function(){var _listen,_trigger,_remove,_create,_shift=(Array.prototype.slice,Array.prototype.shift),_unshift=Array.prototype.unshift,namespaceCache={},each=function(ary,fn){for(var ret,i=0,l=ary.length;i<l;i++){var n=ary[i];ret=fn.call(n,i,n)}return ret};return _listen=function(key,fn,cache){cache[key]||(cache[key]=[]),cache[key].push(fn)},_remove=function(key,cache,fn){if(cache[key])if(fn)for(var i=cache[key].length;i>=0;i--)cache[key][i]===fn&&cache[key].splice(i,1);else cache[key]=[]},_trigger=function(){var cache=_shift.call(arguments),key=_shift.call(arguments),args=arguments,_self=this,stack=cache[key];if(stack&&stack.length)return each(stack,function(){this.apply(_self,args)})},_create=function(namespace){var namespace=namespace||"default",cache={},offlineStack=[],ret={listen:function(key,fn,last){_listen(key,fn,cache),null!==offlineStack&&("last"===last?offlineStack.length&&offlineStack.pop()():each(offlineStack,function(){this()}),offlineStack=null)},one:function(key,fn,last){_remove(key,cache),this.listen(key,fn,last)},remove:function(key,fn){_remove(key,cache,fn)},trigger:function(){var fn,args,_self=this;return _unshift.call(arguments,cache),args=arguments,fn=function(){return _trigger.apply(_self,args)},offlineStack?offlineStack.push(fn):fn()}};return namespace?namespaceCache[namespace]?namespaceCache[namespace]:namespaceCache[namespace]=ret:ret},{create:_create,one:function(key,fn,last){this.create().one(key,fn,last)},remove:function(key,fn){this.create().remove(key,fn)},listen:function(key,fn,last){this.create().listen(key,fn,last)},trigger:function(){this.create().trigger.apply(this,arguments)}}}()}()},245:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__=__webpack_require__(218),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_2__Observer_js__=__webpack_require__(244);__webpack_exports__.a={messageData:{},modifyFeld:{},parentObject:{},privateMessage:{},privateMessageArr:{},messageArr:{},formdata:{},adaptation:function(option){var messageData=option.messageData,privateMessage=option.privateMessage,modifyFeld=option.modifyFeld,parentObject=option.parentObject,message=option.message,formdata=option.formdata;this.messageData[privateMessage.id]=messageData,this.modifyFeld[privateMessage.id]=modifyFeld,this.parentObject[privateMessage.id]=parentObject,this.privateMessage=privateMessage,this.privateMessageArr[privateMessage.id]=privateMessage,this.messageArr[privateMessage.id]=message,this.formdata[privateMessage.id]=formdata},addEventLis:function(obj,callback){__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(obj).map(function(thisItem,thisIndex){var newValue=obj[thisItem];return __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_define_property___default()(obj,thisItem,{get:function(){return newValue},set:function(value){newValue=value,callback()}})})},childrenGetData:function(privateId){var modifyFeld=this.modifyFeld,messageData=this.messageData,returnData={};return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(messageData[privateId]).forEach(function(item,index){-1!==modifyFeld[privateId].indexOf(item)&&(returnData[item]=messageData[privateId][item])}),returnData.formdata=this.formdata[privateId],returnData},childrenSetData:function(callbackObj,privateId){var _this=this;__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(callbackObj).forEach(function(callbackItem,callbackIndex){"formdata"!==callbackItem&&(_this.messageData[privateId][callbackItem]=callbackObj[callbackItem])})},parentGetData:function(privateId){return this.messageData[privateId]},childrenGetPrivateMessage:function(privateId){return this.privateMessageArr[privateId]},sendModifyHeight:function(privateId,num){this.messageArr[privateId].height=num},ObserverEvent:__WEBPACK_IMPORTED_MODULE_2__Observer_js__.a,backCallApi:function(name,callback,payload){this.ObserverEvent.trigger("externalCallApi",{privateId:payload.privateId,data:{action:name,callback:callback,validation:payload.validation}})},manipulateForm:function(payload){var privateId=payload.privateId,data=payload.data,callback=payload.callback;this.ObserverEvent.trigger("externalManipulateForm",{privateId:privateId,data:data,callback:callback})},backfillFormControlData:function(payload,privateId){this.ObserverEvent.trigger("externalFillNormalField",{privateId:privateId,data:payload})},backfillFormAttachment:function(payload,privateId){this.ObserverEvent.trigger("externalFillAttachField",{privateId:privateId,data:payload})}}},246:function(module,exports){},247:function(module,exports){},248:function(module,__webpack_exports__,__webpack_require__){"use strict";var render=function(){var _vm=this,_h=_vm.$createElement;return(_vm._self._c||_h)("div",{staticClass:"custom-widget-wrapper",attrs:{id:_vm.channelId}})},staticRenderFns=[],esExports={render:render,staticRenderFns:staticRenderFns};__webpack_exports__.a=esExports},249:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__=__webpack_require__(211),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_toConsumableArray__=__webpack_require__(212),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_toConsumableArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_toConsumableArray__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_slicedToArray__=__webpack_require__(226),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_slicedToArray___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_slicedToArray__),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_4_vue__=__webpack_require__(7),__WEBPACK_IMPORTED_MODULE_5_form_widget__=__webpack_require__(46),__WEBPACK_IMPORTED_MODULE_6__components_navbar_navbar_vue__=__webpack_require__(266),__WEBPACK_IMPORTED_MODULE_7__components_footers_footers_vue__=__webpack_require__(225),__WEBPACK_IMPORTED_MODULE_8__components_formson_formson_vue__=__webpack_require__(265),__WEBPACK_IMPORTED_MODULE_9__utils_bridge__=__webpack_require__(208),__WEBPACK_IMPORTED_MODULE_10__business_utils_native__=__webpack_require__(223),__WEBPACK_IMPORTED_MODULE_11__components_custom_custom_vue__=__webpack_require__(243),__WEBPACK_IMPORTED_MODULE_12__utils_tools__=__webpack_require__(215),__WEBPACK_IMPORTED_MODULE_14__mixins_form_load__=(__webpack_require__(205),__webpack_require__(255)),__WEBPACK_IMPORTED_MODULE_15__mixins_form_store__=__webpack_require__(221),__WEBPACK_IMPORTED_MODULE_16__business_mixins_form_save__=__webpack_require__(220),__WEBPACK_IMPORTED_MODULE_17__business_mixins_form_util__=__webpack_require__(222),__WEBPACK_IMPORTED_MODULE_18__business_mixins_form_calculate__=__webpack_require__(219),__WEBPACK_IMPORTED_MODULE_19__business_mixins_form_external__=__webpack_require__(241),__WEBPACK_IMPORTED_MODULE_20__business_mixins_form_formson__=__webpack_require__(216),__WEBPACK_IMPORTED_MODULE_21__business_mixins_formmain_event__=__webpack_require__(256),__WEBPACK_IMPORTED_MODULE_22__utils_index__=__webpack_require__(23),__WEBPACK_IMPORTED_MODULE_23__business_utils_service__=__webpack_require__(209),__WEBPACK_IMPORTED_MODULE_24__assets_js_api__=__webpack_require__(43),__WEBPACK_IMPORTED_MODULE_25__utils_dragger_js__=__webpack_require__(242);__WEBPACK_IMPORTED_MODULE_4_vue__.default.use(__WEBPACK_IMPORTED_MODULE_5_form_widget__.default),__WEBPACK_IMPORTED_MODULE_4_vue__.default.use(__WEBPACK_IMPORTED_MODULE_5_form_widget__.Cap4Eg),__WEBPACK_IMPORTED_MODULE_4_vue__.default.use(__WEBPACK_IMPORTED_MODULE_5_form_widget__.Cap4SelectContentImage),__WEBPACK_IMPORTED_MODULE_4_vue__.default.use(__WEBPACK_IMPORTED_MODULE_5_form_widget__.Cap4SelectContent),__WEBPACK_IMPORTED_MODULE_4_vue__.default.use(__WEBPACK_IMPORTED_MODULE_5_form_widget__.Cap4BaseActionsheet),__WEBPACK_IMPORTED_MODULE_4_vue__.default.use(__WEBPACK_IMPORTED_MODULE_5_form_widget__.Cap4BaseBrowserSupport),__webpack_exports__.a={name:"FormBody",mixins:[__WEBPACK_IMPORTED_MODULE_14__mixins_form_load__.a,__WEBPACK_IMPORTED_MODULE_15__mixins_form_store__.a,__WEBPACK_IMPORTED_MODULE_16__business_mixins_form_save__.a,__WEBPACK_IMPORTED_MODULE_17__business_mixins_form_util__.a,__WEBPACK_IMPORTED_MODULE_19__business_mixins_form_external__.a,__WEBPACK_IMPORTED_MODULE_20__business_mixins_form_formson__.a,__WEBPACK_IMPORTED_MODULE_18__business_mixins_form_calculate__.a,__WEBPACK_IMPORTED_MODULE_21__business_mixins_formmain_event__.a],components:{Navbar:__WEBPACK_IMPORTED_MODULE_6__components_navbar_navbar_vue__.a,Footers:__WEBPACK_IMPORTED_MODULE_7__components_footers_footers_vue__.a,Formson:__WEBPACK_IMPORTED_MODULE_8__components_formson_formson_vue__.a,CustomPrefix:__WEBPACK_IMPORTED_MODULE_11__components_custom_custom_vue__.a},directives:{dragger:__WEBPACK_IMPORTED_MODULE_25__utils_dragger_js__.a},data:function(){return{type:"",store:{meta:{},formmains:{},formsons:{},relations:{},viewIndex:"9",formson:null},dbData:{data:{},formmains:{},formsons:{},flowParam:{},relationSelector:{},pageParams:{},viewIndex:"0",formsonData:null},isDataReady:!1,touchPoint:{},contentScrollState:!0,sentChangeViewEvent:null}},computed:{currentFormData:function(){return{rawData:this.dbData.data,formmains:this.dbData.formmains,formsons:this.dbData.formsons}},currentFormMeta:function(){return{tableCategory:"formmain",tableName:__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(this.dbData.formmains)[0]}}},watch:{dbData:function(){var _this=this;this.$nextTick(function(){var body=_this.$refs.body,isInitial=!_this._isInited;_this._isInited=!0;var _dbData=_this.dbData,invalidation=_dbData.invalidation,scrollY=_dbData.scrollY,data=_dbData.data,isInComment=location.href.indexOf("/details/comment.html")>-1;if(_this.dbData.invalidation=null,!isInComment&&invalidation)_this.consumeInvalidation(invalidation);else if(body){body.scrollTop=scrollY||0;var guard=_this.$refs.guard,cls=["layout-guard"];cls.push(/-odd/i.test(guard.className)?"turn-even":"turn-odd"),guard.className=cls.join(" ")}isInitial&&(__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_24__assets_js_api__.c)(_this),_this.emitForm("rendered",{metadata:data})),_this.emitForm("updated")}),!this._isFlow&&__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.c(function(){document.title=_this.dbData.data.formInfo.formName})}},created:function(){var _this2=this,query=__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.A()||{},forward=__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.b()||{},params=forward.params;this._isInited=!1,this._isFormmain=!0,this._isPreview=!!query.formId,this._isUnflow=!!params&&(!params.moduleType||"42"===params.moduleType),this._isFlow=!this._isUnflow,this._formainQuery=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_22__utils_index__.b)(!0,query),this._formainParam=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_22__utils_index__.b)(!0,forward),this._operateMap={0:"new",1:"edit",2:"browse"},this._skipCalculate=!1,this._mover={reposition:function(){if(void 0!==_this2._mover.vw&&_this2.$refs.formSwitcher){var _mover=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_slicedToArray___default()(_this2._mover,2),x=_mover[0],y=_mover[1],vw=window.innerWidth,vh=window.innerHeight;_this2._mover.vw=vw,_this2._mover.vh=vh,_this2._mover.x=x=Math.min(x,vw-54),_this2._mover.y=x=Math.min(y,vh-54),_this2.$refs.formSwitcher.style.cssText="top:"+y+"px;left:"+x+"px"}}},this.dbData.pageParams=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_22__utils_index__.b)(!0,forward),window.xform=this},mounted:function(){var _this3=this;this.browserSupport(),this.initFormmainEvent(),this.preventClickWhenPreview(),this.loadForm(),cmp.event.orientationChange(function(){_this3._mover.reposition(),_this3.$refs.qrScan&&_this3.$refs.qrScan.reposition&&_this3.$refs.qrScan.reposition()})},destroyed:function(){this._mover.detachMove&&this._mover.detachMove(),this._mover.detachEnd&&this._mover.detachEnd()},render:function(){return this.renderFrame()},beforeUpdate:function(){console.time("[Patch]")},updated:function(){console.timeEnd("[Patch]")},methods:{preventClickWhenPreview:function(){this._isPreview&&(document.addEventListener("click",function(e){e.stopPropagation()},!0),document.addEventListener("tap",function(e){e.stopPropagation()},!0))},browserSupport:function(){return!!navigator.userAgent.includes("WebKit")||(this.$cap4BrowserSupport({text:"\u60a8\u7684\u6d4f\u89c8\u5668\u6682\u4e0d\u652f\u6301<br>\u5efa\u8bae\u5728Google Chrome\u6d4f\u89c8\u5668\u4e0b\u8bbf\u95ee"}),!1)},getBaseStyles:function(){var data=this.dbData.data;if(!data.viewInfo||!data.viewInfo.viewContent.skin)return{};if(this._baseInfo)return this._baseInfo;var defaultSkin=data.viewInfo.viewContent.skin.defs,defaultBg="",fBg="";return defaultSkin.view.bgUrl?(defaultBg=__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.a()+"/seeyon/common/cap4/design/"+defaultSkin.view.bgUrl.substr(2,defaultSkin.view.bgUrl.length-2),fBg=-1===defaultSkin.view.bgUrl.indexOf("/seeyon")?defaultSkin.view.bgColor+" url("+defaultBg+") no-repeat center center":defaultSkin.view.bgColor+" url("+__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.a()+defaultSkin.view.bgUrl+") no-repeat center center"):fBg=defaultSkin.view.bgColor,this._baseInfo={formHeaderBg:""+defaultSkin.head.backgroundColor,formHeaderColor:""+defaultSkin.head.color,formNavBg:defaultSkin.nav?""+defaultSkin.nav.backgroundColor:"",formFooterBg:defaultSkin.nav?""+defaultSkin.nav.backgroundColor:"",formFooterColor:"",formBg:fBg,fieldLine:"1px solid "+defaultSkin.divider.backgroundColor,fieldBg:""+defaultSkin.widget.box.backgroundColor,fieldTitleDefaultColor:""+defaultSkin.widget.label.color,fieldValueDefaultColor:""+defaultSkin.widget.body.color,isNotNullBg:""+defaultSkin.required.backgroundColor,placeholderColor:""+defaultSkin.widget.placeholder.color,formsonTiTleBorder:"1px solid "+defaultSkin.formson.head.borderColor,formsonArrowColor:""+defaultSkin.formson.arrow.color,formsonBg:""+defaultSkin.formson.snap.box.backgroundColor,formsonBorder:"1px solid "+defaultSkin.formson.snap.box.borderColor,formsonTitle:""+defaultSkin.formson.snap.label.color,formsonValue:""+defaultSkin.formson.snap.body.color}},changeView:function(id,index){var _this4=this,params=this.dbData.pageParams.params;__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.d("\u6570\u636e\u52a0\u8f7d\u4e2d..."),this.saveToServer("save",!0,function(){params.currentRightId=id,_this4.dbData.viewIndex=index,_this4.dbData.scrollY=0,_this4.loadFormData("switchView",params,function(){__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g()},!0),_this4.sentChangeViewEvent&&_this4.sentChangeViewEvent({index:index})},null,params.moduleType,!0,{needCheckRule:"0",needDataUnique:"0",needSn:"0"})},removeSessionFormCache:function(state){var content=this.dbData.data.content,storeKey=this._buildStoreKey();if(sessionStorage.removeItem(storeKey),!content&&state)return __WEBPACK_IMPORTED_MODULE_9__utils_bridge__.f();var cb=function(){return state&&__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.f()};__WEBPACK_IMPORTED_MODULE_23__business_utils_service__.i(content.contentDataId).then(cb,cb)},onWrapperTouchStart:function(e){this.touchPoint={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}},onWrapperMove:function(e){var directionY=this.touchPoint.y-e.changedTouches[0].clientY,wrapper=document.querySelector(".cap4-formBody__wrapper");if(wrapper&&this.onDetailPageScroll){var scrollTop=wrapper.scrollTop;directionY>0?this.onDetailPageScroll(scrollTop,1):directionY<0&&this.onDetailPageScroll(scrollTop,-1)}this.touchPoint={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY}},renderFrame:function(){var h=this.$createElement;if(this.isDataReady)return h("section",{attrs:{id:"cap4Form"},class:"cap4-formBody__index",style:{background:this.getBaseStyles().formBg,backgroundSize:"cover"}},[this.renderHeader(),this.renderNavbar(),this.renderWrapper(),this.renderFooter(),this.renderQRCode()])},renderQRCode:function(){var h=this.$createElement;if(!this._isPreview&&this.dbData.data.content.allowQRScan)return h("div",{class:"icon CAP cap-icon-saoyisao form-qr-scan",ref:"qrScan",on:{tap:this.scanQRCode},directives:[{name:"dragger",value:!0}]})},renderHeader:function(){var h=this.$createElement;if(!(this._isPreview||this._isFlow||parseInt(this.dbData.data.viewInfo.pcViewCount)<1))return h("div",{class:"icon CAP cap-icon-switch-light-form form-switcher",ref:"formSwitcher",on:{tap:this.switchForm,touchstart:this.onSwitcherTouch}})},renderNavbar:function(){var h=this.$createElement,data=this.dbData.data;if(data.views&&data.views.length>1){var baseInfo=this.getBaseStyles();return h(__WEBPACK_IMPORTED_MODULE_6__components_navbar_navbar_vue__.a,{attrs:{indexParam:this.dbData.viewIndex,type:this.type,data:data.views,bg:baseInfo.formFooterBg,color:baseInfo.fieldTitleDefaultColor,border:baseInfo.fieldLine},on:{changeView:this.changeView}})}},renderWrapper:function(){var h=this.$createElement;return h("div",{class:"cap4-formBody__wrapper",ref:"body",on:{touchstart:this.onWrapperTouchStart,touchmove:this.onWrapperMove}},[this.renderEg(),this.renderContainer(),h("div",{class:"layout-guard turn-odd",ref:"guard"})])},renderEg:function(){var h=this.$createElement;if("1"===this.dbData.data.formInfo.isEg)return h("div",{class:"cap4-formBody__eg"},[h(__WEBPACK_IMPORTED_MODULE_5_form_widget__.Cap4Eg,{attrs:{fontSize:35,arrowSize:50,type:1}})])},renderContainer:function(){var _this5=this,h=this.$createElement,_dbData2=this.dbData,formmains=_dbData2.formmains,data=_dbData2.data,viewInfo=data.viewInfo,tableInfo=data.tableInfo,elements=viewInfo.viewContent.children||[];return h("div",{class:"cap4-formBody__container"},[elements.map(function(item){var data=formmains[tableInfo.formmain.tableName][item.id];return h("div",{attrs:{id:item.id?"master|"+item.id:""+item.tableName},key:item.id},[_this5.renderComponents(item,data)])})])},renderFooter:function(){var h=this.$createElement;if(!this._isPreview&&!this._isFlow){var baseInfo=this.getBaseStyles();return h(__WEBPACK_IMPORTED_MODULE_7__components_footers_footers_vue__.a,{attrs:{type:this.type,bg:baseInfo.formNavBg},on:{saveFormData:this.saveToServer}})}},renderComponents:function(item,data){var h=this.$createElement;switch(item.ctrlType){case"MbFormson":return h(__WEBPACK_IMPORTED_MODULE_8__components_formson_formson_vue__.a,{attrs:{styles:this.getBaseStyles(),frontTableName:item.tableName,visibleItem:this.formsonVisibleItem,content:this.dbData.data.content,formson:this.dbData.formsons[item.tableName]},on:{formsonEvent:this.formsonEvent},key:item.tableName});case"suiStatic":return h("section",{style:data.extra},[h("pre",[data.display])]);case"suiLabel":return h("cap4-link",{attrs:{data:data},on:{linkEvent:this.linkUrl}});case"suiLogo":return h("cap4-link-image",{attrs:{data:data},on:{linkImageEvent:this.linkImageUrl}});case"suiLineGap":return h("cap4-interval",{attrs:{data:data}});case"suiCustomControl":return h("custom-prefix",{attrs:{data:data,formdata:this.currentFormData,formDetails:this.currentFormMeta,formStore:this.dbData},on:{externalManipulateForm:this.handleExternalManipulateForm,externalCallApi:this.handleExternalCallApi,externalFillNormalField:this.handleExternalFillNormalField,externalFillAttachField:this.handleExternalFillAttachField}});default:switch(data.inputType){case"text":if("VARCHAR"===data.fieldType)return h("cap4-text",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,linkEvent:this.linkUrl}});if("DECIMAL"===data.fieldType)return h("cap4-number",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation}});break;case"textarea":return h("cap4-textarea",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,textAreaAddContent:this.textAreaAddContent,linkEvent:this.linkUrl}});case"checkbox":return h("cap4-checkbox",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation}});case"radio":return h("cap4-radio",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation}});case"date":return h("cap4-date",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,selectTime:this.timeEvent}});case"datetime":return h("cap4-datetime",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,selectTime:this.timeEvent}});case"select":return h("cap4-select",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,selectEvent:this.selectEvent}});case"member":case"multimember":return h("cap4-choose-people",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,chooseOrganize:this.organizeEvent}});case"post":case"multipost":return h("cap4-choose-post",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,chooseOrganize:this.organizeEvent}});case"department":case"multidepartment":return h("cap4-choose-department",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,chooseOrganize:this.organizeEvent}});case"account":case"multiaccount":return h("cap4-choose-company",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,chooseOrganize:this.organizeEvent}});case"level":case"multilevel":return h("cap4-choose-duty",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,chooseOrganize:this.organizeEvent}});case"image":return h("cap4-images",{attrs:{data:data},on:{calculate:this.calculate,imagesEvent:this.imagesEvent}});case"attachment":return h("cap4-attachment",{attrs:{data:data},on:{calculate:this.calculate,attachmentEvent:this.attachmentEvent}});case"maplocate":return h("cap4-location",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,locationEvent:this.location}});case"mapphoto":return h("cap4-photo-location",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,photoEvent:this.photoEvent}});case"mapmarked":return h("cap4-location-mark",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,markEvent:this.markEvent}});case"document":return h("cap4-relation-doc",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,documentEvent:this.documentEvent}});case"imageradio":return h("cap4-radio-image",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation}});case"imageselect":return h("cap4-select-image",{attrs:{data:data},on:{calculate:this.calculate,relation:this.relation,selectImageEvent:this.selectImageEvent}});case"flowdealoption":return h("cap4-flow",{attrs:{data:data},on:{calculate:this.calculate}})}}},onSwitcherTouch:function(e){var _this6=this,evt=e.changedTouches[0];e.preventDefault(),this._mover.x1=evt.clientX,this._mover.y1=evt.clientY,this._mover.vw=window.innerWidth,this._mover.vh=window.innerHeight,void 0===this._mover.x&&(this._mover.x=this._mover.vw-10-44,this._mover.y=60),this._mover.detachMove=this._nativeBind(document,"touchmove",function(e){var evt=e.changedTouches[0],dx=evt.clientX-_this6._mover.x1,dy=evt.clientY-_this6._mover.y1;if(e.preventDefault(),!_this6._mover.running){if(Math.sqrt(dx*dx+dy*dy)<5)return;_this6._mover.running=!0}var x=_this6._mover.x+dx,y=_this6._mover.y+dy;x=Math.min(x,_this6._mover.vw-54),y=Math.min(y,_this6._mover.vh-54),x=Math.max(10,x),y=Math.max(10,y),_this6._mover.x2=x,_this6._mover.y2=y,_this6.$refs.formSwitcher.style.cssText="top:"+y+"px;left:"+x+"px"}),this._mover.detachEnd=this._nativeBind(document,"touchend",function(e){_this6._mover.running&&(_this6._mover.x=_this6._mover.x2,_this6._mover.y=_this6._mover.y2,_this6._mover.running=!1),_this6._mover.detachMove(),_this6._mover.detachEnd(),_this6._mover.detachMove=_this6._mover.detachEnd=null})},_nativeBind:function(el,name,cb){return el.addEventListener(name,cb,!1),function(){return el.removeEventListener(name,cb,!1)}},initFormsonVisibleItem:function(data){data=data.children||[];var result={};data.forEach(function(viewEl){var tableName=viewEl.tableName,ctrlType=viewEl.ctrlType,mobileFields=viewEl.mobileFields;"MbFormson"==ctrlType&&(result[tableName]||(result[tableName]={}),mobileFields.forEach(function(key){return result[tableName][key]=key}))}),this.formsonVisibleItem=result},imagesBrowser:function(urls,index){__WEBPACK_IMPORTED_MODULE_10__business_utils_native__.d(urls,index)},filesBrowser:function(files,index){__WEBPACK_IMPORTED_MODULE_10__business_utils_native__.e(files,index)},scanQRCode:function(){var _this7=this;__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.y(function(err,result){if(err)return __WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"alert",title:"",text:"\u626b\u63cf\u4e8c\u7ef4\u7801\u5931\u8d25",buttons:["\u786e\u5b9a"]});var data=null;try{data=JSON.parse(result.text)}catch(e){}data&&"cap4form"===data.codeType?_this7.saveToServer("save",!0,function(){__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.d("\u626b\u7801\u4e2d...");var payload={formId:_this7.dbData.data.content.contentTemplateId,dataId:_this7.dbData.data.content.contentDataId,moduleId:_this7.dbData.data.content.moduleId,rightId:_this7.dbData.data.content.rightId,recordId:"0",tableName:"",content:result.text};__WEBPACK_IMPORTED_MODULE_23__business_utils_service__.g(payload).then(function(res){var _res$data=res.data,data=(_res$data.code,_res$data.data);__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g(),res.data.success?_this7._manipulateForm(data.tableData,null,function(){_this7.allFormCalculate()}):__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"alert",title:"",text:res.data.msg||"\u4e8c\u7ef4\u7801\u89e3\u7801\u5931\u8d25",buttons:["\u786e\u5b9a"]})},function(err){__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g(),__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.h(err.message||"\u4e8c\u7ef4\u7801\u89e3\u7801\u5931\u8d25","center",1500,0)})},null,_this7.dbData.pageParams.params.moduleType,!0,{needCheckRule:"0",needDataUnique:"0",needSn:"0"}):__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.h("\u6682\u4e0d\u652f\u6301\u6b64\u7c7b\u578b\u4e8c\u7ef4\u7801","center",1500,0)})},relation:function(opts,params){if(!this._isPreview){var DBKey=this._buildStoreKey(),type=opts.type,throughType=opts.throughType;if("icon"===type){var data={title:"\u5173\u8054\u5217\u8868",type:"browse",formType:"formmain",params:params,content:this.dbData.data.content,mergeData:this._buildSaveRequestParams("save",!0),DBKey:DBKey};this.openWebView("relation",data)}else if("value"===type){var id=params.id,relation=params.relation,relationData=params.relationData,triggerData=params.triggerData,rightId=void 0,moduleId=void 0,moduleType=void 0,payload=void 0;"relation"===throughType?(rightId="default_form_cap3"===relation.toVersion?relation.phoneView:this._buildRelationRightId(relation.pcView,relation.phoneView),moduleId=relationData.toMasterDataId||this.dbData.relationSelector[id].toMasterDataId,moduleType="6"===relation.toFormType?"42":relation.toFormType):"trigger"===throughType&&(rightId=this._buildRelationRightId(triggerData.pcView,triggerData.phoneView),moduleId=triggerData.toMasterDataId,moduleType="6"===triggerData.toFormType?"42":triggerData.toFormType),"1"===moduleType?(payload={summaryId:moduleId,operationId:rightId,openFrom:"formRelation"},window.summaryBO&&window.summaryBO.summary&&(payload.baseObjectId=window.summaryBO.summary.id,payload.baseApp="1")):payload="default_form_cap3"===relation.toVersion?{rightId:rightId,moduleType:moduleType,moduleId:moduleId,contentAllId:moduleId,showType:"browse",viewState:"2",version:"cap3"}:{formType:"formmain",type:"browse",params:{rightId:rightId,moduleId:moduleId,moduleType:moduleType,operateType:"2"}},moduleType?__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.i(payload):__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"warning",title:"",text:"\u8be5\u6761\u6570\u636e\u88ab\u5220\u9664",buttons:["\u786e\u5b9a"]})}}},navigate:function(field,url){},textAreaAddContent:function(params){if(!this._isPreview){var currentUser=this.dbData.data.user?this.dbData.data.user.name:"",currentTime=function(){return __WEBPACK_IMPORTED_MODULE_12__utils_tools__.a.systemTime()},base="["+currentUser+" "+currentTime()+"]";__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"prompt",subType:4,title:"\u8bf7\u8f93\u5165\u60a8\u8981\u8ffd\u52a0\u7684\u5185\u5bb9",placeholder:"",defaultValue:"",buttons:["\u53d6\u6d88","\u786e\u5b9a"],callback:function(index,val){if(1===index){var baseSize=base.length,maxLength=Number(params.fieldLength)-params.value.length-baseSize,obj={type:"correct",data:val};"LONGTEXT"!==params.fieldType&&(maxLength<=0?(obj.type="error_01",obj.data="\u8d85\u8fc7\u5b57\u6bb5\u6700\u5927\u957f\u5ea6\uff0c\u5df2\u7ecf\u65e0\u6cd5\u7ee7\u7eed\u8ffd\u52a0\u6587\u5b57\u4e86\uff01"):val.length>maxLength&&(obj.type="error_02",obj.data="\u8ffd\u52a0\u6587\u672c\u6700\u5927\u957f\u5ea6\uff1a"+3*maxLength+"\uff01\uff08\u4e2d\u82f1\u6587\u3001\u6570\u5b57\u5b57\u7b26\u90fd\u5360\u636e\u4e09\u4e2a\u5b57\u7b26\u7684\u957f\u5ea6\uff09")),"error_01"===obj.type||"error_02"===obj.type?__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"alert",title:"\u63d0\u793a\u6d88\u606f",text:obj.data,buttons:["\u786e\u5b9a"]}):(__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"close"}),""!==params.value&&(params.value+="\r\n"),params.value+=obj.data+"\r\n\t["+currentUser+" "+currentTime()+"]",params.value=params.value.replace(/\uD83C[\uDF00-\uDFFF]|\uD83D[\uDC00-\uDE4F]/g,""))}else __WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"close"})}})}},linkUrl:function(params){var _params$attrs=params.attrs,linkable=_params$attrs.linkable,linkUrl=_params$attrs.linkUrl;this._isPreview||linkable&&linkUrl&&__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.z(linkUrl)},linkImageUrl:function(params){this.linkUrl(params)},timeEvent:function(type,params){this._isPreview||__WEBPACK_IMPORTED_MODULE_10__business_utils_native__.a(type,params)},organizeEvent:function(type,params){this._isPreview||__WEBPACK_IMPORTED_MODULE_10__business_utils_native__.b(type,params)},documentEvent:function(type,params,index){this._isPreview||__WEBPACK_IMPORTED_MODULE_10__business_utils_native__.f({type:type,params:params,index:index,formData:this.dbData.data})},imagesEvent:function(type,params,index){this._isPreview||__WEBPACK_IMPORTED_MODULE_10__business_utils_native__.g({type:type,params:params,index:index,formData:this.dbData.data})},attachmentEvent:function(type,params,index){this._isPreview||__WEBPACK_IMPORTED_MODULE_10__business_utils_native__.h({type:type,params:params,index:index,formData:this.dbData.data})},location:function(type,params){this._isPreview||__WEBPACK_IMPORTED_MODULE_10__business_utils_native__.c(type,params)},photoEvent:function(type,params,index){this._isPreview||__WEBPACK_IMPORTED_MODULE_10__business_utils_native__.i({type:type,params:params,index:index,formData:this.dbData.data})},markEvent:function(type,params){this._isPreview||__WEBPACK_IMPORTED_MODULE_10__business_utils_native__.j(type,params)},selectImageEvent:function(params){var _this8=this;this.contentScrollState=!1;var sI=this.$cap4Selection({type:params.attrs.imgEnumFormat,data:params.enums,value:params.value,callback:function(type,result){if("complete"===type){if(!result)return sI.close(),void(_this8.contentScrollState=!0);params.value=result.id}sI.close(),_this8.contentScrollState=!0}})},selectEvent:function(params){var _this9=this;this.contentScrollState=!1;var sI=this.$cap4Select({data:params.enums,value:params.value,callback:function(type,result){if("complete"===type){if(!result)return sI.close(),void(_this9.contentScrollState=!0);params.value=result.id}sI.close(),_this9.contentScrollState=!0}})},showListButton:function(data){var _this10=this,options={copyRow:["\u590d\u5236\u5f53\u524d\u884c","copyFormson"],deleteRow:["\u5220\u9664\u5f53\u524d\u884c","deleteFormson"],deleteAllRow:["\u5220\u9664\u5168\u90e8","deleteAllFormson"]},menus=[];"1"===data.auth.add&&menus.push(options.copyRow),"1"===data.auth.delete&&(menus.push(options.deleteRow),menus.push(options.deleteAllRow));var buttons=menus.map(function(menu){return menu[0]});this.contentScrollState=!1;var action=this.$cap4Actionsheet({title:"",buttons:buttons,callback:function(index){if(index>-1){var _menus$index=__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_slicedToArray___default()(menus[index],2),actionName=(_menus$index[0],_menus$index[1]);_this10[actionName](data)}action.close(),_this10.contentScrollState=!0}})},formsonEvent:function(params){if(!this._isPreview)switch(params.type){case"showListButton":this.showListButton(params.params);break;case"toScrollElement":this.toScrollElement(params.tableName);break;case"switch":case"addMore":this.refreshScroll();break;case"imagesBrowser":this.imagesBrowser(params.urls,0);break;case"new":this.addFormson(params.formson);break;case"view":this.viewFormson(params.formson,params.record)}},addFormson:function(formson){var _this11=this;if(!this._isPreview){var tbName=formson.tableName,fieldInfo=formson.fieldInfo,frontTableName=formson.frontTableName,menus=[],_dbData$data$relation=this.dbData.data.relationButtons,relationButtons=void 0===_dbData$data$relation?{}:_dbData$data$relation;for(var props in fieldInfo)if(fieldInfo.hasOwnProperty(props)){var item=fieldInfo[props];item.relationInfo&&"1"===item.relationInfo.fillInRow&&menus.unshift({name:"insert",showName:""+item.relationInfo.buttonName,tbName:tbName,fieldInfo:item})}var buttons=relationButtons[tbName];if(buttons&&buttons.forEach(function(button){menus.unshift({name:"aggregate",showName:button.buttonName,tbName:tbName,param:button})}),menus.length){var params={state:!0,data:[{name:"new",showName:"\u65b0\u5efa\u660e\u7ec6",tbName:tbName}].concat(menus)},_buttons=[];params.data.forEach(function(v){return _buttons.push(v.showName)}),this.contentScrollState=!1;var action=this.$cap4Actionsheet({title:"",buttons:_buttons,callback:function(index){var done=function(){action.close(),_this11.contentScrollState=!0};if(-1===index)return done();var menuItem=params.data[index];if(0===index)return done(),_this11.newFormson(menuItem.tbName,frontTableName);if("insert"===menuItem.name){if(menuItem.fieldInfo.relationInfo.mainSelector){var _fieldInfo=menuItem.fieldInfo,relationSelector=_this11.dbData.relationSelector[_fieldInfo.relationInfo.mainSelector],mainName=_fieldInfo.relationInfo.mainSelectorDisplay;if(!relationSelector)return __WEBPACK_IMPORTED_MODULE_9__utils_bridge__.h("\u8bf7\u5148\u9009\u62e9"+mainName+"\uff01","center",1500,0);var selectedMasterDataId=relationSelector.toMasterDataId;selectedMasterDataId?_this11.openWebView("relation",{title:"\u5173\u8054\u5217\u8868",type:"browse",formType:"formInsert",params:_fieldInfo,content:_this11.dbData.data.content,tbName:params.data[index].tbName,frontTableName:frontTableName,selectedMasterDataId:selectedMasterDataId,DBKey:_this11._buildStoreKey()}):__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.h("\u8bf7\u5148\u9009\u62e9"+mainName+"\uff01","center",1500,0)}else _this11.openWebView("relation",{title:"\u5173\u8054\u5217\u8868",type:"browse",formType:"formInsert",params:params.data[index].fieldInfo,content:_this11.dbData.data.content,tbName:params.data[index].tbName,frontTableName:frontTableName,DBKey:_this11._buildStoreKey()});done()}else if("aggregate"===menuItem.name){var msg="3"===menuItem.type?"\u60a8\u786e\u8ba4\u8981"+menuItem.showName+"\u5f53\u524d\u660e\u7ec6\u8868\u5417\uff1f":menuItem.showName+"\u5c06\u5220\u9664\u660e\u7ec6\u8868"+_this11.dbData.formsons[frontTableName].display+"\u7684\u6570\u636e\u5e76\u91cd\u65b0\u586b\u5165\uff0c\u8bf7\u786e\u8ba4\u662f\u5426\u7ee7\u7eed\uff1f";__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"warning",title:"\u63d0\u793a\u6d88\u606f",text:msg,buttons:["\u53d6\u6d88","\u786e\u5b9a"],callback:function(index){if(1===index){var content=_this11.dbData.data.content,request={relationShipId:menuItem.param.relationShipId,formMasterId:content.contentDataId,formId:content.contentTemplateId,rightId:content.rightId,mergeData:_this11._buildSaveRequestParams("save",!0)};__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.d("\u5904\u7406\u4e2d..."),__WEBPACK_IMPORTED_MODULE_23__business_utils_service__.j(request).then(function(res){done(),__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g();var _res$data2=res.data,data=(_res$data2.code,_res$data2.data);data&&_this11._manipulateForm(data.tableData,{record:function(action,payload){var table=payload.table,records=payload.records;if("add"===action){var _table$records;table.records.splice(0),(_table$records=table.records).push.apply(_table$records,__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_toConsumableArray___default()(records))}}})},function(err){__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g(),__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.h("\u64cd\u4f5c\u5931\u8d25","center",1500,0)})}}})}}})}else this.newFormson(tbName,frontTableName)}},newFormson:function(tbName,frontTableName){var DBKey=this._buildStoreKey(),data={type:"new",title:this.getFormsonTitlte(tbName),params:{formMasterId:this.dbData.data.content.contentDataId,formId:this.dbData.data.content.contentTemplateId,tableName:tbName,recordIds:[""],type:"add",rightId:this.dbData.data.content.rightId},DBKey:DBKey,tableName:tbName,frontTableName:frontTableName,skinDefault:this.dbData.data.viewInfo.viewContent.skin.defs};this.openWebView("formson",data)},copyFormson:function(extra){var _this12=this,_dbData3=this.dbData,data=_dbData3.data,formsons=_dbData3.formsons,frontTableName=(_dbData3.relationSelector,extra.frontTableName),recordId=extra.recordId,index=extra.index,tableField=formsons[frontTableName],params={type:"copy",formMasterId:data.content.contentDataId,formId:data.content.contentTemplateId,tableName:tableField.tableName,recordIds:[recordId],rightId:data.content.rightId,mergeData:this._buildSaveRequestParams("save",!0)};__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.d("\u590d\u5236\u4e2d..."),__WEBPACK_IMPORTED_MODULE_23__business_utils_service__.b(params).then(function(res){var _res$data3=res.data,data=(_res$data3.code,_res$data3.data);__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g(),_this12._manipulateForm(data.tableData,{field:function(_field){_this12.copyFliterValue(_field)},record:function(action,payload){var table=payload.table,records=payload.records;if(console.log([action,payload]),"add"===action){var _table$records2;(_table$records2=table.records).splice.apply(_table$records2,[index+1,0].concat(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_toConsumableArray___default()(records))),_this12.emitForm("recordInserted",{recordId:records&&records.length>0?records[0].recordId:"",recordTable:tableField.tableName,frontTable:tableField.frontTableName})}}})},function(err){__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g(),__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.h("\u64cd\u4f5c\u5931\u8d25","center",1500,0)})},viewFormson:function(formson,record){var params=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_dbData4=this.dbData,data=_dbData4.data,tableName=(_dbData4.viewInfo,_dbData4.relationSelector,_dbData4.formmains,formson.tableName),frontTableName=formson.frontTableName,recordId=(formson.auth,record.recordId),lists=record.lists,listsIndex=record.listsIndex,formsonInitData=this.initFormSonFieldDatas(frontTableName),DBKey=this._buildStoreKey();formsonInitData.recordId=recordId,formsonInitData.lists=lists,formsonInitData.listsIndex=listsIndex;var winData=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({},params,{title:this.getFormsonTitlte(tableName),type:"browse"!==this.type?"edit":"browse",tableName:tableName,frontTableName:frontTableName,params:{formMasterId:data.content.contentDataId,formId:data.content.contentTemplateId,rightId:data.content.rightId},DBKey:DBKey,recordId:recordId,formsonInitData:formsonInitData,skinDefault:data.viewInfo.viewContent.skin.defs,userInfo:{name:data.user?data.user.name:""}});this.openWebView("formson",winData)},getFormsonTitlte:function(tbName){var formsons=this.dbData.formsons,title="";return __WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(formsons).some(function(v){if(formsons[v].tableName===tbName)return title=formsons[v].display}),title},clearRecordData:function(fieldInfo){__WEBPACK_IMPORTED_MODULE_3_babel_runtime_core_js_object_keys___default()(fieldInfo||{}).forEach(function(fieldId){var info=fieldInfo[fieldId];info&&(info.triggerData="",info.relationData="",info.valueId="",info.showValue="",info.value instanceof Array?info.value.splice(0):info.value="",info.attachmentInfo&&info.attachmentInfo.attachmentInfos instanceof Array&&info.attachmentInfo.attachmentInfos.splice(0),info.isCustomField&&info.customFieldInfo&&(info.customFieldInfo=null))})},deleteFormson:function(extra){var _this13=this,_dbData5=this.dbData,data=_dbData5.data,formsons=(_dbData5.viewInfo,_dbData5.relationSelector,_dbData5.formsons),frontTableName=extra.frontTableName;__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"warning",title:"\u63d0\u793a\u6d88\u606f",text:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u5f53\u524d\u8bb0\u5f55\u5417\uff1f",buttons:["\u53d6\u6d88","\u786e\u5b9a"],callback:function(index){if(1===index){var params={formMasterId:data.content.contentDataId,formId:data.content.contentTemplateId,tableName:formsons[frontTableName].tableName,recordIds:[extra.recordId],type:"delete",rightId:data.content.rightId,mergeData:_this13._buildSaveRequestParams("save",!0)};__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.d("\u5220\u9664\u4e2d..."),__WEBPACK_IMPORTED_MODULE_23__business_utils_service__.b(params).then(function(res){var _res$data4=res.data,data=(_res$data4.code,_res$data4.data);__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g(),_this13._manipulateForm(data.tableData,{record:function(action,payload){if(console.log([action,payload]),"delete"===action)_this13.emitForm("recordDeleted",{recordId:params.recordIds,recordTable:params.tableName,frontTable:frontTableName});else if("add"===action){var _table$records3,table=payload.table,records=payload.records;(_table$records3=table.records).unshift.apply(_table$records3,__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_toConsumableArray___default()(records))}_this13.refreshScroll()}})},function(err){__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g(),__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.h("\u64cd\u4f5c\u5931\u8d25","center",1500,0)})}}})},deleteAllFormson:function(extra){var _this14=this,_dbData6=this.dbData,data=_dbData6.data,formsons=(_dbData6.viewInfo,_dbData6.relationSelector,_dbData6.formsons),frontTableName=extra.frontTableName,recordIds=this.getRecordIds(frontTableName);__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"warning",title:"\u63d0\u793a\u6d88\u606f",text:"\u60a8\u786e\u8ba4\u8981\u5220\u9664\u8be5\u660e\u7ec6\u8868\u7684\u6240\u6709\u8bb0\u5f55\u5417\uff1f",buttons:["\u53d6\u6d88","\u786e\u5b9a"],callback:function(index){if(1===index){var params={formMasterId:data.content.contentDataId,formId:data.content.contentTemplateId,tableName:formsons[frontTableName].tableName,recordIds:recordIds,type:"delete",rightId:data.content.rightId,mergeData:_this14._buildSaveRequestParams("save",!0)};__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.d("\u5220\u9664\u4e2d..."),__WEBPACK_IMPORTED_MODULE_23__business_utils_service__.b(params).then(function(res){var _res$data5=res.data,data=(_res$data5.code,_res$data5.data);__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g(),_this14._manipulateForm(data.tableData,{record:function(action,payload){if(console.log([action,payload]),"delete"===action)_this14.emitForm("recordDeleted",{recordId:recordIds,recordTable:params.tableName,frontTable:frontTableName});else if("add"===action){var _table$records4,table=payload.table,records=payload.records;(_table$records4=table.records).unshift.apply(_table$records4,__WEBPACK_IMPORTED_MODULE_1_babel_runtime_helpers_toConsumableArray___default()(records))}_this14.refreshScroll()}})},function(err){__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.g(),__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.h("\u64cd\u4f5c\u5931\u8d25","center",1500,0)})}}})},getRecordIds:function(tbName){for(var ids=[],data=this.dbData.formsons[tbName].records,i=0;i<data.length;i++)ids.push(data[i].recordId);return ids},refreshScroll:function(){this.$nextTick(function(){})},toScrollElement:function(ele){this.$nextTick(function(){})},closeWebView:function(type){var _this15=this,done=function(){_this15.clearFromStore(),_this15.removeSessionFormCache(!0)};"close"===type?__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"warning",title:"",text:"\u60a8\u786e\u8ba4\u8981\u5173\u95ed\u5417\uff1f",buttons:["\u53d6\u6d88","\u786e\u5b9a"],callback:function(index){return 1===index&&done()}}):done()},openWebView:function(route,data,type){__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.j(route,data,type)},switchForm:function(){var _this16=this,dbData=this.dbData,_formainParam=this._formainParam,data=dbData.data,viewIndex=dbData.viewIndex,pageParams=dbData.pageParams,pcView=parseInt(data.viewInfo.pcViewCount)<1,done=function(){var url=__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.B.base+"/htmls/origin/form/index.html",param=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({},_formainParam,{formMasterId:dbData.data.content.contentDataId,indexParam:viewIndex,switchFrom:"light"});_this16.clearFromStore(),cmp.href.go(url,param)};this.assertEmptyView(!0,pcView)||(__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.d("\u4fdd\u5b58\u4e2d..."),this.saveToServer("save",!0,done,null,pageParams.params.moduleType,!0,{needCheckRule:"0",needDataUnique:"0",needSn:"0"}))},assertEmptyView:function(isPC,isEmpty,doCheck){var _this17=this,data=this.dbData.data||{},name=isPC?"\u7535\u8111":"\u79fb\u52a8";return isEmpty&&__WEBPACK_IMPORTED_MODULE_9__utils_bridge__.e({type:"warning",title:"",text:"\u5f53\u524d\u8868\u5355\u6ca1\u6709\u914d\u7f6e"+name+"\u7aef\u89c6\u56fe/\u5185\u5bb9\uff0c\u4e0d\u80fd\u8fdb\u884c\u76f8\u5173\u64cd\u4f5c",buttons:["\u786e\u5b9a"],callback:function(){if(doCheck){var isMultiView=data.views&&data.views.length>1;!isMultiView&&_this17._isUnflow?_this17.switchForm():isMultiView||_this17.closeWebView()}}}),isEmpty},emitForm:function(name,payload){__WEBPACK_IMPORTED_MODULE_24__assets_js_api__.b.$emit(name,payload),"rendered"!==name&&"updated"!==name&&__WEBPACK_IMPORTED_MODULE_24__assets_js_api__.b.$emit("updated",payload)}}}},252:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty__=__webpack_require__(224),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty__),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__=__webpack_require__(41),__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify__=__webpack_require__(44),__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_3__assets_js_config_js__=__webpack_require__(54),__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types__=__webpack_require__(210),__WEBPACK_IMPORTED_MODULE_7__business_mixins_form_formson__=(__webpack_require__(208),__webpack_require__(217),__webpack_require__(216));__webpack_exports__.a=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_defineProperty___default()({name:"Formson",mixins:[__WEBPACK_IMPORTED_MODULE_7__business_mixins_form_formson__.a],props:["visibleItem","formson","content","styles","frontTableName"],data:function(){return{FieldTypes:__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types__.a,mFilter:["attachment","mapmarked","mapphoto","linenumber"],pageSize:__WEBPACK_IMPORTED_MODULE_3__assets_js_config_js__.a.pageSize}},computed:{},directives:{equalHeight:{inserted:function(el){el.style.height=el.children[0].offsetHeight+"px"}}},components:{},methods:{getDisplayValue:function(fieldInfo){return fieldInfo.ctrlType.match(/^suiNumber|suiDate$/)?fieldInfo.showValue:fieldInfo.value},getImgStyle:function(url){return{background:'url("'+url+'") no-repeat center center',backgroundSize:"cover"}},filterFields:function(names,fields){var _this=this;return names.filter(function(name){var field=fields[name];return field&&"hide"!==field.auth&&!field.isCustomField&&!__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types__.a.auxiliary.includes(field.ctrlType)&&!_this.mFilter.includes(field.inputType)&&!__WEBPACK_IMPORTED_MODULE_4__business_utils_field_types__.a.file.includes(field.inputType)})},formatIndex:function(data){var arr=[],itemData={};this.visibleItem[this.formson.tableName]?itemData=this.visibleItem[this.formson.tableName]:this.visibleItem[this.formson.frontTableName]&&(itemData=this.visibleItem[this.formson.frontTableName]);for(var i in itemData)arr.push(itemData[i]);return 0==arr.length?data:arr},filterDisvisiable:function(item){var tbName=this.formson.tableName,frontTbName=this.formson.frontTableName;return!(!this.visibleItem[tbName]||!this.visibleItem[tbName][item])||(!(!this.visibleItem[frontTbName]||!this.visibleItem[frontTbName][item])||("{}"==__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default()(this.visibleItem[tbName])||"{}"==__WEBPACK_IMPORTED_MODULE_2_babel_runtime_core_js_json_stringify___default()(this.visibleItem[frontTbName])))},filterArray:function(arr,value){return arr.filter(function(v){return v.id===value})},getEnumsDisplay:function(enums,value){return value&&"0"!==value?this.filterArray(enums,value)[0].showValue:""},getFileDisplay:function(attachmentInfo){var result="";return attachmentInfo.attachmentInfos.length&&attachmentInfo.attachmentInfos.forEach(function(v){""!==result&&(result+="\u3001"),result+=v.filename}),result},getOrganizeDisplay:function(value){var result=[];value&&value.split(",").forEach(function(v){result.push({id:v.split("|")[0],name:v.split("|")[1]})});var nameStr="";return result.forEach(function(v){""!==nameStr&&(nameStr+="\u3001"),nameStr+=v.name}),nameStr},getCheckboxDisplay:function(value){var result="\u672a\u52fe\u9009";return"1"===value&&(result="\u52fe\u9009"),result},getRangeStyle:function(index){return"is-"+["one","two","three","four","five","six"][index%6]},formsonSwitch:function(state,tableName){this.formson.state=!state,this.$emit("formsonEvent",{type:"toScrollElement",tableName:tableName}),this.$emit("formsonEvent",{type:"switch"})},browseImages:function(url){this.$emit("formsonEvent",{type:"imagesBrowser",urls:url})},newFormson:function(tableName){this.$emit("formsonEvent",{type:"new",formson:this.formson})},viewFormson:function(record){this.$emit("formsonEvent",{type:"view",formson:this.formson,record:record})},operaRecord:function(recordId,frontTableName,index){var params={recordId:recordId,frontTableName:this.frontTableName,index:index,auth:this.formson.auth};this.$emit("formsonEvent",{type:"showListButton",params:params})},addMore:function(page){this.formson.page=page+1,this.$emit("formsonEvent",{type:"addMore"})}}},"computed",{isReadOnly:function(){var auth=this.formson.auth;return"1"!==auth.delete&&"1"!==auth.add},checkLine:function(){var _this2=this,line=!1;return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this.formson.records[0].lists).forEach(function(v){"linenumber"===_this2.formson.records[0].lists[v].inputType&&(line=!0)}),line}})},253:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={name:"navbar",props:["indexParam","type","data","bg","color","border"],data:function(){return{activeIndex:Number(this.indexParam)||0}},mounted:function(){this.$nextTick(function(){})},components:{},methods:{changeView:function(rightId,index){this.activeIndex!==index&&(this.activeIndex=index,this.$emit("changeView",rightId,index))}},computed:{}}},255:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__=__webpack_require__(211),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends__),__WEBPACK_IMPORTED_MODULE_1__utils_index__=__webpack_require__(23),__WEBPACK_IMPORTED_MODULE_2__utils_bridge__=__webpack_require__(208),__WEBPACK_IMPORTED_MODULE_3__business_utils_field_types__=__webpack_require__(210),__WEBPACK_IMPORTED_MODULE_4__business_utils_special__=__webpack_require__(214),__WEBPACK_IMPORTED_MODULE_5__business_utils_service__=__webpack_require__(209),getAuxilaryUid=function(el,tableName,index){var ctrlType=el.ctrlType||"$";return index=void 0===index?"$":index,"auxiliary_"+ctrlType+"_"+tableName+"_"+index};__webpack_exports__.a={methods:{loadForm:function(){var _this=this;__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.c(function(){_this._isUnflow?_this.loadUnflowForm():_this._isPreview?_this.loadPreviewForm():_this.loadFlowForm()})},loadFlowForm:function(){var _this2=this;cmp.sui||(console.info("unexpected script execute order, \nexpect app.cap4Form.js executes before formmain-chunk.cap4Form.js"),cmp.sui={_readyCallbacks:[],isReady:!1,ready:function(cb){if(cmp.sui.isReady)return cb();cmp.sui._readyCallbacks.push(cb)},fireReady:function(){var callbacks=cmp.sui._readyCallbacks.slice(0);delete cmp.sui._readyCallbacks,delete cmp.sui.fireReady,cmp.sui.isReady=!0,callbacks.forEach(function(cb){return cb&&cb()})}}),cmp.sui.switchForm=function(cb){var dbData=_this2.dbData,data=dbData.data,viewIndex=dbData.viewIndex,pageParams=dbData.pageParams,pcView=parseInt(data.viewInfo.pcViewCount)<1,done=function(){_this2.clearFromStore(),cb&&cb({formMasterId:data.content.contentDataId,switchFrom:"light",indexParam:viewIndex})};_this2.assertEmptyView(!0,pcView)||(__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.d("\u4fdd\u5b58\u4e2d..."),_this2.saveToServer("save",!0,done,null,pageParams.params.moduleType,!0,{needCheckRule:"0",needDataUnique:"0",needSn:"0"}))},cmp.sui.loadForm=function(options,fn){console.log("loadForm:",options,fn);var rightId=options.rightId,moduleId=options.moduleId,moduleType=options.moduleType,operateType=options.operateType,onChangeViewEvent=options.onChangeViewEvent,dbData=(options.indexParam,_this2.dbData);_this2.sentChangeViewEvent=onChangeViewEvent,_this2.onDetailPageScroll=options.onScroll,_this2.type=_this2._operateMap[operateType],dbData.flowParam=options,dbData.pageParams.params={rightId:rightId,moduleId:moduleId,moduleType:moduleType,operateType:operateType,formTemplateId:""},console.log("loadForm:",options),_this2.loadFormData("init",options,fn)},cmp.sui.loadFormDataFromCache=function(options){console.log("loadFormFromCache:",options);var callback=options.callback;_this2.getFromStore(options).then(function(storeData){_this2.processFormData("init",null,storeData),callback&&callback(!0)},function(){return callback&&callback(!1)})},cmp.sui.submit=function(options,fn,error){var notSaveDB=options.notSaveDB,needCheckRule=options.needCheckRule,needSn=options.needSn,checkNull=options.checkNull,pageParams=_this2.dbData.pageParams,performer={checkNull:checkNull?"1":"0",failed:error,success:fn},contentOpts={isMerge:notSaveDB?"1":"0",needCheckRule:!1===needCheckRule?"0":"1",needSn:needSn?"1":"0"};console.log("submit:",options),_this2.saveToServer("save",notSaveDB,function(){return console.log("form submit successfully")},performer,pageParams.params.moduleType,!1,contentOpts)},cmp.sui.getMainBodyData=function(key){return _this2.dbData.data.content[key]},cmp.sui.isPreventSubmit=function(){return!1},cmp.sui.hasEditRightOfFlowDealOption=function(){return!1},cmp.sui.clearCache=function(options){_this2.clearFromStore(options),_this2.removeSessionFormCache(!1)},cmp.sui.getFormProtectedData=function(useFieldIdAsKey,callback){var payload={formId:_this2.dbData.data.content.contentTemplateId,formMasterDataId:_this2.dbData.data.content.contentDataId,moduleId:_this2.dbData.data.content.moduleId,from:"lightForm",mergeData:_this2.dbData.pageParams.params&&"2"===_this2.dbData.pageParams.params.operateType?{}:_this2._buildSaveRequestParams("save",!0)};__WEBPACK_IMPORTED_MODULE_5__business_utils_service__.k(payload).then(function(res){var data=res.data.data;"function"==typeof callback&&callback(null,data||{})},function(err){"function"==typeof callback&&callback({message:"fetch data error!"},{})})},cmp.sui.fireReady()},loadUnflowForm:function(){this.type=this._formainParam.type,this.loadFormData("init")},loadPreviewForm:function(){var _formainQuery=this._formainQuery,dbData=this.dbData;this.type="new",dbData.pageParams.params={formId:_formainQuery.formId,viewId:_formainQuery.viewId},this.loadFormData("init")},loadFormData:function(type,opts,callback,forceFetch){var _this3=this,pageParams=this.dbData.pageParams;opts=opts||pageParams.params;var _opts=opts,summaryId=_opts.summaryId,storeKey=this._buildStoreKey(opts),isSwitched=!!pageParams.switchFrom,isFresh="1"!==sessionStorage.getItem(storeKey),deferred=new __WEBPACK_IMPORTED_MODULE_1__utils_index__.c;this.setCalculateLock(!0),deferred.then(function(){return _this3.setCalculateLock(!1)}),forceFetch||isSwitched||isFresh?(console.log(["[load from remote]:",forceFetch,isSwitched,isFresh]),this.fetchFormData(type).then(function(res){isFresh&&sessionStorage.setItem(storeKey,"1"),_this3.processFormData(type,res.data,null,summaryId),deferred.resolve(!0),callback&&callback()},function(){return callback&&callback()})):this.getFromStore(opts,!0).then(function(storeData){console.log(["[load from store]:"]),_this3.processFormData(type,null,storeData,summaryId),deferred.resolve(!0),callback&&callback()},function(){console.log(["[fetch data as no store]:",_this3.type]),_this3.fetchFormData(type).then(function(res){_this3.processFormData(type,res.data,null,summaryId),deferred.resolve(!0),callback&&callback()},function(err){callback&&callback(),console.log("\u8868\u5355\u6570\u636e\u52a0\u8f7d\u5931\u8d25",err)})})},fetchFormData:function(type){var _this4=this,deferred=new __WEBPACK_IMPORTED_MODULE_1__utils_index__.c,_dbData=this.dbData,data=_dbData.data,pageParams=_dbData.pageParams,payload=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default()({},pageParams.params,{from:"lightForm",formMasterId:"saveCopy"===type&&data.content?data.content.contentDataId:"saveNew"===type?"":pageParams.formMasterId||""}),hideLoading=function(){_this4._isUnflow&&"init"!==type&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.g()};return function(){_this4._isUnflow&&"init"!==type&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.d("\u6570\u636e\u52a0\u8f7d\u4e2d...")}(),deferred.then(hideLoading,function(reason){var message=reason&&reason.message;console.log("rejected:",reason),message||(message="\u8868\u5355\u6570\u636e\u52a0\u8f7d\u51fa\u9519",reason&&reason.code&&(message+="(code="+reason.code+")")),hideLoading(),__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.e({type:"warning",title:"\u63d0\u793a\u4fe1\u606f",text:message,buttons:["\u786e\u5b9a"],callback:function(){return __WEBPACK_IMPORTED_MODULE_2__utils_bridge__.f()}})}),console.time("\u8bf7\u6c42\u8868\u5355\u6570\u636e"),__WEBPACK_IMPORTED_MODULE_5__business_utils_service__.l(payload).then(function(res){console.timeEnd("\u8bf7\u6c42\u8868\u5355\u6570\u636e");var data=res.data;"2000"===data.code?deferred.resolve(data):deferred.reject(data)},function(err){return deferred.reject(err)}),deferred},processFormData:function(type,data,storeData,summaryId){var _this5=this;if(console.time("[processFormData]"),this.isDataReady=!1,storeData&&!data)this.dbData=storeData;else{var isEmpty=!data.viewInfo.viewContent,initProps={data:data,formsons:{},formmains:{}};if(data.viewInfo.viewContent?data.viewInfo.viewContent=JSON.parse(data.viewInfo.viewContent):data.viewInfo.viewContent={},"saveNew"===type&&(initProps.relationSelector={}),this.dbData=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.a)({},this.dbData,initProps),!isEmpty&&!data.viewInfo.viewContent.skin)return __WEBPACK_IMPORTED_MODULE_2__utils_bridge__.e({type:"warning",title:"\u63d0\u793a\u4fe1\u606f",text:"\u8868\u5355\u6570\u636e\u52a0\u8f7d\u51fa\u9519(\u8f7b\u8868\u5355\u8fd4\u56de\u4e86\u539f\u6837\u8868\u5355\u89c6\u56fe)",buttons:["\u786e\u5b9a"],callback:function(){return __WEBPACK_IMPORTED_MODULE_2__utils_bridge__.f()}});this._baseInfo=null,this.setRelationSelector(data.relationRecords)}var dbData=this.dbData;if(summaryId&&(dbData.data.content.moduleId=summaryId),this._isFlow&&dbData.data.content&&(dbData.data.content.allowQRScan=dbData.flowParam.allowQRScan),this.initFormsonVisibleItem(dbData.data.viewInfo.viewContent),data){var _dbData$data=dbData.data,tableInfo=_dbData$data.tableInfo,viewInfo=_dbData$data.viewInfo,formmains=dbData.formmains,formsons=dbData.formsons,viewRoot=viewInfo.viewContent.children||[];this.$set(formmains,tableInfo.formmain.tableName,{}),viewRoot.forEach(function(viewEl,viewIndex){"MbFormson"!==viewEl.ctrlType?_this5._processFormainRecord(viewIndex,viewEl):(_this5.$set(formsons,viewEl.tableName,{}),tableInfo.formson.forEach(function(tableField){if(tableField.frontTableName===viewEl.tableName){formsons[viewEl.tableName]={state:!0,frontTableName:viewEl.tableName,tableName:tableField.tableName,display:tableField.display,records:[],page:1,auth:viewInfo.authInfo[tableField.tableName],fieldInfo:tableField.fieldInfo},tableField.dataSubLineInfos.forEach(function(record,index){return _this5._processFormsonRecord(index,viewEl,tableField,record)}),formsons[viewEl.tableName].templateRecord=_this5.formatTemplate(formsons[viewEl.tableName].records[0]);var defaultRows=viewEl.defaultRows,records=formsons[viewEl.tableName].records;formsons[viewEl.tableName].records=_this5._setNullRecords(defaultRows,records)}}))}),this.assertEmptyView(!1,0===viewRoot.length,!0)}var _ref=dbData.data.content||{},formsonNumThreshold=_ref.formsonNumThreshold;formsonNumThreshold&&__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.e({type:"alert",title:"",text:"\u5355\u4e2a\u660e\u7ec6\u8868\u5df2\u8d85\u8fc7"+formsonNumThreshold+"\u6761\u6570\u636e\uff0c\u6b64\u8868\u5355\u53ea\u80fd\u6d4f\u89c8\u67e5\u770b\uff0c\u5982\u9700\u8981\u7f16\u8f91\uff0c\u8bf7\u4f7f\u7528\u7535\u8111\u7aef\u64cd\u4f5c",buttons:["\u786e\u5b9a"]}),this.isDataReady=!0,console.timeEnd("[processFormData]")},_processFormainRecord:function(index,viewEl){var _dbData$data2=this.dbData.data,tableInfo=_dbData$data2.tableInfo,viewInfo=_dbData$data2.viewInfo,formmains=this.dbData.formmains,tableName=tableInfo.formmain.tableName,elAttr=viewEl.attrs||{},isAuxilary=-1!==__WEBPACK_IMPORTED_MODULE_3__business_utils_field_types__.a.auxiliary.indexOf(viewEl.ctrlType),baseInfo=this.getBaseStyles();isAuxilary&&(viewEl.id=getAuxilaryUid(viewEl,tableName,index));var fieldData=tableInfo.formmain.fieldInfo[viewEl.id],authData=viewInfo.authInfo[viewEl.id],valueAndAuth=void 0,stdData={id:viewEl.id,type:viewEl.type,ctrlType:viewEl.ctrlType,placeHolder:elAttr.placeHolder,ctrlTitleStyle:elAttr.ctrlTitleStyle,radioAlignType:elAttr.radioAlignType,display:viewEl.display,extra:{base:viewEl.styles,fieldBg:baseInfo.fieldBg,fieldLine:baseInfo.fieldLine,fieldTitleDefaultColor:baseInfo.fieldTitleDefaultColor,fieldValueDefaultColor:baseInfo.fieldValueDefaultColor,isNotNullBg:baseInfo.isNotNullBg,placeholderColor:baseInfo.placeholderColor,fileBg:baseInfo.formsonBg},attrs:elAttr,formType:"formmain"};if(!elAttr.src||elAttr.src.startsWith("http")||elAttr.src.startsWith("https")||(elAttr.src=""+__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.a()+elAttr.src),isAuxilary||this._isPreview)valueAndAuth={valueId:"",value:"",showValue:"",attachmentInfo:{},enums:fieldData?fieldData.enums:[],isInCalculate:"",isInCondition:"",isAttachment:!!fieldData&&"1"===fieldData.isAttachment,isCustomField:!!fieldData&&"1"===fieldData.isCustomField,formatType:"",inputType:fieldData?fieldData.inputType:"",fieldType:fieldData?fieldData.fieldType:"",digitNum:"",fieldLength:"",relation:"",relationData:"",customFieldInfo:fieldData&&"1"===fieldData.isCustomField?fieldData.customFieldInfo:null,auth:"add",isNotNull:"0",isAuxilary:isAuxilary?"1":"0",isDataInvalid:"0"};else{var fieldLength="text"===fieldData.inputType&&"VARCHAR"===fieldData.fieldType||"textarea"===fieldData.inputType?Math.floor(fieldData.fieldLength/3):fieldData.fieldLength;valueAndAuth={valueId:fieldData.value,value:fieldData.showValue2,showValue:fieldData.showValue,attachmentInfo:fieldData.attachmentInfo,enums:fieldData.enums,isInCalculate:fieldData.isInCalculate,isInCondition:fieldData.isInCondition,isAttachment:"1"===fieldData.isAttachment,isCustomField:"1"===fieldData.isCustomField,formatType:fieldData.formatType,inputType:fieldData.inputType,fieldType:fieldData.fieldType,digitNum:fieldData.digitNum,fieldLength:fieldLength,relation:fieldData.relationInfo||{},relationData:fieldData.relationData||"",triggerData:fieldData.triggerData||"",customFieldInfo:"1"===fieldData.isCustomField?fieldData.customFieldInfo:null,auth:authData.auth,isNotNull:authData.isNotNull,isAuxilary:"0",isDataInvalid:"0"}}__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.a)(stdData,valueAndAuth),__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__business_utils_special__.a)(stdData),this.$set(formmains[tableName],stdData.id,stdData)},_processFormsonRecord:function(index,tableEl,tableField,record){var _this6=this,baseInfo=this.getBaseStyles(),viewInfo=this.dbData.data.viewInfo,formsons=this.dbData.formsons,tableName=tableEl.tableName,fieldInfo=tableField.fieldInfo,recordId=record.recordId,stdRecord={recordId:recordId,listsIndex:[],lists:{}};formsons[tableName].records.push(stdRecord),tableEl.children.forEach(function(viewEl,viewIndex){var elAttr=viewEl.attrs||{},isAuxilary=-1!==__WEBPACK_IMPORTED_MODULE_3__business_utils_field_types__.a.auxiliary.indexOf(viewEl.ctrlType);isAuxilary&&(viewEl.id=getAuxilaryUid(viewEl,tableName,viewIndex));var fieldData=fieldInfo[viewEl.id],recordData=record[viewEl.id],authKey=recordId&&viewEl.id?viewEl.id+"_"+recordId:viewEl.id,authData=viewInfo.authInfo[authKey],valueAndAuth=void 0,stdData={id:viewEl.id,recordId:recordId,type:viewEl.type,ctrlType:viewEl.ctrlType,placeHolder:elAttr.placeHolder,ctrlTitleStyle:elAttr.ctrlTitleStyle,radioAlignType:elAttr.radioAlignType,display:viewEl.display,extra:{base:viewEl.styles,fieldBg:baseInfo.fieldBg,fieldLine:baseInfo.fieldLine,fieldTitleDefaultColor:baseInfo.fieldTitleDefaultColor,fieldValueDefaultColor:baseInfo.fieldValueDefaultColor,isNotNullBg:baseInfo.isNotNullBg,placeholderColor:baseInfo.placeholderColor,fileBg:baseInfo.formsonBg},attrs:elAttr,formType:"formson"};if(!elAttr.src||elAttr.src.startsWith("http")||elAttr.src.startsWith("https")||(elAttr.src=""+__WEBPACK_IMPORTED_MODULE_2__utils_bridge__.a()+elAttr.src),isAuxilary||_this6._isPreview)valueAndAuth={valueId:"",value:"",showValue:"",attachmentInfo:{},enums:recordData?recordData.enums||fieldData.enums:[],isInCalculate:"",isInCondition:"",isAttachment:!!fieldData&&"1"===fieldData.isAttachment,isCustomField:!!fieldData&&"1"===fieldData.isCustomField,formatType:"",inputType:fieldData?fieldData.inputType:"",fieldType:fieldData?fieldData.fieldType:"",digitNum:"",fieldLength:"",relation:"",relationData:"",triggerData:"",customFieldInfo:fieldData&&"1"===fieldData.isCustomField?fieldData.customFieldInfo:null,auth:"add",isNotNull:"0",isAuxilary:isAuxilary?"1":"0",isDataInvalid:"0"};else{var fieldLength="text"===fieldData.inputType&&"VARCHAR"===fieldData.fieldType||"textarea"===fieldData.inputType?Math.floor(fieldData.fieldLength/3):fieldData.fieldLength;valueAndAuth={valueId:recordData.value,value:recordData.showValue2,showValue:recordData.showValue,attachmentInfo:recordData.attachmentInfo,enums:recordData.enums||fieldData.enums,isInCalculate:fieldData.isInCalculate,isInCondition:fieldData.isInCondition,isAttachment:"1"===fieldData.isAttachment,isCustomField:"1"===fieldData.isCustomField,formatType:fieldData.formatType,inputType:fieldData.inputType,fieldType:fieldData.fieldType,digitNum:fieldData.digitNum,fieldLength:fieldLength,relation:fieldData.relationInfo||{},relationData:recordData.relationData||"",triggerData:recordData.triggerData||"",customFieldInfo:"1"===fieldData.isCustomField?fieldData.customFieldInfo:null,auth:authData.auth,isNotNull:authData.isNotNull,isAuxilary:"0",isDataInvalid:"0"}}__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.a)(stdData,valueAndAuth),__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_4__business_utils_special__.a)(stdData),stdRecord.listsIndex.push(stdData.id),_this6.$set(stdRecord.lists,stdData.id,stdData)})},_setNullRecords:function(defaultRows,records){if(records.length>=defaultRows)return records;for(var delta=defaultRows-records.length,i=0;i<delta;i++)records.push(void 0);return records},formatTemplate:function(data){for(var record=__webpack_require__.i(__WEBPACK_IMPORTED_MODULE_1__utils_index__.b)(!0,data),lists=record.lists,i=0;i<lists.length;i++)lists[i].value="",lists[i].showValue="",lists[i].valueId="",lists[i].enums=[],lists[i].attachmentInfo=lists[i].attachmentInfo&&lists[i].attachmentInfo.attachmentInfos?{attachmentInfos:[],baseAttachmentInfo:lists[i].attachmentInfo.baseAttachmentInfo}:{};return record}}}},256:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__utils_bridge__=__webpack_require__(208),__WEBPACK_IMPORTED_MODULE_1__utils_hub__=__webpack_require__(217);__webpack_exports__.a={methods:{initFormmainEvent:function(){var _this=this;__WEBPACK_IMPORTED_MODULE_0__utils_bridge__.c(function(){_this._isUnflow&&(cmp.backbutton(),cmp.backbutton.push(function(){var type="new"!==_this.type||_this._isPreview?"":"close";_this.closeWebView(type)})),__WEBPACK_IMPORTED_MODULE_1__utils_hub__.b("com.seeyon.m3.SYNC_DB_DATA",function(e){var data=e.data,payload=data.data||{},recordType=payload.recordType,recordId=payload.recordId,recordTable=payload.recordTable,frontTable=payload.frontTable,recordEvent=void 0;"formmain"==data.target&&data.DBKey==_this._buildStoreKey()&&_this.getFromStore().then(function(cacheData){_this.dbData=cacheData,_this.setCalculateLock(),"formson"===data.from?recordEvent="edit"===recordType?"recordUpdated":"recordInserted":"relation"===data.from&&(recordEvent="new"===recordType?"recordInserted":""),recordEvent&&_this.emitForm(recordEvent,{recordId:recordId,recordTable:recordTable,frontTable:frontTable})})});var handleRedirect=function(evt){console.log("beforepageredirect:",evt);var data=evt.data||{},done=data.done,location=data.location,cb=function(){return done&&done()};"changeFormType"in data||("server"===location?_this.saveToServer("save",!0,cb,null,_this.dbData.pageParams.params.moduleType,!0,{needCheckRule:"0",needDataUnique:"0",needSn:"0"}):_this.saveToStore().then(cb,cb))};document.addEventListener("beforeviewleave",handleRedirect,!1),document.addEventListener("beforepageredirect",handleRedirect,!1)})}}}},259:function(module,exports){},260:function(module,exports){},261:function(module,exports){},262:function(module,exports){},265:function(module,__webpack_exports__,__webpack_require__){"use strict";function injectStyle(ssrContext){__webpack_require__(262)}var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_formson_vue__=__webpack_require__(252),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_46c59bd9_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_formson_vue__=__webpack_require__(270),normalizeComponent=__webpack_require__(42),__vue_styles__=injectStyle,Component=normalizeComponent(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_formson_vue__.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_46c59bd9_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_formson_vue__.a,!1,__vue_styles__,null,null);__webpack_exports__.a=Component.exports},266:function(module,__webpack_exports__,__webpack_require__){"use strict";function injectStyle(ssrContext){__webpack_require__(260),__webpack_require__(261)}var __WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_navbar_vue__=__webpack_require__(253),__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_2b72f473_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_navbar_vue__=__webpack_require__(269),normalizeComponent=__webpack_require__(42),__vue_styles__=injectStyle,Component=normalizeComponent(__WEBPACK_IMPORTED_MODULE_0__babel_loader_node_modules_vue_loader_lib_selector_type_script_index_0_navbar_vue__.a,__WEBPACK_IMPORTED_MODULE_1__node_modules_vue_loader_lib_template_compiler_index_id_data_v_2b72f473_hasScoped_false_transformToRequire_video_src_source_src_img_src_image_xlink_href_buble_transforms_node_modules_vue_loader_lib_selector_type_template_index_0_navbar_vue__.a,!1,__vue_styles__,null,null);__webpack_exports__.a=Component.exports},269:function(module,__webpack_exports__,__webpack_require__){"use strict";var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("section",{staticClass:"cap4-navbar",style:{background:_vm.bg,borderBottom:_vm.border}},[_c("div",{staticClass:"swiper-container"},[_c("div",{staticClass:"swiper-wrapper",attrs:{id:"cap4-navbar-wrapper"}},_vm._l(_vm.data,function(item,index){return _c("div",{key:item.rightId,staticClass:"swiper-slide"},[_c("div",{staticClass:"cap4-navbar__item",class:index==_vm.activeIndex?"is-active":"",style:{color:_vm.color},domProps:{textContent:_vm._s(item.name)},on:{tap:function($event){_vm.changeView(item.rightId,index)}}})])}))])])},staticRenderFns=[],esExports={render:render,staticRenderFns:staticRenderFns};__webpack_exports__.a=esExports},270:function(module,__webpack_exports__,__webpack_require__){"use strict";var render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"cap4-formson-records"},[_c("div",{staticClass:"cap4-fb__formsons",class:_vm.formson.records.length&&_vm.formson.state?"is-notNull":"",style:{background:_vm.styles.fieldBg}},[_c("div",{staticClass:"cap4-fb__formson",attrs:{id:_vm.formson.tableName}},[_c("div",{staticClass:"cap4-fb__fi"},[_c("div",{directives:[{name:"equalHeight",rawName:"v-equalHeight"}],staticClass:"cap4-fb__fi--titleWrap",style:{borderBottom:_vm.styles.formsonTiTleBorder},attrs:{id:_vm.formson.tableName+"_father"}},[_c("div",{staticClass:"cap4-fb__fi--title",on:{tap:function($event){_vm.formsonSwitch(_vm.formson.state,_vm.formson.tableName)}}},[_c("div",{staticClass:"cap4-fb__fi--arrow",class:_vm.formson.state?"":"is-off"},[_c("i",{staticClass:"icon CAP cap-icon-shu-zhankai",style:{color:_vm.styles.formsonArrowColor}})]),_vm._v(" "),_c("div",{staticClass:"cap4-fb__fi--text",domProps:{textContent:_vm._s(_vm.formson.display)}}),_vm._v(" "),"1"===_vm.formson.auth.add?_c("div",{staticClass:"cap4-fb__fi--add",on:{tap:function($event){$event.stopPropagation(),_vm.newFormson(_vm.formson.tableName)}}},[_c("i",{staticClass:"icon CAP cap-icon-jiahao"})]):_vm._e()])]),_vm._v(" "),_c("div",{directives:[{name:"show",rawName:"v-show",value:_vm.formson.state,expression:"formson.state"}],staticClass:"cap4-fb__fi--list",class:_vm.formson.records.length?"is-notNull":""},_vm._l(_vm.formson.records,function(item1,index){return index<_vm.pageSize*_vm.formson.page?_c("div",{key:item1.recordId,staticClass:"cap4-fb__fi--listItem",on:{tap:function($event){_vm.viewFormson(item1)}}},[_c("div",{staticClass:"cap4-fb__fi--listCnt",class:{"is-readonly":_vm.isReadOnly},style:{background:_vm.styles.formsonBg,border:_vm.styles.formsonBorder}},[_vm.checkLine?_c("div",{staticClass:"cap4-fb__fi--num",class:_vm.getRangeStyle(index)},[_c("div",{staticClass:"cap4-fb__fi--n",domProps:{textContent:_vm._s(index+1)}})]):_vm._e(),_vm._v(" "),_vm.isReadOnly?_vm._e():_c("div",{staticClass:"cap4-fb__fi--more",on:{tap:function($event){$event.stopPropagation(),_vm.operaRecord(item1.recordId,_vm.formson.frontTableName,index)}}},[_c("i",{staticClass:"icon CAP cap-icon-gengduo"})]),_vm._v(" "),_vm._l(item1.listsIndex,function(item3){return _vm.filterDisvisiable(item3)&&"image"===item1.lists[item3].inputType?_c("div",{key:item3,staticClass:"cap4-fb__fi--l"},[item1.lists[item3].value.length>1?_c("div",{staticClass:"cap4-fb__fi--lines"},[_c("div",{staticClass:"cap4-fb__fi--line1"}),_vm._v(" "),_c("div",{staticClass:"cap4-fb__fi--line2"}),_vm._v(" "),_c("div",{staticClass:"cap4-fb__fi--line3"})]):_vm._e(),_vm._v(" "),item1.lists[item3].attachmentInfo.attachmentInfos.length?_c("div",{staticClass:"cap4-fb__fi--img",style:_vm.getImgStyle(item1.lists[item3].value[0]),on:{tap:function($event){$event.stopPropagation(),_vm.browseImages(item1.lists[item3].value)}}}):_c("i",{staticClass:"icon CAP cap-icon-tupian"})]):_vm._e()}),_vm._v(" "),_c("div",{staticClass:"cap4-fb__fi--r"},_vm._l(_vm.filterFields(_vm.formatIndex(item1.listsIndex),item1.lists),function(item2,index2){return _vm.filterDisvisiable(item2)&&index2<4&&"hide"!==item1.lists[item2].auth&&!_vm.FieldTypes.auxiliary.includes(item1.lists[item2].inputType)&&!_vm.mFilter.includes(item1.lists[item2].inputType)&&!_vm.FieldTypes.file.includes(item1.lists[item2].inputType)?_c("div",{key:item2+"_"+item1.recordId,staticClass:"cap4-fb__fi--detail"},[_c("div",{staticClass:"cap4-fb__fi--dl",style:{color:_vm.styles.formsonTitle},domProps:{textContent:_vm._s(item1.lists[item2].display)}}),_vm._v(" "),-1!==_vm.FieldTypes.enums.indexOf(item1.lists[item2].inputType)?_c("div",{staticClass:"cap4-fb__fi--dr",style:{color:_vm.styles.formsonValue},domProps:{textContent:_vm._s(item1.lists[item2].showValue||_vm.getEnumsDisplay(item1.lists[item2].enums,item1.lists[item2].value))}}):-1!==_vm.FieldTypes.file.indexOf(item1.lists[item2].inputType)?_c("div",{staticClass:"cap4-fb__fi--dr",style:{color:_vm.styles.formsonValue},domProps:{textContent:_vm._s(_vm.getFileDisplay(item1.lists[item2].attachmentInfo))}}):-1!==_vm.FieldTypes.organize.indexOf(item1.lists[item2].inputType)?_c("div",{staticClass:"cap4-fb__fi--dr",style:{color:_vm.styles.formsonValue},domProps:{textContent:_vm._s(_vm.getOrganizeDisplay(item1.lists[item2].value))}}):-1!==_vm.FieldTypes.checkbox.indexOf(item1.lists[item2].inputType)?_c("div",{staticClass:"cap4-fb__fi--dr",style:{color:_vm.styles.formsonValue},domProps:{textContent:_vm._s(_vm.getCheckboxDisplay(item1.lists[item2].value))}}):_c("div",{staticClass:"cap4-fb__fi--dr"},[_c("pre",{style:{color:_vm.styles.formsonValue},domProps:{textContent:_vm._s(_vm.getDisplayValue(item1.lists[item2]))}})])]):_vm._e()}))],2)]):_vm._e()}))])])]),_vm._v(" "),_vm.formson.state&&_vm.formson.records.length>_vm.pageSize*_vm.formson.page?_c("div",{staticClass:"cap4-fb__fi--addmore",style:{background:_vm.styles.fieldBg,color:_vm.styles.fieldTitleDefaultColor},on:{tap:function($event){_vm.addMore(_vm.formson.page)}}},[_vm._v("\u70b9\u51fb\u52a0\u8f7d\u66f4\u591a")]):_vm._e()])},staticRenderFns=[],esExports={render:render,staticRenderFns:staticRenderFns};__webpack_exports__.a=esExports}});