(function(a){if(typeof bootstrap==="function"){bootstrap("promise",a)}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=a()}else{if(typeof define==="function"&&(define.amd||define.cmd)){define(a)}else{if(typeof ses!=="undefined"){if(!ses.ok()){return}else{ses.makeQ=a}}else{if(typeof self!=="undefined"){self.Q=a()}else{throw new Error("This environment was not anticiapted by Q. Please file a bug.")}}}}}})(function(){var E=false;try{throw new Error()}catch(ah){E=!!ah.stack}var u=W();var j;var ad=function(){};var ai=(function(){var ao={task:void 0,next:null};var an=ao;var aq=false;var Q=void 0;var am=false;function e(){while(ao.next){ao=ao.next;var ar=ao.task;ao.task=void 0;var at=ao.domain;if(at){ao.domain=void 0;at.enter()}try{ar()}catch(au){if(am){if(at){at.exit()}setTimeout(e,0);if(at){at.enter()}throw au}else{setTimeout(function(){throw au},0)}}if(at){at.exit()}}aq=false}ai=function(ar){an=an.next={task:ar,domain:am&&process.domain,next:null};if(!aq){aq=true;Q()}};if(typeof process!=="undefined"&&process.nextTick){am=true;Q=function(){process.nextTick(e)}}else{if(typeof setImmediate==="function"){if(typeof window!=="undefined"){Q=setImmediate.bind(window,e)}else{Q=function(){setImmediate(e)}}}else{if(typeof MessageChannel!=="undefined"){var ap=new MessageChannel();ap.port1.onmessage=function(){Q=al;ap.port1.onmessage=e;e()};var al=function(){ap.port2.postMessage(0)};Q=function(){setTimeout(e,0);al()}}else{Q=function(){setTimeout(e,0)}}}}return ai})();var a=Function.call;function p(e){return function(){return a.apply(e,arguments)}}var ab=p(Array.prototype.slice);var c=p(Array.prototype.reduce||function(am,al){var e=0,Q=this.length;if(arguments.length===1){do{if(e in this){al=this[e++];break}if(++e>=Q){throw new TypeError()}}while(1)}for(;e<Q;e++){if(e in this){al=am(al,this[e],e)}}return al});var R=p(Array.prototype.indexOf||function(Q){for(var e=0;e<this.length;e++){if(this[e]===Q){return e}}return -1});var b=p(Array.prototype.map||function(am,Q){var e=this;var al=[];c(e,function(ap,ao,an){al.push(am.call(Q,ao,an,e))},void 0);return al});var H=Object.create||function(Q){function e(){}e.prototype=Q;return new e()};var A=p(Object.prototype.hasOwnProperty);var G=Object.keys||function(e){var al=[];for(var Q in e){if(A(e,Q)){al.push(Q)}}return al};var ak=p(Object.prototype.toString);function V(e){return e===Object(e)}function w(e){return(ak(e)==="[object StopIteration]"||e instanceof I)}var I;if(typeof ReturnValue!=="undefined"){I=ReturnValue}else{I=function(e){this.value=e}}var Y="From previous event:";function m(e,an){if(E&&an.stack&&typeof e==="object"&&e!==null&&e.stack&&e.stack.indexOf(Y)===-1){var al=[];for(var am=an;!!am;am=am.source){if(am.stack){al.unshift(am.stack)}}al.unshift(e.stack);var Q=al.join("\n"+Y+"\n");e.stack=K(Q)}}function K(am){var Q=am.split("\n");var an=[];for(var al=0;al<Q.length;++al){var e=Q[al];if(!g(e)&&!Z(e)&&e){an.push(e)}}return an.join("\n")}function Z(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function af(e){var am=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(am){return[am[1],Number(am[2])]}var al=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(al){return[al[1],Number(al[2])]}var Q=/.*@(.+):(\d+)$/.exec(e);if(Q){return[Q[1],Number(Q[2])]}}function g(Q){var al=af(Q);if(!al){return false}var am=al[0];var e=al[1];return am===j&&e>=u&&e<=s}function W(){if(!E){return}try{throw new Error()}catch(an){var Q=an.stack.split("\n");var al=Q[0].indexOf("@")>0?Q[1]:Q[2];var am=af(al);if(!am){return}j=am[0];return am[1]}}function C(al,e,Q){return function(){if(typeof console!=="undefined"&&typeof console.warn==="function"){console.warn(e+" is deprecated, use "+Q+" instead.",new Error("").stack)}return al.apply(al,arguments)}}function l(e){if(e instanceof N){return e}if(M(e)){return L(e)}else{return z(e)}}l.resolve=l;l.nextTick=ai;l.longStackSupport=false;if(typeof process==="object"&&process&&process.env&&process.env.Q_DEBUG){l.longStackSupport=true}l.defer=h;function h(){var am=[],ao=[],an;var Q=H(h.prototype);var aq=H(N.prototype);aq.promiseDispatch=function(at,au,ar){var e=ab(arguments);if(am){am.push(e);if(au==="when"&&ar[1]){ao.push(ar[1])}}else{l.nextTick(function(){an.promiseDispatch.apply(an,e)})}};aq.valueOf=function(){if(am){return aq}var e=J(an);if(y(e)){an=e}return e};aq.inspect=function(){if(!an){return{state:"pending"}}return an.inspect()};if(l.longStackSupport&&E){try{throw new Error()}catch(ap){aq.stack=ap.stack.substring(ap.stack.indexOf("\n")+1)}}function al(e){an=e;aq.source=e;c(am,function(at,ar){l.nextTick(function(){e.promiseDispatch.apply(e,ar)})},void 0);am=void 0;ao=void 0}Q.promise=aq;Q.resolve=function(e){if(an){return}al(l(e))};Q.fulfill=function(e){if(an){return}al(z(e))};Q.reject=function(e){if(an){return}al(D(e))};Q.notify=function(e){if(an){return}c(ao,function(at,ar){l.nextTick(function(){ar(e)})},void 0)};return Q}h.prototype.makeNodeResolver=function(){var e=this;return function(Q,al){if(Q){e.reject(Q)}else{if(arguments.length>2){e.resolve(ab(arguments,1))}else{e.resolve(al)}}}};l.Promise=T;l.promise=T;function T(al){if(typeof al!=="function"){throw new TypeError("resolver must be a function.")}var e=h();try{al(e.resolve,e.reject,e.notify)}catch(Q){e.reject(Q)}return e.promise}T.race=n;T.all=x;T.reject=D;T.resolve=l;l.passByCopy=function(e){return e};N.prototype.passByCopy=function(){return this};l.join=function(e,Q){return l(e).join(Q)};N.prototype.join=function(e){return l([this,e]).spread(function(Q,al){if(Q===al){return Q}else{throw new Error("Can't join: not the same: "+Q+" "+al)}})};l.race=n;function n(e){return T(function(an,am){for(var al=0,Q=e.length;al<Q;al++){l(e[al]).then(an,am)}})}N.prototype.race=function(){return this.then(l.race)};l.makePromise=N;function N(Q,an,am){if(an===void 0){an=function(ao){return D(new Error("Promise does not support operation: "+ao))}}if(am===void 0){am=function(){return{state:"unknown"}}}var al=H(N.prototype);al.promiseDispatch=function(ar,at,ap){var ao;try{if(Q[at]){ao=Q[at].apply(al,ap)}else{ao=an.call(al,at,ap)}}catch(aq){ao=D(aq)}if(ar){ar(ao)}};al.inspect=am;if(am){var e=am();if(e.state==="rejected"){al.exception=e.reason}al.valueOf=function(){var ao=am();if(ao.state==="pending"||ao.state==="rejected"){return al}return ao.value}}return al}N.prototype.toString=function(){return"[object Promise]"};N.prototype.then=function(an,ao,Q){var ap=this;var aq=h();var al=false;function am(au){try{return typeof an==="function"?an(au):au}catch(at){return D(at)}}function ar(at){if(typeof ao==="function"){m(at,ap);try{return ao(at)}catch(au){return D(au)}}return D(at)}function e(at){return typeof Q==="function"?Q(at):at}l.nextTick(function(){ap.promiseDispatch(function(at){if(al){return}al=true;aq.resolve(am(at))},"when",[function(at){if(al){return}al=true;aq.resolve(ar(at))}])});ap.promiseDispatch(void 0,"when",[void 0,function(at){var av;var aw=false;try{av=e(at)}catch(au){aw=true;if(l.onerror){l.onerror(au)}else{throw au}}if(!aw){aq.notify(av)}}]);return aq.promise};l.tap=function(e,Q){return l(e).tap(Q)};N.prototype.tap=function(e){e=l(e);return this.then(function(Q){return e.fcall(Q).thenResolve(Q)})};l.when=O;function O(al,e,Q,am){return l(al).then(e,Q,am)}N.prototype.thenResolve=function(e){return this.then(function(){return e})};l.thenResolve=function(Q,e){return l(Q).thenResolve(e)};N.prototype.thenReject=function(e){return this.then(function(){throw e})};l.thenReject=function(Q,e){return l(Q).thenReject(e)};l.nearer=J;function J(Q){if(y(Q)){var e=Q.inspect();if(e.state==="fulfilled"){return e.value}}return Q}l.isPromise=y;function y(e){return e instanceof N}l.isPromiseAlike=M;function M(e){return V(e)&&typeof e.then==="function"}l.isPending=ac;function ac(e){return y(e)&&e.inspect().state==="pending"}N.prototype.isPending=function(){return this.inspect().state==="pending"};l.isFulfilled=P;function P(e){return !y(e)||e.inspect().state==="fulfilled"}N.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"};l.isRejected=U;function U(e){return y(e)&&e.inspect().state==="rejected"}N.prototype.isRejected=function(){return this.inspect().state==="rejected"};var aa=[];var aj=[];var o=true;function ag(){aa.length=0;aj.length=0;if(!o){o=true}}function B(Q,e){if(!o){return}aj.push(Q);if(e&&typeof e.stack!=="undefined"){aa.push(e.stack)}else{aa.push("(no stack) "+e)}}function k(Q){if(!o){return}var e=R(aj,Q);if(e!==-1){aj.splice(e,1);aa.splice(e,1)}}l.resetUnhandledRejections=ag;l.getUnhandledReasons=function(){return aa.slice()};l.stopUnhandledRejectionTracking=function(){ag();o=false};ag();l.reject=D;function D(Q){var e=N({"when":function(an){if(an){k(this)}return an?an(Q):this}},function am(){return this},function al(){return{state:"rejected",reason:Q}});B(e,Q);return e}l.fulfill=z;function z(e){return N({"when":function(){return e},"get":function(al){return e[al]},"set":function(al,am){e[al]=am},"delete":function(al){delete e[al]},"post":function(am,al){if(am===null||am===void 0){return e.apply(void 0,al)}else{return e[am].apply(e,al)}},"apply":function(am,al){return e.apply(am,al)},"keys":function(){return G(e)}},void 0,function Q(){return{state:"fulfilled",value:e}})}function L(Q){var e=h();l.nextTick(function(){try{Q.then(e.resolve,e.reject,e.notify)}catch(al){e.reject(al)}});return e.promise}l.master=v;function v(e){return N({"isDef":function(){}},function Q(am,al){return X(e,am,al)},function(){return l(e).inspect()})}l.spread=f;function f(al,e,Q){return l(al).spread(e,Q)}N.prototype.spread=function(e,Q){return this.all().then(function(al){return e.apply(void 0,al)},Q)};l.async=S;function S(e){return function(){function al(ar,ap){var ao;if(typeof StopIteration==="undefined"){try{ao=am[ar](ap)}catch(aq){return D(aq)}if(ao.done){return l(ao.value)}else{return O(ao.value,an,Q)}}else{try{ao=am[ar](ap)}catch(aq){if(w(aq)){return l(aq.value)}else{return D(aq)}}return O(ao,an,Q)}}var am=e.apply(this,arguments);var an=al.bind(al,"next");var Q=al.bind(al,"throw");return an()}}l.spawn=r;function r(e){l.done(l.async(e)())}l["return"]=i;function i(e){throw new I(e)}l.promised=q;function q(e){return function(){return f([this,x(arguments)],function(Q,al){return e.apply(Q,al)})}}l.dispatch=X;function X(Q,al,e){return l(Q).dispatch(al,e)}N.prototype.dispatch=function(am,al){var Q=this;var e=h();l.nextTick(function(){Q.promiseDispatch(e.resolve,am,al)});return e.promise};l.get=function(e,Q){return l(e).dispatch("get",[Q])};N.prototype.get=function(e){return this.dispatch("get",[e])};l.set=function(e,Q,al){return l(e).dispatch("set",[Q,al])};N.prototype.set=function(e,Q){return this.dispatch("set",[e,Q])};l.del=l["delete"]=function(e,Q){return l(e).dispatch("delete",[Q])};N.prototype.del=N.prototype["delete"]=function(e){return this.dispatch("delete",[e])};l.mapply=l.post=function(al,Q,e){return l(al).dispatch("post",[Q,e])};N.prototype.mapply=N.prototype.post=function(Q,e){return this.dispatch("post",[Q,e])};l.send=l.mcall=l.invoke=function(Q,e){return l(Q).dispatch("post",[e,ab(arguments,2)])};N.prototype.send=N.prototype.mcall=N.prototype.invoke=function(e){return this.dispatch("post",[e,ab(arguments,1)])};l.fapply=function(Q,e){return l(Q).dispatch("apply",[void 0,e])};N.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])};l["try"]=l.fcall=function(e){return l(e).dispatch("apply",[void 0,ab(arguments,1)])};N.prototype.fcall=function(){return this.dispatch("apply",[void 0,ab(arguments)])};l.fbind=function(Q){var am=l(Q);var e=ab(arguments,1);return function al(){return am.dispatch("apply",[this,e.concat(ab(arguments))])}};N.prototype.fbind=function(){var al=this;var e=ab(arguments);return function Q(){return al.dispatch("apply",[this,e.concat(ab(arguments))])}};l.keys=function(e){return l(e).dispatch("keys",[])};N.prototype.keys=function(){return this.dispatch("keys",[])};l.all=x;function x(e){return O(e,function(am){var al=0;var Q=h();c(am,function(aq,ap,ao){var an;if(y(ap)&&(an=ap.inspect()).state==="fulfilled"){am[ao]=an.value}else{++al;O(ap,function(ar){am[ao]=ar;if(--al===0){Q.resolve(am)}},Q.reject,function(ar){Q.notify({index:ao,value:ar})})}},void 0);if(al===0){Q.resolve(am)}return Q.promise})}N.prototype.all=function(){return x(this)};l.allResolved=C(d,"allResolved","allSettled");function d(e){return O(e,function(Q){Q=b(Q,l);return O(x(b(Q,function(al){return O(al,ad,ad)})),function(){return Q})})}N.prototype.allResolved=function(){return d(this)};l.allSettled=t;function t(e){return l(e).allSettled()}N.prototype.allSettled=function(){return this.then(function(e){return x(b(e,function(al){al=l(al);function Q(){return al.inspect()}return al.then(Q,Q)}))})};l.fail=l["catch"]=function(e,Q){return l(e).then(void 0,Q)};N.prototype.fail=N.prototype["catch"]=function(e){return this.then(void 0,e)};l.progress=F;function F(e,Q){return l(e).then(void 0,void 0,Q)}N.prototype.progress=function(e){return this.then(void 0,void 0,e)};l.fin=l["finally"]=function(e,Q){return l(e)["finally"](Q)};N.prototype.fin=N.prototype["finally"]=function(e){e=l(e);return this.then(function(Q){return e.fcall().then(function(){return Q})},function(Q){return e.fcall().then(function(){throw Q})})};l.done=function(al,e,am,Q){return l(al).done(e,am,Q)};N.prototype.done=function(e,am,al){var Q=function(ao){l.nextTick(function(){m(ao,an);if(l.onerror){l.onerror(ao)}else{throw ao}})};var an=e||am||al?this.then(e,am,al):this;if(typeof process==="object"&&process&&process.domain){Q=process.domain.bind(Q)}an.then(void 0,Q)};l.timeout=function(al,Q,e){return l(al).timeout(Q,e)};N.prototype.timeout=function(al,Q){var e=h();var am=setTimeout(function(){if(!Q||"string"===typeof Q){Q=new Error(Q||"Timed out after "+al+" ms");Q.code="ETIMEDOUT"}e.reject(Q)},al);this.then(function(an){clearTimeout(am);e.resolve(an)},function(an){clearTimeout(am);e.reject(an)},e.notify);return e.promise};l.delay=function(e,Q){if(Q===void 0){Q=e;e=void 0}return l(e).delay(Q)};N.prototype.delay=function(e){return this.then(function(al){var Q=h();setTimeout(function(){Q.resolve(al)},e);return Q.promise})};l.nfapply=function(Q,e){return l(Q).nfapply(e)};N.prototype.nfapply=function(Q){var e=h();var al=ab(Q);al.push(e.makeNodeResolver());this.fapply(al).fail(e.reject);return e.promise};l.nfcall=function(Q){var e=ab(arguments,1);return l(Q).nfapply(e)};N.prototype.nfcall=function(){var Q=ab(arguments);var e=h();Q.push(e.makeNodeResolver());this.fapply(Q).fail(e.reject);return e.promise};l.nfbind=l.denodeify=function(Q){var e=ab(arguments,1);return function(){var am=e.concat(ab(arguments));var al=h();am.push(al.makeNodeResolver());l(Q).fapply(am).fail(al.reject);return al.promise}};N.prototype.nfbind=N.prototype.denodeify=function(){var e=ab(arguments);e.unshift(this);return l.denodeify.apply(void 0,e)};l.nbind=function(al,e){var Q=ab(arguments,2);return function(){var ao=Q.concat(ab(arguments));var am=h();ao.push(am.makeNodeResolver());function an(){return al.apply(e,arguments)}l(an).fapply(ao).fail(am.reject);return am.promise}};N.prototype.nbind=function(){var e=ab(arguments,0);e.unshift(this);return l.nbind.apply(void 0,e)};l.nmapply=l.npost=function(al,Q,e){return l(al).npost(Q,e)};N.prototype.nmapply=N.prototype.npost=function(al,Q){var am=ab(Q||[]);var e=h();am.push(e.makeNodeResolver());this.dispatch("post",[al,am]).fail(e.reject);return e.promise};l.nsend=l.nmcall=l.ninvoke=function(al,Q){var am=ab(arguments,2);var e=h();am.push(e.makeNodeResolver());l(al).dispatch("post",[Q,am]).fail(e.reject);return e.promise};N.prototype.nsend=N.prototype.nmcall=N.prototype.ninvoke=function(Q){var al=ab(arguments,1);var e=h();al.push(e.makeNodeResolver());this.dispatch("post",[Q,al]).fail(e.reject);return e.promise};l.nodeify=ae;function ae(Q,e){return l(Q).nodeify(e)}N.prototype.nodeify=function(e){if(e){this.then(function(Q){l.nextTick(function(){e(null,Q)})},function(Q){l.nextTick(function(){e(Q)})})}else{return this}};var s=W();l.denodeify2=function(an){var Q=ab(arguments,1);var e=function(){var ap=Q.concat(ab(arguments));if(ap.length>0&&typeof ap[ap.length-1]==="function"){return an.apply(null,ap)}else{var ao=h();ap.push(ao.makeNodeResolver());l(an).fapply(ap).fail(ao.reject);return ao.promise}};var am=an.toString().split(")")[0].split("(")[1];var al=am?am.split(",").map(function(ao){return ao.trim()}):[];e.$formalParams=al;return e};return l});